<template>
  <div class="cdn-container">
    <header class="cdn-header">
      <h1>CDNåŠ é€Ÿå‰ç«¯åº”ç”¨æŒ‡å—</h1>
      <p class="subtitle">æå‡ç½‘ç«™å…¨çƒè®¿é—®é€Ÿåº¦çš„æœ€ä½³å®è·µ</p>
      <div class="cdn-stats">
        <div class="stat">
          <div class="stat-value">50-70%</div>
          <div class="stat-label">åŠ è½½æ—¶é—´å‡å°‘</div>
        </div>
        <div class="stat">
          <div class="stat-value">99.9%</div>
          <div class="stat-label">å¯ç”¨æ€§ä¿è¯</div>
        </div>
        <div class="stat">
          <div class="stat-value">å…¨çƒ</div>
          <div class="stat-label">èŠ‚ç‚¹è¦†ç›–</div>
        </div>
      </div>
    </header>

    <div class="cdn-content">
      <section class="cdn-section">
        <h2>ä»€ä¹ˆæ˜¯CDNï¼Ÿ</h2>
        <div class="definition-card">
          <p>
            <strong>CDN (Content Delivery Network)</strong> å³å†…å®¹åˆ†å‘ç½‘ç»œï¼Œ
            æ˜¯ä¸€ç§åˆ†å¸ƒå¼æœåŠ¡å™¨ç³»ç»Ÿï¼Œé€šè¿‡åœ¨å…¨çƒå¤šä¸ªä½ç½®éƒ¨ç½²èŠ‚ç‚¹æœåŠ¡å™¨ï¼Œ
            å°†ç½‘ç«™å†…å®¹ç¼“å­˜åˆ°ç¦»ç”¨æˆ·æ›´è¿‘çš„åœ°æ–¹ï¼Œä»è€ŒåŠ é€Ÿå†…å®¹ä¼ è¾“ã€‚
          </p>
          <div class="cdn-benefits">
            <div class="benefit">
              <div class="benefit-icon">âš¡</div>
              <h3>åŠ é€ŸåŠ è½½</h3>
              <p>å‡å°‘å»¶è¿Ÿï¼Œæå‡é¡µé¢åŠ è½½é€Ÿåº¦</p>
            </div>
            <div class="benefit">
              <div class="benefit-icon">ğŸ›¡ï¸</div>
              <h3>å¢å¼ºå®‰å…¨</h3>
              <p>æŠµå¾¡DDoSæ”»å‡»ï¼Œæä¾›HTTPSæ”¯æŒ</p>
            </div>
            <div class="benefit">
              <div class="benefit-icon">ğŸ“ˆ</div>
              <h3>æå‡å¯ç”¨æ€§</h3>
              <p>æœåŠ¡å™¨æ•…éšœæ—¶è‡ªåŠ¨åˆ‡æ¢èŠ‚ç‚¹</p>
            </div>
          </div>
        </div>
      </section>

      <section class="cdn-section">
        <h2>CDNåŠ é€ŸåŸç†</h2>
        <div class="principle-diagram">
          <div class="user">ç”¨æˆ·</div>
          <div class="arrow">â†’</div>
          <div class="edge-cdn">è¾¹ç¼˜CDNèŠ‚ç‚¹</div>
          <div class="arrow">â†’</div>
          <div class="origin-server">æºæœåŠ¡å™¨</div>

          <div class="explanation">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-content">ç”¨æˆ·è¯·æ±‚èµ„æº</div>
            </div>
            <div class="step">
              <div class="step-number">2</div>
              <div class="step-content">CDNæ™ºèƒ½è·¯ç”±åˆ°æœ€è¿‘çš„èŠ‚ç‚¹</div>
            </div>
            <div class="step">
              <div class="step-number">3</div>
              <div class="step-content">èŠ‚ç‚¹è¿”å›ç¼“å­˜çš„èµ„æº</div>
            </div>
            <div class="step">
              <div class="step-number">4</div>
              <div class="step-content">æœªç¼“å­˜èµ„æºä»æºæœåŠ¡å™¨è·å–å¹¶ç¼“å­˜</div>
            </div>
          </div>

          <div class="cache-process">
            <h3>ç¼“å­˜è¿‡ç¨‹</h3>
            <div class="cache-visual">
              <div class="cache-item">é¦–æ¬¡è¯·æ±‚</div>
              <div class="cache-arrow">â†’</div>
              <div class="cache-item">å›æºè·å–</div>
              <div class="cache-arrow">â†’</div>
              <div class="cache-item">è¾¹ç¼˜ç¼“å­˜</div>
              <div class="cache-arrow">â†’</div>
              <div class="cache-item">åç»­è¯·æ±‚ç›´æ¥å“åº”</div>
            </div>
          </div>
        </div>
      </section>

      <section class="cdn-section">
        <h2>å¦‚ä½•å¼€å¯CDNåŠ é€Ÿ</h2>
        <div class="steps-container">
          <div class="step-card">
            <div class="step-number">1</div>
            <h3>é€‰æ‹©CDNæä¾›å•†</h3>
            <ul>
              <li><strong>Cloudflare</strong> - å…è´¹åŸºç¡€å¥—é¤</li>
              <li><strong>AWS CloudFront</strong> - æ·±åº¦AWSé›†æˆ</li>
              <li><strong>Akamai</strong> - ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ</li>
              <li><strong>é˜¿é‡Œäº‘CDN</strong> - ä¸­å›½åœ°åŒºä¼˜åŒ–</li>
            </ul>
          </div>

          <div class="step-card">
            <div class="step-number">2</div>
            <h3>é…ç½®CDNæœåŠ¡</h3>
            <div class="code-block">
              <pre><code>// ç¤ºä¾‹ï¼šCloudflareé…ç½®
1. æ·»åŠ ç½‘ç«™åˆ°Cloudflare
2. æ›´æ–°åŸŸåçš„DNSæœåŠ¡å™¨
3. é…ç½®ç¼“å­˜è§„åˆ™ï¼š
   - é™æ€èµ„æºç¼“å­˜1å¹´
   - HTMLæ–‡ä»¶ç¼“å­˜2å°æ—¶
4. å¯ç”¨HTTPSå’ŒHTTP/2
5. é…ç½®æ€§èƒ½ä¼˜åŒ–é€‰é¡¹</code></pre>
            </div>
          </div>

          <div class="step-card">
            <div class="step-number">3</div>
            <h3>ä¿®æ”¹èµ„æºå¼•ç”¨</h3>
            <p>å°†èµ„æºURLæ›¿æ¢ä¸ºCDN URLï¼š</p>
            <div class="code-block">
              <pre><code>&lt;!-- åŸå§‹å¼•ç”¨ --&gt;
&lt;script src="/js/app.js"&gt;&lt;/script&gt;

&lt;!-- CDNå¼•ç”¨ --&gt;
&lt;script src="https://cdn.yourdomain.com/js/app.js"&gt;&lt;/script&gt;</code></pre>
            </div>
            <p class="tip">ä½¿ç”¨æ„å»ºå·¥å…·è‡ªåŠ¨æ›¿æ¢ï¼š</p>
            <div class="code-block">
              <pre><code>// webpack.config.js
output: {
  publicPath: process.env.NODE_ENV === 'production'
    ? 'https://cdn.yourdomain.com/'
    : '/'
}</code></pre>
            </div>
          </div>

          <div class="step-card">
            <div class="step-number">4</div>
            <h3>éªŒè¯ä¸æµ‹è¯•</h3>
            <ul>
              <li>ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ£€æŸ¥èµ„æºæ¥æº</li>
              <li>å…¨çƒé€Ÿåº¦æµ‹è¯•å·¥å…·ï¼ˆWebPageTestï¼‰</li>
              <li>éªŒè¯ç¼“å­˜å¤´ï¼ˆCache-Control, ETagï¼‰</li>
              <li>æ£€æŸ¥HTTPSæ˜¯å¦æ­£å¸¸å·¥ä½œ</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="cdn-section">
        <h2>CDNæœ€ä½³å®è·µ</h2>
        <div class="best-practices">
          <div class="practice">
            <div class="practice-icon">ğŸ“¦</div>
            <h3>ç¼“å­˜ç­–ç•¥</h3>
            <ul>
              <li>é™æ€èµ„æºè®¾ç½®é•¿æœŸç¼“å­˜ï¼ˆ1å¹´ï¼‰</li>
              <li>ä½¿ç”¨æ–‡ä»¶å“ˆå¸Œå®ç°ç¼“å­˜ç ´å</li>
              <li>è®¾ç½®åˆé€‚çš„Cache-Controlå¤´</li>
            </ul>
          </div>

          <div class="practice">
            <div class="practice-icon">âš¡</div>
            <h3>æ€§èƒ½ä¼˜åŒ–</h3>
            <ul>
              <li>å¯ç”¨HTTP/2æˆ–HTTP/3</li>
              <li>é…ç½®Brotli/Gzipå‹ç¼©</li>
              <li>å¯ç”¨TCPå¿«é€Ÿæ‰“å¼€</li>
            </ul>
          </div>

          <div class="practice">
            <div class="practice-icon">ğŸ”’</div>
            <h3>å®‰å…¨é…ç½®</h3>
            <ul>
              <li>å¼ºåˆ¶HTTPSè¿æ¥</li>
              <li>é…ç½®WAFé˜²æŠ¤è§„åˆ™</li>
              <li>è®¾ç½®CSPå®‰å…¨ç­–ç•¥</li>
            </ul>
          </div>
        </div>
      </section>

      <div class="comparison-table">
        <h3>CDNåŠ é€Ÿæ•ˆæœå¯¹æ¯”</h3>
        <table>
          <thead>
            <tr>
              <th>æŒ‡æ ‡</th>
              <th>æ— CDN</th>
              <th>å¯ç”¨CDN</th>
              <th>æå‡å¹…åº¦</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>é¦–å­—èŠ‚æ—¶é—´(TTFB)</td>
              <td>320ms</td>
              <td>45ms</td>
              <td>86%</td>
            </tr>
            <tr>
              <td>é¡µé¢å®Œå…¨åŠ è½½</td>
              <td>2.8s</td>
              <td>1.2s</td>
              <td>57%</td>
            </tr>
            <tr>
              <td>å…¨çƒå»¶è¿Ÿå·®å¼‚</td>
              <td>300-600ms</td>
              <td>30-100ms</td>
              <td>80-85%</td>
            </tr>
            <tr>
              <td>æœåŠ¡å™¨è´Ÿè½½</td>
              <td>100%</td>
              <td>15-30%</td>
              <td>70-85%</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <footer class="cdn-footer">
      <p> å‰ç«¯æ€§èƒ½ä¼˜åŒ–æŒ‡å— | CDNåŠ é€Ÿå®è·µ</p>
      <div class="footer-links">
        <a href="#">Cloudflareæ–‡æ¡£</a>
        <a href="#">AWS CloudFrontæŒ‡å—</a>
        <a href="#">é˜¿é‡Œäº‘CDNé…ç½®</a>
      </div>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// ç¤ºä¾‹å“åº”å¼æ•°æ®
const cdnProviders = ref([
  { name: 'Cloudflare', free: true, global: true },
  { name: 'AWS CloudFront', free: false, global: true },
  { name: 'Akamai', free: false, global: true },
  { name: 'é˜¿é‡Œäº‘CDN', free: true, global: false }
]);
</script>

<style lang="less" scoped>
@primary-color: #3498db;
@secondary-color: #2c3e50;
@accent-color: #42b983;
@background-light: #f8f9fa;
@text-color: #34495e;
@border-color: #e0e0e0;
@code-bg: #2d2d2d;
@code-color: #f8f8f2;
@warning-color: #e74c3c;

.cdn-container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: @text-color;
  line-height: 1.6;
}

.cdn-header {
  text-align: center;
  margin-bottom: 3rem;
  padding: 2rem;
  background: linear-gradient(135deg, @secondary-color, lighten(@secondary-color, 10%));
  border-radius: 12px;
  color: white;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);

  h1 {
    font-size: 2.2rem;
    margin-bottom: 0.5rem;
    font-weight: 700;
  }

  .subtitle {
    font-size: 1.1rem;
    opacity: 0.9;
    margin-bottom: 1.5rem;
  }
}

.cdn-stats {
  display: flex;
  justify-content: center;
  gap: 1.5rem;

  .stat {
    background: rgba(255, 255, 255, 0.15);
    padding: 1rem 1.8rem;
    border-radius: 8px;
    backdrop-filter: blur(5px);

    .stat-value {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .stat-label {
      font-size: 0.9rem;
      opacity: 0.9;
    }
  }
}

.cdn-section {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);

  h2 {
    font-size: 1.6rem;
    margin-top: 0;
    margin-bottom: 1.5rem;
    color: @secondary-color;
    position: relative;
    padding-bottom: 0.5rem;

    &::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: @accent-color;
      border-radius: 3px;
    }
  }
}

.definition-card {
  p {
    font-size: 1.1rem;
    line-height: 1.8;
    margin-bottom: 1.5rem;
  }
}

.cdn-benefits {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
}

.benefit {
  background: lighten(@accent-color, 45%);
  border-radius: 8px;
  padding: 1.5rem;
  text-align: center;

  .benefit-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  h3 {
    margin: 0.5rem 0;
    color: @secondary-color;
  }

  p {
    margin: 0;
    font-size: 0.95rem;
    color: lighten(@text-color, 20%);
  }
}

.principle-diagram {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 1rem;
  margin: 2rem 0;

  >div {
    padding: 1rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    background: white;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
  }

  .user {
    background: lighten(@primary-color, 40%);
    color: darken(@primary-color, 20%);
  }

  .edge-cdn {
    background: lighten(@accent-color, 40%);
    color: darken(@accent-color, 20%);
  }

  .origin-server {
    background: lighten(@warning-color, 40%);
    color: darken(@warning-color, 20%);
  }

  .arrow {
    font-size: 1.5rem;
    color: @accent-color;
    background: none;
    box-shadow: none;
  }
}

.explanation {
  width: 100%;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-top: 2rem;
}

.step {
  display: flex;
  gap: 1rem;
  background: @background-light;
  padding: 1rem;
  border-radius: 8px;

  .step-number {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: @accent-color;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
  }

  .step-content {
    font-weight: 500;
  }
}

.cache-process {
  width: 100%;
  margin-top: 2rem;

  h3 {
    text-align: center;
    margin-bottom: 1rem;
    color: @secondary-color;
  }
}

.cache-visual {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.cache-item {
  padding: 0.8rem 1.2rem;
  background: lighten(@primary-color, 40%);
  border-radius: 8px;
  font-weight: 500;
}

.cache-arrow {
  color: @accent-color;
  font-size: 1.2rem;
}

.steps-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.step-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  position: relative;
  overflow: hidden;

  .step-number {
    position: absolute;
    top: 0;
    right: 0;
    width: 40px;
    height: 40px;
    background: @accent-color;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    border-radius: 0 0 0 12px;
  }

  h3 {
    margin-top: 0;
    color: @primary-color;
    padding-right: 40px;
  }

  ul {
    padding-left: 1.2rem;

    li {
      margin-bottom: 0.5rem;
    }
  }
}

.code-block {
  background: @code-bg;
  color: @code-color;
  border-radius: 8px;
  padding: 1.2rem;
  overflow-x: auto;
  margin: 1rem 0;
  font-family: 'Fira Code', 'Courier New', monospace;
  font-size: 0.9rem;

  pre {
    margin: 0;
  }

  code {
    display: block;
    line-height: 1.5;

    .comment {
      color: #75715e;
    }
  }
}

.tip {
  font-size: 0.9rem;
  color: lighten(@text-color, 20%);
  margin: 0.5rem 0;
}

.best-practices {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.practice {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);

  .practice-icon {
    font-size: 2rem;
    text-align: center;
    margin-bottom: 1rem;
  }

  h3 {
    text-align: center;
    margin-top: 0;
    color: @secondary-color;
  }

  ul {
    padding-left: 1.2rem;

    li {
      margin-bottom: 0.8rem;
      line-height: 1.5;
    }
  }
}

.comparison-table {
  width: 100%;
  overflow-x: auto;
  margin: 2rem 0;

  table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);

    th,
    td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid @border-color;
    }

    th {
      background: @background-light;
      font-weight: 600;
      color: @secondary-color;
    }

    tr:last-child td {
      border-bottom: none;
    }

    tr:nth-child(even) {
      background: lighten(@background-light, 1%);
    }
  }
}

.cdn-footer {
  text-align: center;
  padding: 2rem 0;
  color: lighten(@text-color, 30%);
  font-size: 0.9rem;

  .footer-links {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    margin-top: 1rem;

    a {
      color: @primary-color;
      text-decoration: none;

      &:hover {
        text-decoration: underline;
      }
    }
  }
}

@media (max-width: 768px) {
  .cdn-header {
    padding: 1.5rem;

    h1 {
      font-size: 1.8rem;
    }
  }

  .cdn-stats {
    flex-direction: column;
    align-items: center;

    .stat {
      width: 100%;
      max-width: 200px;
    }
  }

  .principle-diagram {
    flex-direction: column;

    .arrow {
      transform: rotate(90deg);
    }
  }
}
</style>
