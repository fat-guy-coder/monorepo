<template>
  <div class="array-methods-container">
    <div class="header">
      <h1>æ‰‹å†™æ•°ç»„åŸç”Ÿæ–¹æ³•å®ç°</h1>
      <p>æ·±å…¥ç†è§£ JavaScript æ•°ç»„æ–¹æ³•çš„åº•å±‚åŸç†</p>
    </div>

    <div class="methods-overview">
      <div class="overview-card">
        <div class="overview-icon">ğŸ”</div>
        <div class="overview-content">
          <h2>ä¸ºä»€ä¹ˆè¦æ‰‹å†™æ•°ç»„æ–¹æ³•ï¼Ÿ</h2>
          <p>
            æ‰‹å†™å®ç°æ•°ç»„åŸç”Ÿæ–¹æ³•èƒ½å¸®åŠ©æˆ‘ä»¬æ·±å…¥ç†è§£ JavaScript
            çš„æ ¸å¿ƒåŸç†ï¼Œæå‡ç¼–ç¨‹èƒ½åŠ›ï¼Œå¹¶åœ¨é¢è¯•ä¸­å±•ç¤ºæ‰å®çš„åŸºç¡€çŸ¥è¯†ã€‚
          </p>
          <div class="benefits">
            <div class="benefit">
              <div class="benefit-icon">ğŸ§ </div>
              <span>æ·±å…¥ç†è§£è¯­è¨€ç‰¹æ€§</span>
            </div>
            <div class="benefit">
              <div class="benefit-icon">ğŸ’¡</div>
              <span>æå‡ç¼–ç¨‹æ€ç»´èƒ½åŠ›</span>
            </div>
            <div class="benefit">
              <div class="benefit-icon">âš™ï¸</div>
              <span>æŒæ¡æ ¸å¿ƒç®—æ³•å®ç°</span>
            </div>
            <div class="benefit">
              <div class="benefit-icon">ğŸ“</div>
              <span>é¢è¯•å¿…å¤‡æŠ€èƒ½</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="methods-grid">
      <div
        v-for="method in methods"
        :key="method.name"
        class="method-card"
        :class="{ expanded: expandedMethod === method.name }"
      >
        <div class="method-header" @click="toggleMethod(method.name)">
          <div class="method-icon">{{ method.icon }}</div>
          <h3>{{ method.name }}</h3>
          <div class="method-summary">{{ method.summary }}</div>
          <div class="expand-icon">
            {{ expandedMethod === method.name ? 'â–¼' : 'â–º' }}
          </div>
        </div>

        <div v-if="expandedMethod === method.name" class="method-details">
          <div class="detail-section">
            <h4>å®ç°æ€è·¯</h4>
            <p>{{ method.thinking }}</p>
          </div>

          <div class="detail-section">
            <h4>åŸç”Ÿæ–¹æ³•è¡Œä¸º</h4>
            <ul>
              <li v-for="(behavior, index) in method.behaviors" :key="index">{{ behavior }}</li>
            </ul>
          </div>

          <div class="detail-section">
            <h4>å®ç°ä»£ç </h4>
            <pre>{{ method.implementation }}</pre>
          </div>

          <div class="detail-section">
            <h4>ä½¿ç”¨ç¤ºä¾‹</h4>
            <div class="example-container">
              <pre>{{ method.example }}</pre>
              <button class="run-button" @click="runExample(method.name)">è¿è¡Œç¤ºä¾‹</button>
            </div>
            <div v-if="method.result" class="result-output">
              <strong>è¾“å‡ºç»“æœ:</strong> {{ method.result }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="advanced-section">
      <h2>é«˜çº§æ•°ç»„æ–¹æ³•å®ç°</h2>

      <div class="advanced-methods">
        <div class="advanced-method">
          <div class="method-header">
            <div class="method-icon">ğŸ“¤</div>
            <h3>Array.prototype.flat</h3>
          </div>
          <div class="implementation">
            <pre>
Array.prototype.myFlat = function(depth = 1) {
  const result = [];

  const flatten = (arr, currentDepth) => {
    for (const item of arr) {
      if (Array.isArray(item) && currentDepth > 0) {
        flatten(item, currentDepth - 1);
      } else {
        result.push(item);
      }
    }
  };

  flatten(this, depth);
  return result;
};</pre
            >
          </div>
        </div>

        <div class="advanced-method">
          <div class="method-header">
            <div class="method-icon">âš–ï¸</div>
            <h3>Array.prototype.reduceRight</h3>
          </div>
          <div class="implementation">
            <pre>
Array.prototype.myReduceRight = function(callback, initialValue) {
  let accumulator = initialValue;
  let startIndex = this.length - 1;

  if (arguments.length < 2) {
    if (this.length === 0) {
      throw new TypeError('Reduce of empty array with no initial value');
    }
    accumulator = this[this.length - 1];
    startIndex = this.length - 2;
  }

  for (let i = startIndex; i >= 0; i--) {
    accumulator = callback(accumulator, this[i], i, this);
  }

  return accumulator;
};</pre
            >
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>æŒæ¡æ•°ç»„æ–¹æ³•çš„åº•å±‚å®ç°æ˜¯æˆä¸ºé«˜çº§ JavaScript å¼€å‘è€…çš„å…³é”®ä¸€æ­¥</p>
      <p>ç†è§£è¿™äº›æ ¸å¿ƒæ–¹æ³•çš„å·¥ä½œåŸç†å°†å¸®åŠ©ä½ ç¼–å†™æ›´é«˜æ•ˆã€æ›´å¯é çš„ä»£ç </p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const expandedMethod = ref('map')
const methods = ref([
  {
    name: 'Array.prototype.map',
    icon: 'ğŸ—ºï¸',
    summary: 'åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡æä¾›çš„å‡½æ•°åçš„è¿”å›å€¼',
    thinking: 'éå†åŸæ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°ï¼Œå°†ç»“æœæ”¶é›†åˆ°æ–°æ•°ç»„ä¸­',
    behaviors: [
      'è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸æ”¹å˜åŸæ•°ç»„',
      'éå†æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬ç©ºæ§½',
      'å›è°ƒå‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼šå½“å‰å…ƒç´ ã€ç´¢å¼•ã€åŸæ•°ç»„',
      'å¦‚æœæ•°ç»„æ˜¯ç¨€ç–çš„ï¼Œå›è°ƒå‡½æ•°ä¸ä¼šåœ¨ç©ºæ§½ä¸Šè°ƒç”¨',
    ],
    implementation: `Array.prototype.myMap = function(callback, thisArg) {
  // æ£€æŸ¥å›è°ƒæ˜¯å¦ä¸ºå‡½æ•°
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const result = [];
  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    // è·³è¿‡ç©ºæ§½
    if (i in array) {
      result[i] = callback.call(thisArg, array[i], i, array);
    }
  }

  return result;
};`,
    example: `const numbers = [1, 2, 3, 4];
const doubled = numbers.myMap(num => num * 2);

console.log(doubled);`,
    result: '',
  },
  {
    name: 'Array.prototype.filter',
    icon: 'ğŸ”',
    summary: 'åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼ŒåŒ…å«é€šè¿‡æ‰€æä¾›å‡½æ•°æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨æµ‹è¯•å‡½æ•°ï¼Œå°†ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æ·»åŠ åˆ°æ–°æ•°ç»„ä¸­',
    behaviors: [
      'è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¸æ”¹å˜åŸæ•°ç»„',
      'æ–°æ•°ç»„åªåŒ…å«é€šè¿‡æµ‹è¯•çš„å…ƒç´ ',
      'å›è°ƒå‡½æ•°åº”è¿”å›å¸ƒå°”å€¼',
      'ç©ºæ§½ä¼šè¢«è·³è¿‡',
    ],
    implementation: `Array.prototype.myFilter = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const result = [];
  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array && callback.call(thisArg, array[i], i, array)) {
      result.push(array[i]);
    }
  }

  return result;
};`,
    example: `const numbers = [1, 2, 3, 4, 5];
const evenNumbers = numbers.myFilter(num => num % 2 === 0);

console.log(evenNumbers);`,
    result: '',
  },
  {
    name: 'Array.prototype.find',
    icon: 'ğŸ”',
    summary: 'è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨æµ‹è¯•å‡½æ•°ï¼Œè¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ',
    behaviors: [
      'è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ',
      'å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å› undefined',
      'ä¸æ”¹å˜åŸæ•°ç»„',
      'åœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ååœæ­¢éå†',
    ],
    implementation: `Array.prototype.myFind = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array && callback.call(thisArg, array[i], i, array)) {
      return array[i];
    }
  }

  return undefined;
};`,
    example: `const users = [
  { id: 1, name: 'Alice' },
  { id: 2, name: 'Bob' },
  { id: 3, name: 'Charlie' }
];

const user = users.myFind(user => user.id === 2);
console.log(user);`,
    result: '',
  },
  {
    name: 'Array.prototype.findIndex',
    icon: 'ğŸ“Œ',
    summary: 'è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨æµ‹è¯•å‡½æ•°ï¼Œè¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•',
    behaviors: [
      'è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•',
      'å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å› -1',
      'ä¸æ”¹å˜åŸæ•°ç»„',
      'åœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ååœæ­¢éå†',
    ],
    implementation: `Array.prototype.myFindIndex = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array && callback.call(thisArg, array[i], i, array)) {
      return i;
    }
  }

  return -1;
};`,
    example: `const numbers = [5, 12, 8, 130, 44];
const isLarge = num => num > 10;
const index = numbers.myFindIndex(isLarge);

console.log(index);`,
    result: '',
  },
  {
    name: 'Array.prototype.every',
    icon: 'âœ…',
    summary: 'æµ‹è¯•ä¸€ä¸ªæ•°ç»„å†…çš„æ‰€æœ‰å…ƒç´ æ˜¯å¦éƒ½èƒ½é€šè¿‡æŒ‡å®šå‡½æ•°çš„æµ‹è¯•',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨æµ‹è¯•å‡½æ•°ï¼Œå¦‚æœæ‰€æœ‰å…ƒç´ éƒ½é€šè¿‡æµ‹è¯•åˆ™è¿”å› true',
    behaviors: ['è¿”å›å¸ƒå°”å€¼', 'ç©ºæ•°ç»„è°ƒç”¨è¿”å› true', 'é‡åˆ°ç¬¬ä¸€ä¸ª false ç«‹å³è¿”å›', 'ä¸æ”¹å˜åŸæ•°ç»„'],
    implementation: `Array.prototype.myEvery = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array && !callback.call(thisArg, array[i], i, array)) {
      return false;
    }
  }

  return true;
};`,
    example: `const numbers = [12, 5, 8, 130, 44];
const allAboveTen = numbers.myEvery(num => num > 10);
const allAboveFour = numbers.myEvery(num => num > 4);

console.log(allAboveTen, allAboveFour);`,
    result: '',
  },
  {
    name: 'Array.prototype.some',
    icon: 'ğŸ”¶',
    summary: 'æµ‹è¯•æ•°ç»„ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡äº†æä¾›çš„å‡½æ•°æµ‹è¯•',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨æµ‹è¯•å‡½æ•°ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ é€šè¿‡æµ‹è¯•åˆ™è¿”å› true',
    behaviors: ['è¿”å›å¸ƒå°”å€¼', 'ç©ºæ•°ç»„è°ƒç”¨è¿”å› false', 'é‡åˆ°ç¬¬ä¸€ä¸ª true ç«‹å³è¿”å›', 'ä¸æ”¹å˜åŸæ•°ç»„'],
    implementation: `Array.prototype.mySome = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array && callback.call(thisArg, array[i], i, array)) {
      return true;
    }
  }

  return false;
};`,
    example: `const numbers = [1, 2, 3, 4, 5];
const hasEven = numbers.mySome(num => num % 2 === 0);
const hasNegative = numbers.mySome(num => num < 0);

console.log(hasEven, hasNegative);`,
    result: '',
  },
  {
    name: 'Array.prototype.reduce',
    icon: 'ğŸ§®',
    summary: 'å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æŒ‰åºæ‰§è¡Œä¸€ä¸ªæä¾›çš„ reducer å‡½æ•°',
    thinking: 'éå†æ•°ç»„ï¼Œå°†å‰ä¸€æ¬¡å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä½œä¸ºä¸‹ä¸€æ¬¡å›è°ƒå‡½æ•°çš„å‚æ•°',
    behaviors: [
      'è¿”å›ä¸€ä¸ªå€¼',
      'å¦‚æœæ²¡æœ‰åˆå§‹å€¼ï¼Œåˆ™ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåˆå§‹å€¼',
      'ç©ºæ•°ç»„è°ƒç”¨ä¸”æ— åˆå§‹å€¼ä¼šæŠ¥é”™',
      'å¯ä»¥ç”¨äºæ•°ç»„æ±‚å’Œã€æ‰å¹³åŒ–ç­‰å¤šç§æ“ä½œ',
    ],
    implementation: `Array.prototype.myReduce = function(callback, initialValue) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  let accumulator = initialValue;
  let startIndex = 0;

  if (arguments.length < 2) {
    if (length === 0) {
      throw new TypeError('Reduce of empty array with no initial value');
    }

    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå­˜åœ¨çš„å…ƒç´ ä½œä¸ºåˆå§‹å€¼
    while (startIndex < length && !(startIndex in array)) {
      startIndex++;
    }

    if (startIndex >= length) {
      throw new TypeError('Reduce of empty array with no initial value');
    }

    accumulator = array[startIndex];
    startIndex++;
  }

  for (let i = startIndex; i < length; i++) {
    if (i in array) {
      accumulator = callback(accumulator, array[i], i, array);
    }
  }

  return accumulator;
};`,
    example: `const numbers = [1, 2, 3, 4];
const sum = numbers.myReduce((acc, curr) => acc + curr, 0);
const product = numbers.myReduce((acc, curr) => acc * curr, 1);

console.log(sum, product);`,
    result: '',
  },
  {
    name: 'Array.prototype.sort',
    icon: 'ğŸ”€',
    summary: 'å¯¹æ•°ç»„çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›æ•°ç»„',
    thinking: 'å®ç°ä¸€ä¸ªåŸåœ°æ’åºç®—æ³•ï¼ˆå¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºï¼‰',
    behaviors: [
      'åŸåœ°æ’åºï¼ˆæ”¹å˜åŸæ•°ç»„ï¼‰',
      'é»˜è®¤æ’åºé¡ºåºæ˜¯å°†å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒ',
      'å¯ä»¥æ¥å—æ¯”è¾ƒå‡½æ•°',
      'ä¸ç¨³å®šæ’åºï¼ˆV8ä½¿ç”¨TimSortï¼Œç¨³å®šï¼‰',
    ],
    implementation: `Array.prototype.mySort = function(compareFn) {
  // é»˜è®¤æ¯”è¾ƒå‡½æ•°
  const defaultCompare = (a, b) => {
    const aStr = String(a);
    const bStr = String(b);
    if (aStr < bStr) return -1;
    if (aStr > bStr) return 1;
    return 0;
  };

  const comparator = compareFn || defaultCompare;

  // ä½¿ç”¨å¿«é€Ÿæ’åºå®ç°
  const quickSort = (arr, left = 0, right = arr.length - 1) => {
    if (left >= right) return;

    const pivotIndex = partition(arr, left, right);
    quickSort(arr, left, pivotIndex - 1);
    quickSort(arr, pivotIndex + 1, right);
  };

  const partition = (arr, left, right) => {
    const pivot = arr[right];
    let partitionIndex = left;

    for (let i = left; i < right; i++) {
      if (comparator(arr[i], pivot) < 0) {
        [arr[i], arr[partitionIndex]] = [arr[partitionIndex], arr[i]];
        partitionIndex++;
      }
    }

    [arr[right], arr[partitionIndex]] = [arr[partitionIndex], arr[right]];
    return partitionIndex;
  };

  quickSort(this);
  return this;
};`,
    example: `const numbers = [3, 1, 4, 1, 5, 9, 2, 6];
numbers.mySort((a, b) => a - b);

console.log(numbers);`,
    result: '',
  },
  {
    name: 'Array.prototype.forEach',
    icon: 'ğŸ”„',
    summary: 'å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€æ¬¡ç»™å®šçš„å‡½æ•°',
    thinking: 'éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå­˜åœ¨çš„å…ƒç´ æ‰§è¡Œå›è°ƒå‡½æ•°',
    behaviors: [
      'ä¸è¿”å›ä»»ä½•å€¼',
      'ä¸èƒ½ä¸­é€”ç»ˆæ­¢ï¼ˆé™¤éæŠ›å‡ºå¼‚å¸¸ï¼‰',
      'ä¸æ”¹å˜åŸæ•°ç»„ï¼ˆé™¤éåœ¨å›è°ƒä¸­æ”¹å˜ï¼‰',
      'è·³è¿‡ç©ºæ§½',
    ],
    implementation: `Array.prototype.myForEach = function(callback, thisArg) {
  if (typeof callback !== 'function') {
    throw new TypeError(callback + ' is not a function');
  }

  const array = Object(this);
  const length = array.length >>> 0;

  for (let i = 0; i < length; i++) {
    if (i in array) {
      callback.call(thisArg, array[i], i, array);
    }
  }
};`,
    example: `const fruits = ['apple', 'banana', 'cherry'];
fruits.myForEach((fruit, index) => {
  console.log(\`\${index + 1}. \${fruit}\`);
});`,
    result: '',
  },
  {
    name: 'Array.prototype.at',
    icon: 'ğŸ”„',
    summary: 'è¿”å›æ•°ç»„ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ',
    thinking: 'è¿”å›æ•°ç»„ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ',
    behaviors: [
      'è¿”å›æŒ‡å®šä½ç½®çš„å…ƒç´ ',
      'å¦‚æœç´¢å¼•ä¸ºè´Ÿæ•°ï¼Œåˆ™ä»æ•°ç»„æœ«å°¾å¼€å§‹è®¡ç®—',
      'å¦‚æœç´¢å¼•è¶…å‡ºèŒƒå›´ï¼Œåˆ™è¿”å› undefined',
      'ä¸æ”¹å˜åŸæ•°ç»„',
    ],
    implementation: `Array.prototype.myAt = function(index) {
      const array = Object(this);
      const length = array.length >>> 0;
      const i = index < 0 ? length + index : index;
      return i in array ? array[i] : undefined;
    };`,
    example: `const fruits = ['apple', 'banana', 'cherry'];
const first = fruits.myAt(0);
const last = fruits.myAt(-1);

console.log(first, last);`,
    result: '',
  },
])

const toggleMethod = (methodName: string) => {
  expandedMethod.value = expandedMethod.value === methodName ? '' : methodName
}

const runExample = (methodName: string) => {
  const method = methods.value.find((m) => m.name === methodName)
  if (!method) return

  try {
    // åˆ›å»ºä¸€ä¸ªå®‰å…¨çš„æ‰§è¡Œç¯å¢ƒ
    const fn = new Function(`
      // æ·»åŠ  polyfill
      if (!Array.prototype.myMap) {
        Array.prototype.myMap = ${methods.value.find((m) => m.name === 'Array.prototype.map')?.implementation};
      }
      if (!Array.prototype.myFilter) {
        Array.prototype.myFilter = ${methods.value.find((m) => m.name === 'Array.prototype.filter')?.implementation};
      }
      if (!Array.prototype.myFind) {
        Array.prototype.myFind = ${methods.value.find((m) => m.name === 'Array.prototype.find')?.implementation};
      }
      if (!Array.prototype.myFindIndex) {
        Array.prototype.myFindIndex = ${methods.value.find((m) => m.name === 'Array.prototype.findIndex')?.implementation};
      }
      if (!Array.prototype.myEvery) {
        Array.prototype.myEvery = ${methods.value.find((m) => m.name === 'Array.prototype.every')?.implementation};
      }
      if (!Array.prototype.mySome) {
        Array.prototype.mySome = ${methods.value.find((m) => m.name === 'Array.prototype.some')?.implementation};
      }
      if (!Array.prototype.myReduce) {
        Array.prototype.myReduce = ${methods.value.find((m) => m.name === 'Array.prototype.reduce')?.implementation};
      }
      if (!Array.prototype.mySort) {
        Array.prototype.mySort = ${methods.value.find((m) => m.name === 'Array.prototype.sort')?.implementation};
      }
      if (!Array.prototype.myForEach) {
        Array.prototype.myForEach = ${methods.value.find((m) => m.name === 'Array.prototype.forEach')?.implementation};
      }

      // æ‰§è¡Œç¤ºä¾‹ä»£ç 
      const result = (function() {
        ${method.example}
      })();

      return typeof result === 'object' ? JSON.stringify(result) : String(result);
    `)

    const result = fn()
    method.result = result
  } catch (error) {
    method.result = `é”™è¯¯: ${(error as Error).message}`
  }
}
</script>

<style lang="less" scoped>
.array-methods-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #2d3748;
  background-color: #f8fafc;
  border-radius: 16px;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.05);

  .header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid #e2e8f0;

    h1 {
      font-size: 2.4rem;
      color: #2b6cb0;
      margin-bottom: 0.8rem;
      font-weight: 700;
    }

    p {
      font-size: 1.1rem;
      color: #718096;
      margin-bottom: 0;
    }
  }

  .methods-overview {
    .overview-card {
      display: flex;
      gap: 1.5rem;
      background: #ebf8ff;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-left: 4px solid #4299e1;

      .overview-icon {
        font-size: 3rem;
        flex-shrink: 0;
      }

      .overview-content {
        h2 {
          font-size: 1.6rem;
          color: #2b6cb0;
          margin-top: 0;
          margin-bottom: 1rem;
        }

        p {
          font-size: 1.05rem;
          line-height: 1.7;
          color: #4a5568;
          margin-bottom: 1.5rem;
        }

        .benefits {
          display: flex;
          flex-wrap: wrap;
          gap: 1rem;

          .benefit {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);

            .benefit-icon {
              font-size: 1.2rem;
            }
          }
        }
      }
    }
  }

  .methods-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;

    .method-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.06);
      overflow: hidden;
      transition: all 0.3s ease;

      &.expanded {
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .method-header {
        display: flex;
        align-items: center;
        padding: 1.2rem 1.5rem;
        background: #f7fafc;
        cursor: pointer;
        transition: background 0.2s ease;

        &:hover {
          background: #ebf8ff;
        }

        .method-icon {
          font-size: 1.8rem;
          margin-right: 1rem;
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: #e6f7ff;
          border-radius: 8px;
        }

        h3 {
          font-size: 1.3rem;
          color: #2b6cb0;
          margin: 0;
          flex-grow: 1;
        }

        .method-summary {
          font-size: 0.9rem;
          color: #718096;
          margin-right: 1rem;
          max-width: 300px;
        }

        .expand-icon {
          font-size: 1.2rem;
          color: #718096;
        }
      }

      .method-details {
        padding: 1.5rem;
        border-top: 1px solid #e2e8f0;

        .detail-section {
          margin-bottom: 1.5rem;

          h4 {
            font-size: 1.1rem;
            color: #2b6cb0;
            margin-top: 0;
            margin-bottom: 0.8rem;
          }

          p {
            line-height: 1.7;
            color: #4a5568;
          }

          ul {
            padding-left: 1.5rem;
            margin: 0;

            li {
              margin-bottom: 0.5rem;
              line-height: 1.6;
              color: #4a5568;
            }
          }

          pre {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 1.2rem;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
            margin: 1rem 0;
          }

          .example-container {
            position: relative;

            .run-button {
              position: absolute;
              top: 0.5rem;
              right: 0.5rem;
              background: #4299e1;
              color: white;
              border: none;
              border-radius: 4px;
              padding: 0.3rem 0.8rem;
              font-size: 0.85rem;
              cursor: pointer;
              transition: background 0.2s ease;

              &:hover {
                background: #3182ce;
              }
            }
          }

          .result-output {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 0.8rem 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            font-family: 'Fira Code', monospace;
          }
        }
      }
    }
  }

  .advanced-section {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
    margin-bottom: 2rem;

    h2 {
      font-size: 1.6rem;
      color: #2b6cb0;
      margin-top: 0;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .advanced-methods {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 1.5rem;

      .advanced-method {
        background: #f7fafc;
        border-radius: 10px;
        padding: 1.5rem;
        border: 1px solid #e2e8f0;

        .method-header {
          display: flex;
          align-items: center;
          margin-bottom: 1.2rem;

          .method-icon {
            font-size: 1.8rem;
            margin-right: 1rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #e6f7ff;
            border-radius: 8px;
          }

          h3 {
            font-size: 1.3rem;
            color: #2b6cb0;
            margin: 0;
          }
        }

        .implementation {
          pre {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 8px;
            padding: 1.2rem;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            overflow-x: auto;
          }
        }
      }
    }
  }

  .footer {
    text-align: center;
    margin-top: 3rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e2e8f0;
    color: #718096;
    font-size: 0.95rem;
    line-height: 1.6;

    p {
      margin-bottom: 0.5rem;
    }
  }
}

@media (max-width: 768px) {
  .array-methods-container {
    padding: 1rem;

    .header h1 {
      font-size: 1.8rem;
    }

    .methods-grid {
      grid-template-columns: 1fr;

      .method-card {
        .method-header {
          flex-wrap: wrap;

          .method-summary {
            order: 3;
            margin-top: 0.5rem;
            margin-left: 3rem;
            max-width: 100%;
          }
        }
      }
    }

    .advanced-section .advanced-methods {
      grid-template-columns: 1fr;
    }
  }
}
</style>
