<template>
  <div class="js-execution-container">
    <header class="header">
      <h1>æµè§ˆå™¨æ‰§è¡ŒJavaScriptæµç¨‹ä»‹ç»</h1>
      <p class="subtitle">ä»ä¸‹è½½åˆ°æ‰§è¡Œçš„å…¨è¿‡ç¨‹è§£æ</p>
    </header>

    <div class="content-wrapper">
      <section class="overview">
        <h2><span class="icon">ğŸŒ</span> æ•´ä½“æµç¨‹æ¦‚è§ˆ</h2>
        <div class="process-flow">
          <div class="process-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>ä¸‹è½½</h3>
              <p>ä»æœåŠ¡å™¨è·å–JavaScriptæ–‡ä»¶</p>
            </div>
          </div>
          <div class="arrow">â†’</div>
          <div class="process-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>è§£æ</h3>
              <p>å°†æºä»£ç è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘(AST)</p>
            </div>
          </div>
          <div class="arrow">â†’</div>
          <div class="process-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>ç¼–è¯‘</h3>
              <p>å°†ASTè½¬æ¢ä¸ºå­—èŠ‚ç æˆ–æœºå™¨ç </p>
            </div>
          </div>
          <div class="arrow">â†’</div>
          <div class="process-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h3>æ‰§è¡Œ</h3>
              <p>åœ¨JavaScriptå¼•æ“ä¸­æ‰§è¡Œä»£ç </p>
            </div>
          </div>
        </div>
      </section>

      <div class="columns">
        <section class="download">
          <h2><span class="icon">ğŸ“¥</span> ä¸‹è½½é˜¶æ®µ</h2>
          <div class="card">
            <p>å½“æµè§ˆå™¨é‡åˆ° <code>&lt;script&gt;</code> æ ‡ç­¾æ—¶ï¼Œä¼šå¼€å§‹ä¸‹è½½JavaScriptæ–‡ä»¶ã€‚</p>

            <div class="comparison">
              <div class="script-type">
                <h3>å¸¸è§„è„šæœ¬</h3>
                <div class="code-block">
                  <pre><code>&lt;script src="app.js"&gt;&lt;/script&gt;</code></pre>
                </div>
                <ul>
                  <li>é˜»å¡HTMLè§£æ</li>
                  <li>ä¸‹è½½å®Œæˆåç«‹å³æ‰§è¡Œ</li>
                  <li>æŒ‰æ–‡æ¡£é¡ºåºæ‰§è¡Œ</li>
                </ul>
              </div>

              <div class="script-type">
                <h3>å¼‚æ­¥è„šæœ¬</h3>
                <div class="code-block">
                  <pre><code>&lt;script async src="app.js"&gt;&lt;/script&gt;</code></pre>
                </div>
                <ul>
                  <li>å¼‚æ­¥ä¸‹è½½ï¼Œä¸é˜»å¡HTMLè§£æ</li>
                  <li>ä¸‹è½½å®Œæˆåç«‹å³æ‰§è¡Œ</li>
                  <li>æ‰§è¡Œé¡ºåºä¸ç¡®å®š</li>
                </ul>
              </div>

              <div class="script-type">
                <h3>å»¶è¿Ÿè„šæœ¬</h3>
                <div class="code-block">
                  <pre><code>&lt;script defer src="app.js"&gt;&lt;/script&gt;</code></pre>
                </div>
                <ul>
                  <li>å¼‚æ­¥ä¸‹è½½ï¼Œä¸é˜»å¡HTMLè§£æ</li>
                  <li>åœ¨DOMContentLoadedäº‹ä»¶å‰æŒ‰é¡ºåºæ‰§è¡Œ</li>
                  <li>ä¿è¯æ‰§è¡Œé¡ºåº</li>
                </ul>
              </div>
            </div>

            <div class="optimization">
              <h3>ä¼˜åŒ–å»ºè®®ï¼š</h3>
              <ul>
                <li>ä½¿ç”¨<code>async</code>æˆ–<code>defer</code>å±æ€§é¿å…é˜»å¡æ¸²æŸ“</li>
                <li>å‹ç¼©JavaScriptæ–‡ä»¶å‡å°‘ä¸‹è½½æ—¶é—´</li>
                <li>ä½¿ç”¨HTTP/2å¤šè·¯å¤ç”¨åŠ é€Ÿä¸‹è½½</li>
                <li>åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜å‡å°‘é‡å¤ä¸‹è½½</li>
              </ul>
            </div>
          </div>
        </section>

        <section class="parsing">
          <h2><span class="icon">ğŸ”</span> è§£æé˜¶æ®µ</h2>
          <div class="card">
            <p>è§£ææ˜¯å°†æºä»£ç è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘(AST)çš„è¿‡ç¨‹ã€‚</p>

            <h3>è§£ææ­¥éª¤ï¼š</h3>
            <ol class="detailed-steps">
              <li>
                <strong>è¯æ³•åˆ†æ(Lexical Analysis)</strong>
                <p>å°†å­—ç¬¦æµåˆ†è§£ä¸ºtokenï¼ˆæ ‡è®°ï¼‰åºåˆ—</p>
                <div class="code-example">
                  <pre><code>// æºä»£ç 
const sum = a + b;

// Tokenåºåˆ—:
[
  { type: 'Keyword', value: 'const' },
  { type: 'Identifier', value: 'sum' },
  { type: 'Punctuator', value: '=' },
  { type: 'Identifier', value: 'a' },
  { type: 'Punctuator', value: '+' },
  { type: 'Identifier', value: 'b' },
  { type: 'Punctuator', value: ';' }
]</code></pre>
                </div>
              </li>

              <li>
                <strong>è¯­æ³•åˆ†æ(Syntax Analysis)</strong>
                <p>æ ¹æ®è¯­æ³•è§„åˆ™å°†tokenåºåˆ—è½¬æ¢ä¸ºAST</p>
                <div class="code-example">
                  <pre><code>// ASTç»“æ„
{
  type: "Program",
  body: [{
    type: "VariableDeclaration",
    declarations: [{
      type: "VariableDeclarator",
      id: { type: "Identifier", name: "sum" },
      init: {
        type: "BinaryExpression",
        operator: "+",
        left: { type: "Identifier", name: "a" },
        right: { type: "Identifier", name: "b" }
      }
    }],
    kind: "const"
  }]
}</code></pre>
                </div>
              </li>
            </ol>

            <div class="parsing-notes">
              <h3>è§£ææ³¨æ„äº‹é¡¹ï¼š</h3>
              <ul>
                <li>ç°ä»£æµè§ˆå™¨ä½¿ç”¨æµå¼è§£æï¼Œå¯ä»¥è¾¹ä¸‹è½½è¾¹è§£æ</li>
                <li>è¯­æ³•é”™è¯¯ä¼šåœ¨è§£æé˜¶æ®µè¢«å‘ç°</li>
                <li>è§£ææ˜¯CPUå¯†é›†å‹æ“ä½œï¼Œåº”é¿å…è¿‡å¤§çš„JSæ–‡ä»¶</li>
              </ul>
            </div>
          </div>
        </section>
      </div>

      <section class="ast">
        <h2><span class="icon">ğŸŒ²</span> æŠ½è±¡è¯­æ³•æ ‘(AST)</h2>
        <div class="card">
          <div class="ast-intro">
            <p>
              æŠ½è±¡è¯­æ³•æ ‘(Abstract Syntax
              Tree)æ˜¯æºä»£ç çš„æ ‘çŠ¶è¡¨ç¤ºï¼Œå®ƒçœç•¥äº†æºä»£ç ä¸­çš„ç»†èŠ‚ï¼ˆå¦‚åˆ†å·ã€ç©ºç™½ç¬¦ï¼‰ï¼Œåªä¿ç•™ç¨‹åºçš„ç»“æ„ä¿¡æ¯ã€‚
            </p>

            <div class="ast-visual">
              <div class="ast-node root">
                Program
                <div class="ast-node child">
                  FunctionDeclaration
                  <div class="ast-node child">Identifier (name: "sum")</div>
                  <div class="ast-node child">
                    BlockStatement
                    <div class="ast-node child">
                      ReturnStatement
                      <div class="ast-node child">
                        BinaryExpression (operator: "+")
                        <div class="ast-node child">Identifier (name: "a")</div>
                        <div class="ast-node child">Identifier (name: "b")</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="ast-usage">
            <h3>ASTçš„åº”ç”¨åœºæ™¯ï¼š</h3>
            <div class="usage-grid">
              <div class="usage-card">
                <h4>ä»£ç è½¬æ¢</h4>
                <p>Babelä½¿ç”¨ASTå°†ES6+ä»£ç è½¬æ¢ä¸ºES5</p>
              </div>
              <div class="usage-card">
                <h4>ä»£ç å‹ç¼©</h4>
                <p>UglifyJSé€šè¿‡ASTåˆ é™¤æ— ç”¨ä»£ç </p>
              </div>
              <div class="usage-card">
                <h4>ä»£ç æ ¼å¼åŒ–</h4>
                <p>Prettierä½¿ç”¨ASTé‡æ–°ç”Ÿæˆæ ¼å¼åŒ–çš„ä»£ç </p>
              </div>
              <div class="usage-card">
                <h4>è¯­æ³•é«˜äº®</h4>
                <p>ç¼–è¾‘å™¨é€šè¿‡ASTç¡®å®šä»£ç ç»“æ„</p>
              </div>
            </div>
          </div>

          <div class="ast-tools">
            <h3>ASTæ¢ç´¢å·¥å…·ï¼š</h3>
            <ul>
              <li>
                <a href="https://astexplorer.net/" target="_blank">AST Explorer</a> - åœ¨çº¿ASTæŸ¥çœ‹å™¨
              </li>
              <li>Babel Parser - ç”ŸæˆJavaScript AST</li>
              <li>ESLint - ä½¿ç”¨ASTè¿›è¡Œä»£ç æ£€æŸ¥</li>
            </ul>
          </div>
        </div>
      </section>

      <div class="columns">
        <section class="compilation">
          <h2><span class="icon">âš™ï¸</span> ç¼–è¯‘é˜¶æ®µ</h2>
          <div class="card">
            <p>JavaScriptå¼•æ“å°†ASTè½¬æ¢ä¸ºå¯æ‰§è¡Œçš„å­—èŠ‚ç æˆ–æœºå™¨ç ã€‚</p>

            <h3>V8å¼•æ“ç¼–è¯‘æµç¨‹ï¼š</h3>
            <div class="compilation-steps">
              <div class="step">
                <div class="step-header">1. Ignitionè§£é‡Šå™¨</div>
                <div class="step-content">
                  <p>å°†ASTè½¬æ¢ä¸ºå­—èŠ‚ç </p>
                  <ul>
                    <li>å¿«é€Ÿç”Ÿæˆå¯æ‰§è¡Œä»£ç </li>
                    <li>å ç”¨å†…å­˜å°‘</li>
                    <li>æ‰§è¡Œé€Ÿåº¦è¾ƒæ…¢</li>
                  </ul>
                </div>
              </div>

              <div class="step">
                <div class="step-header">2. TurboFanä¼˜åŒ–ç¼–è¯‘å™¨</div>
                <div class="step-content">
                  <p>å°†çƒ­ç‚¹å‡½æ•°ç¼–è¯‘ä¸ºä¼˜åŒ–æœºå™¨ç </p>
                  <ul>
                    <li>åˆ†æä»£ç æ‰§è¡Œæ¨¡å¼</li>
                    <li>è¿›è¡Œç±»å‹ç‰¹åŒ–å’Œå†…è”ç¼“å­˜</li>
                    <li>ç”Ÿæˆé«˜åº¦ä¼˜åŒ–çš„æœºå™¨ç </li>
                  </ul>
                </div>
              </div>

              <div class="step">
                <div class="step-header">3. Deoptimization</div>
                <div class="step-content">
                  <p>å½“ä¼˜åŒ–å‡è®¾å¤±æ•ˆæ—¶å›é€€åˆ°å­—èŠ‚ç </p>
                  <ul>
                    <li>ç±»å‹å˜åŒ–å¯¼è‡´ä¼˜åŒ–æ— æ•ˆ</li>
                    <li>å›é€€åˆ°è§£é‡Šå™¨æ‰§è¡Œ</li>
                    <li>é‡æ–°æ”¶é›†ç±»å‹ä¿¡æ¯</li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="code-block">
              <pre><code>// ä¼˜åŒ–ç¤ºä¾‹
function add(a, b) {
  return a + b;
}

// é‡å¤è°ƒç”¨ç›¸åŒç±»å‹
add(1, 2); // è¢«TurboFanä¼˜åŒ–
add(3, 4); // ä½¿ç”¨ä¼˜åŒ–æœºå™¨ç 

// ç±»å‹å˜åŒ–å¯¼è‡´å»ä¼˜åŒ–
add('5', '6'); // å›é€€åˆ°å­—èŠ‚ç æ‰§è¡Œ</code></pre>
            </div>
          </div>
        </section>

        <section class="execution">
          <h2><span class="icon">ğŸš€</span> æ‰§è¡Œé˜¶æ®µ</h2>
          <div class="card">
            <p>JavaScriptä»£ç åœ¨å¼•æ“ä¸­æ‰§è¡Œï¼Œæ¶‰åŠè°ƒç”¨æ ˆã€äº‹ä»¶å¾ªç¯å’Œå†…å­˜ç®¡ç†ã€‚</p>

            <h3>æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ</h3>
            <div class="execution-context">
              <div class="context-stack">
                <div class="context">å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡</div>
                <div class="context">å‡½æ•°Aä¸Šä¸‹æ–‡</div>
                <div class="context">å‡½æ•°Bä¸Šä¸‹æ–‡</div>
              </div>
              <div class="context-explain">
                <p>åè¿›å…ˆå‡º(LIFO)ç»“æ„ï¼Œå½“å‰ä¸Šä¸‹æ–‡åœ¨æ ˆé¡¶</p>
              </div>
            </div>

            <h3>äº‹ä»¶å¾ªç¯æœºåˆ¶</h3>
            <div class="event-loop">
              <div class="loop-phase">
                <div class="phase-name">è°ƒç”¨æ ˆ</div>
                <div class="phase-tasks">åŒæ­¥ä»»åŠ¡</div>
              </div>
              <div class="loop-arrow">â†“</div>
              <div class="loop-phase">
                <div class="phase-name">å¾®ä»»åŠ¡é˜Ÿåˆ—</div>
                <div class="phase-tasks">Promise.then<br />MutationObserver</div>
              </div>
              <div class="loop-arrow">â†“</div>
              <div class="loop-phase">
                <div class="phase-name">å®ä»»åŠ¡é˜Ÿåˆ—</div>
                <div class="phase-tasks">setTimeout<br />setInterval<br />äº‹ä»¶å›è°ƒ</div>
              </div>
            </div>

            <div class="code-block">
              <pre><code>console.log('å¼€å§‹');

setTimeout(() => console.log('setTimeout'), 0);

Promise.resolve().then(() => console.log('Promise'));

console.log('ç»“æŸ');

/* è¾“å‡ºé¡ºåº:
   å¼€å§‹
   ç»“æŸ
   Promise
   setTimeout
*/</code></pre>
            </div>

            <div class="memory-management">
              <h3>å†…å­˜ç®¡ç†</h3>
              <ul>
                <li><strong>å †å†…å­˜</strong>ï¼šå­˜å‚¨å¯¹è±¡å’Œé—­åŒ…</li>
                <li><strong>æ ˆå†…å­˜</strong>ï¼šå­˜å‚¨åŸå§‹å€¼å’Œå¼•ç”¨åœ°å€</li>
                <li><strong>åƒåœ¾å›æ”¶</strong>ï¼šæ ‡è®°æ¸…é™¤å’Œåˆ†ä»£å›æ”¶</li>
              </ul>
            </div>
          </div>
        </section>
      </div>

      <section class="optimization">
        <h2><span class="icon">ğŸš€</span> æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
        <div class="card">
          <div class="optimization-grid">
            <div class="optimization-card">
              <h3>å‡å°‘è§£ææ—¶é—´</h3>
              <ul>
                <li>ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰</li>
                <li>é¿å…è¿‡å¤§çš„JavaScriptæ–‡ä»¶</li>
                <li>ä½¿ç”¨Tree Shakingåˆ é™¤æ— ç”¨ä»£ç </li>
              </ul>
            </div>

            <div class="optimization-card">
              <h3>ä¼˜åŒ–æ‰§è¡Œæ€§èƒ½</h3>
              <ul>
                <li>é¿å…"é­”é¬¼ä¼˜åŒ–æ€æ‰‹"ï¼ˆå¦‚argumentsï¼‰</li>
                <li>ä¿æŒå‡½æ•°å‚æ•°ç±»å‹ä¸€è‡´</li>
                <li>é¿å…åœ¨çƒ­ç‚¹å‡½æ•°ä¸­åˆ†é…æ–°å¯¹è±¡</li>
              </ul>
            </div>

            <div class="optimization-card">
              <h3>é«˜æ•ˆå†…å­˜ä½¿ç”¨</h3>
              <ul>
                <li>åŠæ—¶è§£é™¤ä¸å†éœ€è¦çš„å¼•ç”¨</li>
                <li>é¿å…å†…å­˜æ³„æ¼ï¼ˆå…¨å±€å˜é‡ã€æœªæ¸…é™¤çš„å®šæ—¶å™¨ï¼‰</li>
                <li>ä½¿ç”¨WeakMap/WeakSetç®¡ç†ä¸´æ—¶å¼•ç”¨</li>
              </ul>
            </div>

            <div class="optimization-card">
              <h3>åˆ©ç”¨ç°ä»£API</h3>
              <ul>
                <li>ä½¿ç”¨Web Workersæ‰§è¡ŒCPUå¯†é›†å‹ä»»åŠ¡</li>
                <li>ä½¿ç”¨requestIdleCallbackå®‰æ’éå…³é”®ä»»åŠ¡</li>
                <li>ä½¿ç”¨IntersectionObserverå»¶è¿ŸåŠ è½½èµ„æº</li>
              </ul>
            </div>
          </div>
        </div>
      </section>
    </div>

    <footer class="footer">
      <p>ç†è§£æµè§ˆå™¨æ‰§è¡ŒJavaScriptçš„æµç¨‹å¯¹äºç¼–å†™é«˜æ€§èƒ½Webåº”ç”¨è‡³å…³é‡è¦ã€‚</p>
      <p>ä½¿ç”¨Chrome DevToolsçš„Performanceå’ŒMemoryé¢æ¿åˆ†æä½ çš„åº”ç”¨æ€§èƒ½ã€‚</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
// æ­¤ç»„ä»¶ä¸éœ€è¦é¢å¤–çš„é€»è¾‘ï¼Œä»…ç”¨äºå±•ç¤ºJavaScriptæ‰§è¡Œæµç¨‹
</script>

<style lang="less" scoped>
// é¢œè‰²å˜é‡
@primary-color: #1976d2;
@secondary-color: #0d47a1;
@accent-color: #2196f3;
@light-bg: #f5f8fc;
@card-bg: #ffffff;
@text-color: #2c3e50;
@border-color: #e0e0e0;
@code-bg: #f8f9fc;
@success-color: #4caf50;
@warning-color: #ff9800;
@danger-color: #f44336;
@info-color: #2196f3;

// åŸºç¡€æ ·å¼
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.js-execution-container {
  font-family: 'Roboto', sans-serif;
  line-height: 1.6;
  color: @text-color;
  background-color: @light-bg;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.header {
  text-align: center;
  margin-bottom: 30px;
  padding: 30px 20px;
  background: linear-gradient(135deg, @primary-color, @secondary-color);
  color: white;
  border-radius: 12px;
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);

  h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    font-weight: 600;
  }

  .subtitle {
    font-size: 1.2rem;
    opacity: 0.9;
    font-weight: 300;
  }
}

.content-wrapper {
  background-color: @card-bg;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
  padding: 30px;
  margin-bottom: 30px;
}

h2 {
  font-size: 1.8rem;
  color: @primary-color;
  margin-bottom: 25px;
  padding-bottom: 12px;
  border-bottom: 2px solid #e8eaed;
  display: flex;
  align-items: center;

  .icon {
    margin-right: 12px;
    font-size: 1.5rem;
  }
}

h3 {
  font-size: 1.4rem;
  color: @secondary-color;
  margin: 20px 0 15px;
}

h4 {
  font-size: 1.2rem;
  color: @primary-color;
  margin: 15px 0 10px;
}

.card {
  background-color: @card-bg;
  border-radius: 10px;
  padding: 25px;
  margin-bottom: 30px;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
  border-left: 4px solid @primary-color;
}

.columns {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 25px;
  margin-bottom: 25px;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

// æµç¨‹æ¦‚è§ˆ
.process-flow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  margin: 20px 0;

  .process-step {
    flex: 1;
    min-width: 200px;
    text-align: center;
    background: #e3f2fd;
    border-radius: 10px;
    padding: 20px;
    margin: 10px;
    position: relative;

    .step-number {
      position: absolute;
      top: -15px;
      left: -15px;
      width: 30px;
      height: 30px;
      background: @primary-color;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .step-content {
      h3 {
        color: @primary-color;
        margin-top: 0;
      }
    }
  }

  .arrow {
    font-size: 2rem;
    color: @primary-color;
    margin: 0 -10px;
    z-index: 1;

    @media (max-width: 768px) {
      transform: rotate(90deg);
      margin: -10px 0;
    }
  }
}

// ä¸‹è½½é˜¶æ®µæ¯”è¾ƒ
.comparison {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 20px 0;

  .script-type {
    background: #e8f4ff;
    border-radius: 8px;
    padding: 15px;

    h3 {
      margin-top: 0;
      color: @info-color;
    }

    ul {
      padding-left: 20px;

      li {
        margin-bottom: 8px;
      }
    }
  }
}

// è¯¦ç»†æ­¥éª¤
.detailed-steps {
  list-style: none;
  counter-reset: step-counter;

  li {
    margin-bottom: 30px;
    padding-left: 50px;
    position: relative;

    &::before {
      counter-increment: step-counter;
      content: counter(step-counter);
      position: absolute;
      left: 0;
      top: 0;
      width: 36px;
      height: 36px;
      background: @primary-color;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
  }
}

.code-example {
  background-color: @code-bg;
  border-radius: 8px;
  padding: 15px;
  margin: 10px 0;
  overflow-x: auto;
  font-family: 'Source Code Pro', monospace;
  font-size: 0.9rem;
  border: 1px solid @border-color;
}

// ASTå¯è§†åŒ–
.ast-visual {
  margin: 20px 0;
  display: flex;
  justify-content: center;

  .ast-node {
    border: 2px solid @primary-color;
    border-radius: 8px;
    padding: 10px 15px;
    margin: 10px;
    text-align: center;
    background: #e3f2fd;
    position: relative;

    &.root {
      background: @primary-color;
      color: white;
      font-weight: bold;
    }

    &.child {
      margin-top: 30px;

      &::before {
        content: '';
        position: absolute;
        top: -20px;
        left: 50%;
        width: 2px;
        height: 20px;
        background: @primary-color;
      }
    }
  }
}

// ä½¿ç”¨åœºæ™¯ç½‘æ ¼
.usage-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;

  .usage-card {
    background: #e8f4ff;
    border-radius: 8px;
    padding: 15px;

    h4 {
      margin-top: 0;
      color: @primary-color;
    }
  }
}

// ç¼–è¯‘æ­¥éª¤
.compilation-steps {
  display: grid;
  gap: 20px;

  .step {
    background: #e3f2fd;
    border-radius: 8px;
    overflow: hidden;

    .step-header {
      background: @primary-color;
      color: white;
      padding: 12px 15px;
      font-weight: bold;
    }

    .step-content {
      padding: 15px;

      ul {
        padding-left: 20px;
      }
    }
  }
}

// æ‰§è¡Œä¸Šä¸‹æ–‡
.execution-context {
  .context-stack {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 20px 0;

    .context {
      width: 80%;
      padding: 15px;
      background: #e3f2fd;
      border: 2px solid @primary-color;
      text-align: center;
      margin-bottom: 10px;
      border-radius: 8px;

      &:last-child {
        background: @primary-color;
        color: white;
        font-weight: bold;
      }
    }
  }
}

// äº‹ä»¶å¾ªç¯
.event-loop {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 20px 0;

  .loop-phase {
    width: 80%;
    padding: 15px;
    background: #e3f2fd;
    border: 2px solid @primary-color;
    border-radius: 8px;
    margin-bottom: 15px;

    .phase-name {
      font-weight: bold;
      margin-bottom: 8px;
      color: @primary-color;
    }
  }

  .loop-arrow {
    font-size: 1.5rem;
    color: @primary-color;
    margin: 5px 0;
  }
}

// ä»£ç å—æ ·å¼
.code-block {
  background-color: @code-bg;
  border-radius: 8px;
  padding: 18px;
  margin: 18px 0;
  overflow-x: auto;
  font-family: 'Source Code Pro', monospace;
  font-size: 0.95rem;
  border: 1px solid @border-color;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);

  pre {
    margin: 0;
    white-space: pre-wrap;
  }

  code {
    color: #2c3e50;
    line-height: 1.5;
  }
}

// ä¼˜åŒ–ç½‘æ ¼
.optimization-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;

  .optimization-card {
    background: #e8f4ff;
    border-radius: 8px;
    padding: 20px;

    h3 {
      margin-top: 0;
      color: @primary-color;
    }

    ul {
      padding-left: 20px;
    }
  }
}

.footer {
  text-align: center;
  padding: 25px;
  font-style: italic;
  color: #666;
  margin-top: 20px;
  border-top: 1px solid @border-color;
  line-height: 1.8;
}

// å“åº”å¼è°ƒæ•´
@media (max-width: 768px) {
  .header h1 {
    font-size: 2rem;
  }

  h2 {
    font-size: 1.5rem;
  }

  .content-wrapper {
    padding: 20px;
  }

  .process-flow {
    flex-direction: column;

    .arrow {
      transform: rotate(90deg);
      margin: -10px 0;
    }
  }

  .columns {
    grid-template-columns: 1fr;
  }
}
</style>
