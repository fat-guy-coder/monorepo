<template>
  <div class="sql-injection-container">
    <div class="security-header">
      <div class="hacker-icon">ğŸ‘¤</div>
      <div class="shield-icon">ğŸ›¡ï¸</div>
      <h1>SQLæ³¨å…¥æ”»å‡»ä¸é˜²æŠ¤</h1>
      <p class="subtitle">ç†è§£æ”»å‡»åŸç†å¹¶æŒæ¡é˜²å¾¡ç­–ç•¥</p>
    </div>

    <div class="content-section">
      <div class="card danger-card">
        <h2><span class="icon">âš ï¸</span> ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ï¼Ÿ</h2>
        <div class="definition">
          <p><strong>SQLæ³¨å…¥(SQL Injection)</strong>æ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡åœ¨åº”ç”¨ç¨‹åºçš„è¾“å…¥å­—æ®µä¸­æ³¨å…¥æ¶æ„çš„SQLä»£ç ï¼Œä»è€Œæ“çºµæ•°æ®åº“æŸ¥è¯¢ï¼Œè·å–æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒçš„æ•°æ®åº“æ“ä½œã€‚
          </p>
          <div class="risk-level">
            é£é™©ç­‰çº§:
            <div class="level high">é«˜å±</div>
          </div>
        </div>

        <div class="impact-section">
          <h3>æ½œåœ¨å±å®³</h3>
          <div class="impacts">
            <div class="impact">
              <div class="impact-icon">ğŸ‘ï¸</div>
              <h4>æ•°æ®çªƒå–</h4>
              <p>è·å–æ•æ„Ÿç”¨æˆ·ä¿¡æ¯</p>
            </div>
            <div class="impact">
              <div class="impact-icon">âœï¸</div>
              <h4>æ•°æ®ç¯¡æ”¹</h4>
              <p>ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®åº“è®°å½•</p>
            </div>
            <div class="impact">
              <div class="impact-icon">ğŸ›‘</div>
              <h4>æ‹’ç»æœåŠ¡</h4>
              <p>ä½¿æ•°æ®åº“æœåŠ¡ä¸å¯ç”¨</p>
            </div>
            <div class="impact">
              <div class="impact-icon">ğŸšª</div>
              <h4>æƒé™æå‡</h4>
              <p>è·å–ç®¡ç†å‘˜æƒé™</p>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2><span class="icon">ğŸ”</span> SQLæ³¨å…¥åŸç†</h2>
        <div class="injection-process">
          <div class="step">
            <div class="step-number">1</div>
            <h3>æ¶æ„è¾“å…¥</h3>
            <p>æ”»å‡»è€…åœ¨è¾“å…¥å­—æ®µæ’å…¥SQLä»£ç </p>
          </div>
          <div class="arrow">â†’</div>
          <div class="step">
            <div class="step-number">2</div>
            <h3>åŠ¨æ€æ‹¼æ¥</h3>
            <p>åº”ç”¨ç¨‹åºæ‹¼æ¥SQLè¯­å¥</p>
          </div>
          <div class="arrow">â†’</div>
          <div class="step">
            <div class="step-number">3</div>
            <h3>æ‰§è¡Œæ”»å‡»</h3>
            <p>æ•°æ®åº“æ‰§è¡Œæ¶æ„SQL</p>
          </div>
          <div class="arrow">â†’</div>
          <div class="step">
            <div class="step-number">4</div>
            <h3>è·å–æ•°æ®</h3>
            <p>æ”»å‡»è€…è·å–éæ³•è®¿é—®æƒé™</p>
          </div>
        </div>

        <div class="code-demo">
          <div class="attack-example">
            <h3>æ”»å‡»ç¤ºä¾‹</h3>
            <div class="code-block">
              <div class="code-line">ç”¨æˆ·å: <span class="user-input">admin' --</span></div>
              <div class="code-line">å¯†ç : <span class="user-input">ä»»æ„å€¼</span></div>
              <div class="code-line">ç”Ÿæˆçš„SQL:</div>
              <div class="code-line sql">SELECT * FROM users WHERE username = 'admin' <span class="comment">--' AND
                  password = '...'</span></div>
              <div class="explanation">æ³¨é‡Šæ‰å¯†ç éªŒè¯ï¼Œç›´æ¥ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•</div>
            </div>
          </div>

          <div class="attack-example">
            <h3>æ›´å±é™©çš„æ”»å‡»</h3>
            <div class="code-block">
              <div class="code-line">æœç´¢: <span class="user-input">'; DROP TABLE users; --</span></div>
              <div class="code-line">ç”Ÿæˆçš„SQL:</div>
              <div class="code-line sql">SELECT * FROM products WHERE name LIKE '%'; </div>
              <div class="code-line sql dangerous">DROP TABLE users; <span class="comment">-- %'</span></div>
              <div class="explanation">åˆ é™¤æ•´ä¸ªç”¨æˆ·è¡¨é€ æˆç¾éš¾æ€§åæœ</div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2><span class="icon">ğŸ›¡ï¸</span> é˜²æŠ¤æªæ–½</h2>
        <div class="defense-methods">
          <div class="method">
            <div class="method-icon">ğŸ“</div>
            <h3>å‚æ•°åŒ–æŸ¥è¯¢</h3>
            <p>ä½¿ç”¨é¢„å¤„ç†è¯­å¥(Prepared Statements)</p>
            <div class="effectiveness">æœ€æœ‰æ•ˆ</div>
          </div>
          <div class="method">
            <div class="method-icon">ğŸ”’</div>
            <h3>è¾“å…¥éªŒè¯</h3>
            <p>è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦å’ŒSQLå…³é”®å­—</p>
            <div class="effectiveness">ä¸­ç­‰</div>
          </div>
          <div class="method">
            <div class="method-icon">ğŸ‘®</div>
            <h3>æœ€å°æƒé™</h3>
            <p>é™åˆ¶æ•°æ®åº“è´¦æˆ·æƒé™</p>
            <div class="effectiveness">ä¸­ç­‰</div>
          </div>
          <div class="method">
            <div class="method-icon">ğŸ“‹</div>
            <h3>ORMæ¡†æ¶</h3>
            <p>ä½¿ç”¨å¯¹è±¡å…³ç³»æ˜ å°„å·¥å…·</p>
            <div class="effectiveness">é«˜</div>
          </div>
        </div>

        <div class="code-comparison">
          <div class="vulnerable">
            <h4>ä¸å®‰å…¨ä»£ç </h4>
            <pre>// åŠ¨æ€æ‹¼æ¥SQL - é«˜å±ï¼
const query = `SELECT * FROM users
               WHERE username = '${username}'
               AND password = '${password}'`;
db.query(query, (err, result) => {
  // å¤„ç†ç»“æœ
});</pre>
            <div class="risk">âŒ å­˜åœ¨SQLæ³¨å…¥é£é™©</div>
          </div>

          <div class="secure">
            <h4>å®‰å…¨ä»£ç ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼‰</h4>
            <pre>// ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ - å®‰å…¨
const query = `SELECT * FROM users
               WHERE username = ?
               AND password = ?`;
db.query(query, [username, password],
  (err, result) => {
    // å¤„ç†ç»“æœ
});</pre>
            <div class="safety">âœ… é˜²æ­¢SQLæ³¨å…¥</div>
          </div>
        </div>
      </div>

      <div class="card">
        <h2><span class="icon">ğŸ”§</span> æµ‹è¯•ä¸é˜²æŠ¤å·¥å…·</h2>
        <div class="tools-section">
          <div class="testing-tools">
            <h3>æµ‹è¯•å·¥å…·</h3>
            <ul>
              <li>SQLMap - è‡ªåŠ¨SQLæ³¨å…¥æµ‹è¯•å·¥å…·</li>
              <li>Burp Suite - æ¸—é€æµ‹è¯•å·¥å…·å¥—ä»¶</li>
              <li>OWASP ZAP - å¼€æºWebåº”ç”¨æ‰«æå™¨</li>
              <li>Acunetix - è‡ªåŠ¨åŒ–Webæ¼æ´æ‰«æå·¥å…·</li>
            </ul>
          </div>

          <div class="protection-tools">
            <h3>é˜²æŠ¤å·¥å…·</h3>
            <ul>
              <li>WAF (Webåº”ç”¨é˜²ç«å¢™)</li>
              <li>æ•°æ®åº“é˜²ç«å¢™</li>
              <li>OWASP ESAPI</li>
              <li>å®‰å…¨ç¼–ç æ¡†æ¶</li>
            </ul>
          </div>
        </div>

        <div class="best-practices">
          <h3>æœ€ä½³å®è·µ</h3>
          <div class="practices">
            <div class="practice">å¯¹è¾“å…¥æ•°æ®è¿›è¡Œä¸¥æ ¼éªŒè¯</div>
            <div class="practice">ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æˆ–å­˜å‚¨è¿‡ç¨‹</div>
            <div class="practice">æ•°æ®åº“è´¦æˆ·ä½¿ç”¨æœ€å°æƒé™åŸåˆ™</div>
            <div class="practice">å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡å’Œæ¸—é€æµ‹è¯•</div>
            <div class="practice">é”™è¯¯ä¿¡æ¯ä¸æ³„éœ²æ•°æ®åº“ç»“æ„</div>
            <div class="practice">æ¡†æ¶å†…ç½®çš„å®‰å…¨åŠŸèƒ½</div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="security-quote">
        "æ°¸è¿œä¸è¦ä¿¡ä»»ç”¨æˆ·è¾“å…¥çš„æ•°æ®"
      </div>
      <div class="reference">
        å‚è€ƒ: OWASP Top 10 - A01:2021 Injection
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// æ¨¡æ‹ŸSQLæ³¨å…¥æ”»å‡»æ¼”ç¤º
const attackInput = ref("admin' --");
const attackResult = ref("ç™»å½•æˆåŠŸï¼šç®¡ç†å‘˜è´¦æˆ·");
</script>

<style lang="less" scoped>
@danger-color: #e74c3c;
@security-color: #2ecc71;
@warning-color: #f39c12;
@dark-color: #2c3e50;
@light-bg: #f8f9fa;
@card-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);

.sql-injection-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: @dark-color;
  background: #f0f2f5;
}

.security-header {
  text-align: center;
  margin-bottom: 40px;
  padding: 40px 20px;
  background: linear-gradient(135deg, #2c3e50, #1a2530);
  color: white;
  border-radius: 16px;
  position: relative;
  overflow: hidden;

  h1 {
    font-size: 2.8rem;
    margin-bottom: 15px;
    font-weight: 800;
    letter-spacing: -0.5px;
  }

  .subtitle {
    font-size: 1.4rem;
    opacity: 0.85;
    font-weight: 300;
    max-width: 600px;
    margin: 0 auto;
  }

  .hacker-icon {
    position: absolute;
    top: 20px;
    left: 40px;
    font-size: 4rem;
    opacity: 0.2;
    transform: scaleX(-1);
  }

  .shield-icon {
    position: absolute;
    top: 20px;
    right: 40px;
    font-size: 4rem;
    opacity: 0.2;
  }
}

.content-section {
  display: grid;
  gap: 30px;
}

.card {
  background: white;
  border-radius: 16px;
  padding: 30px;
  box-shadow: @card-shadow;
  transition: all 0.3s ease;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
  }

  h2 {
    color: @dark-color;
    padding-bottom: 15px;
    margin-bottom: 25px;
    font-weight: 700;
    font-size: 1.8rem;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 2px solid #f0f0f0;

    .icon {
      font-size: 1.5em;
    }
  }
}

.danger-card {
  border-top: 6px solid @danger-color;
}

.definition {
  background: #fef2f2;
  padding: 25px;
  border-radius: 12px;
  margin-bottom: 30px;
  position: relative;
  border-left: 5px solid @danger-color;

  p {
    font-size: 1.15rem;
    line-height: 1.6;
  }

  .risk-level {
    position: absolute;
    top: -15px;
    right: 20px;
    background: white;
    padding: 8px 20px;
    border-radius: 30px;
    display: flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    font-weight: 600;

    .level {
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: 700;

      &.high {
        background: @danger-color;
        color: white;
      }
    }
  }
}

.impact-section {
  h3 {
    font-size: 1.3rem;
    margin-bottom: 20px;
    color: @dark-color;
    font-weight: 600;
  }

  .impacts {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;

    .impact {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      transition: all 0.3s ease;
      border-top: 3px solid @danger-color;

      &:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(231, 76, 60, 0.15);
      }

      .impact-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
      }

      h4 {
        color: @danger-color;
        margin-bottom: 10px;
        font-weight: 700;
      }

      p {
        font-size: 0.95rem;
        color: #6b7280;
      }
    }
  }
}

.injection-process {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 30px 0;

  .step {
    text-align: center;
    flex: 1;
    min-width: 180px;
    margin-bottom: 30px;

    .step-number {
      width: 50px;
      height: 50px;
      background: @danger-color;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-weight: 700;
      font-size: 1.5rem;
      box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
    }

    h3 {
      font-size: 1.3rem;
      margin-bottom: 10px;
      color: @dark-color;
      font-weight: 700;
    }

    p {
      color: #4b5563;
      font-size: 0.95rem;
      max-width: 180px;
      margin: 0 auto;
    }
  }

  .arrow {
    display: flex;
    align-items: center;
    padding: 0 10px;
    color: @danger-color;
    font-size: 2rem;
    font-weight: bold;
  }
}

.code-demo {
  margin-top: 40px;

  .attack-example {
    margin-bottom: 30px;
    background: #fef2f2;
    padding: 20px;
    border-radius: 12px;

    h3 {
      color: @danger-color;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .code-block {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 10px;
      font-family: 'Courier New', monospace;
      line-height: 1.8;

      .code-line {
        margin-bottom: 10px;

        &.sql {
          color: #3498db;
          margin-left: 20px;

          &.dangerous {
            color: @danger-color;
            font-weight: bold;
          }
        }

        .user-input {
          color: @danger-color;
          font-weight: bold;
        }

        .comment {
          color: #95a5a6;
          font-style: italic;
        }
      }

      .explanation {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px dashed #95a5a6;
        color: #e74c3c;
        font-weight: 600;
      }
    }
  }
}

.defense-methods {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 25px;
  margin-bottom: 30px;

  .method {
    background: white;
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    border: 2px solid #e5e7eb;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;

    &:hover {
      transform: translateY(-5px);
      border-color: @security-color;
      box-shadow: 0 8px 20px rgba(46, 204, 113, 0.15);
    }

    .method-icon {
      font-size: 2.5rem;
      margin-bottom: 18px;
      color: @security-color;
    }

    h3 {
      color: @dark-color;
      margin-bottom: 12px;
      font-weight: 700;
    }

    p {
      font-size: 0.95rem;
      color: #6b7280;
      margin-bottom: 15px;
    }

    .effectiveness {
      font-size: 0.9rem;
      font-weight: 700;
      color: @security-color;
      padding: 4px 10px;
      background: rgba(46, 204, 113, 0.1);
      border-radius: 20px;
      display: inline-block;
    }

    &::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: @security-color;
    }
  }
}

.code-comparison {
  display: flex;
  gap: 30px;
  flex-wrap: wrap;

  >div {
    flex: 1;
    min-width: 400px;
    padding: 25px;
    border-radius: 12px;
  }

  .vulnerable {
    background: #fef2f2;
    border: 2px solid #fecaca;

    h4 {
      color: @danger-color;
      text-align: center;
      margin-bottom: 15px;
    }

    pre {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      line-height: 1.5;
      font-size: 0.9rem;
    }

    .risk {
      text-align: center;
      font-weight: 700;
      margin-top: 15px;
      padding: 10px;
      border-radius: 5px;
      background: lighten(@danger-color, 40%);
      color: darken(@danger-color, 20%);
    }
  }

  .secure {
    background: #f0fdf4;
    border: 2px solid #bbf7d0;

    h4 {
      color: @security-color;
      text-align: center;
      margin-bottom: 15px;
    }

    pre {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      line-height: 1.5;
      font-size: 0.9rem;
    }

    .safety {
      text-align: center;
      font-weight: 700;
      margin-top: 15px;
      padding: 10px;
      border-radius: 5px;
      background: lighten(@security-color, 50%);
      color: darken(@security-color, 20%);
    }
  }
}

.tools-section {
  display: flex;
  gap: 30px;
  margin-bottom: 30px;
  flex-wrap: wrap;

  .testing-tools,
  .protection-tools {
    flex: 1;
    min-width: 300px;
    background: #f8f9fa;
    padding: 25px;
    border-radius: 12px;

    h3 {
      color: @dark-color;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #e5e7eb;
      font-weight: 700;
    }

    ul {
      padding-left: 20px;

      li {
        margin-bottom: 12px;
        padding-left: 10px;
        position: relative;
        font-weight: 500;

        &::before {
          content: "â€¢";
          position: absolute;
          left: -15px;
          color: @security-color;
          font-weight: 800;
        }
      }
    }
  }

  .testing-tools {
    border-top: 4px solid @warning-color;
  }

  .protection-tools {
    border-top: 4px solid @security-color;
  }
}

.best-practices {
  h3 {
    font-size: 1.3rem;
    margin-bottom: 20px;
    color: @dark-color;
    font-weight: 600;
  }

  .practices {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 15px;

    .practice {
      background: #e8f4fc;
      padding: 15px 20px;
      border-radius: 8px;
      font-weight: 500;
      position: relative;
      padding-left: 45px;

      &::before {
        content: "âœ“";
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        width: 28px;
        height: 28px;
        background: @security-color;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
      }
    }
  }
}

.footer {
  margin-top: 50px;
  padding: 30px;
  background: linear-gradient(to right, #2c3e50, #1a2530);
  color: white;
  text-align: center;
  border-radius: 16px;

  .security-quote {
    font-size: 1.5rem;
    font-weight: 600;
    font-style: italic;
    margin-bottom: 15px;
    color: @security-color;
  }

  .reference {
    font-size: 0.95rem;
    opacity: 0.8;
  }
}
</style>