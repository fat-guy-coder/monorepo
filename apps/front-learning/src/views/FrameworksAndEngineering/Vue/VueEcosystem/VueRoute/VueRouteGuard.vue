<template>
  <div class="router-guards-container">
    <header class="header">
      <div class="title-section">
        <h1>Vue Router <span class="highlight">è·¯ç”±å®ˆå«</span>åŸºç¡€ä»‹ç»</h1>
        <p class="subtitle">å…¨é¢æŒæ¡å¯¼èˆªæ§åˆ¶ä¸æƒé™ç®¡ç†</p>
      </div>
      <div class="stats-card">
        <div class="stat-item">
          <div class="stat-value">3</div>
          <div class="stat-label">å…¨å±€å®ˆå«</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">1</div>
          <div class="stat-label">è·¯ç”±ç‹¬äº«å®ˆå«</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">3</div>
          <div class="stat-label">ç»„ä»¶å†…å®ˆå«</div>
        </div>
      </div>
    </header>

    <div class="intro-section">
      <div class="intro-card">
        <h2>ä»€ä¹ˆæ˜¯è·¯ç”±å®ˆå«ï¼Ÿ</h2>
        <p>è·¯ç”±å®ˆå«æ˜¯Vue Routeræä¾›çš„å¯¼èˆªæ§åˆ¶æœºåˆ¶ï¼Œå…è®¸åœ¨è·¯ç”±å¯¼èˆªè¿‡ç¨‹ä¸­æ’å…¥é’©å­å‡½æ•°ï¼Œç”¨äºæ§åˆ¶å¯¼èˆªè¡Œä¸ºã€éªŒè¯æƒé™ã€ç®¡ç†æ•°æ®ç­‰ã€‚</p>
        <div class="navigation-flow">
          <div class="flow-step">
            <div class="flow-icon">ğŸš¦</div>
            <div class="flow-text">å¯¼èˆªè§¦å‘</div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="flow-icon">ğŸ”’</div>
            <div class="flow-text">å®ˆå«å¤„ç†</div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="flow-icon">âœ…</div>
            <div class="flow-text">å®Œæˆå¯¼èˆª</div>
          </div>
        </div>
      </div>
    </div>

    <div class="toc-section">
      <h2 class="section-title">ğŸ“š å®ˆå«ç±»å‹ç›®å½•</h2>
      <div class="toc-grid">
        <div v-for="(item, index) in tocItems" :key="index" class="toc-item" @click="scrollToSection(item.id)">
          <div class="toc-number">{{ index + 1 }}</div>
          <div class="toc-content">
            <h3>{{ item.title }}</h3>
            <p>{{ item.description }}</p>
          </div>
          <div class="guard-type" :class="item.type">{{ item.typeLabel }}</div>
        </div>
      </div>
    </div>

    <div class="guards-container">
      <!-- å…¨å±€å‰ç½®å®ˆå« -->
      <section id="before-each" class="guard-section">
        <div class="section-header">
          <div class="section-icon">ğŸš¦</div>
          <h2>å…¨å±€å‰ç½®å®ˆå« (beforeEach)</h2>
          <div class="guard-tag global">å…¨å±€å®ˆå«</div>
        </div>

        <div class="guard-details">
          <div class="detail-card">
            <h3><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h3>
            <p>åœ¨è·¯ç”±å¯¼èˆªå¼€å§‹æ—¶è§¦å‘ï¼Œåœ¨æ‰€æœ‰å®ˆå«ä¸­æœ€æ—©è§¦å‘</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ¯</span> ä½œç”¨</h3>
            <p>å¯¹å¯¼èˆªè¿›è¡Œå…¨å±€æ‹¦æˆªï¼Œå†³å®šæ˜¯å¦å…è®¸å¯¼èˆªç»§ç»­</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h3>
            <ul>
              <li>ç”¨æˆ·èº«ä»½éªŒè¯ï¼ˆæ£€æŸ¥ç™»å½•çŠ¶æ€ï¼‰</li>
              <li>æƒé™æ§åˆ¶ï¼ˆæ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼‰</li>
              <li>å…¨å±€å¯¼èˆªæ‹¦æˆªï¼ˆç»´æŠ¤ä¸­é¡µé¢ï¼‰</li>
              <li>è·¯ç”±è®¿é—®æ—¥å¿—è®°å½•</li>
            </ul>
          </div>
        </div>

        <div class="code-example">
          <h3><span class="icon">ğŸ’»</span> ä»£ç ç¤ºä¾‹</h3>
          <pre class="code-block">router.beforeEach((to, from, next?) => {
nextä¸ºå¯é€‰å‚æ•°ï¼Œå¦‚æœnextä¸ºundefinedï¼Œåˆ™å¯¼èˆªä¸ä¼šç»§ç»­ï¼Œå¦‚æœnextä¸ºfalseï¼Œåˆ™å¯¼èˆªä¼šè¢«é˜»æ­¢
  // æ£€æŸ¥ç›®æ ‡è·¯ç”±æ˜¯å¦éœ€è¦ç™»å½•
  if (to.meta.requiresAuth) {
    // éªŒè¯ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
    if (store.state.user.isAuthenticated) {
      next(); // å…è®¸å¯¼èˆª
    } else {
      next({ name: 'Login' }); // é‡å®šå‘åˆ°ç™»å½•é¡µ
    }
  } else {
    next(); // ä¸éœ€è¦éªŒè¯ï¼Œç»§ç»­å¯¼èˆª
  }
});</pre>
        </div>

        <div class="important-note">
          <h3><span class="icon">âš ï¸</span> é‡è¦æç¤º</h3>
          <p>ç”¨ <code>next()</code> å‡½æ•°æ¥ç»§ç»­å¯¼èˆª</p>
        </div>
      </section>

      <!-- å…¨å±€è§£æå®ˆå« -->
      <section id="before-resolve" class="guard-section">
        <div class="section-header">
          <div class="section-icon">ğŸ”</div>
          <h2>å…¨å±€è§£æå®ˆå« (beforeResolve)</h2>
          <div class="guard-tag global">å…¨å±€å®ˆå«</div>
        </div>

        <div class="guard-details">
          <div class="detail-card">
            <h3><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h3>
            <p>åœ¨å¯¼èˆªè¢«ç¡®è®¤ä¹‹å‰è§¦å‘ï¼Œåœ¨å¼‚æ­¥ç»„ä»¶è§£æå®Œæˆä¹‹å</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ¯</span> ä½œç”¨</h3>
            <p>ç¡®ä¿å¼‚æ­¥ç»„ä»¶æˆ–åŠ¨æ€å¯¼å…¥çš„ç»„ä»¶å·²è§£æå®Œæˆ</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h3>
            <ul>
              <li>ç¡®ä¿å¼‚æ­¥æ•°æ®å·²åŠ è½½</li>
              <li>åœ¨æ¸²æŸ“å‰è¿›è¡Œæœ€ç»ˆæƒé™æ£€æŸ¥</li>
              <li>è·å–è·¯ç”±çº§åˆ«ä¾èµ–é¡¹</li>
              <li>æœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)çš„æ•°æ®é¢„å–</li>
            </ul>
          </div>
        </div>

        <div class="code-example">
          <h3><span class="icon">ğŸ’»</span> ä»£ç ç¤ºä¾‹</h3>
          <pre class="code-block">router.beforeResolve(async (to, from, next) => {
  // æ£€æŸ¥è·¯ç”±æ˜¯å¦é…ç½®äº†éœ€è¦é¢„å–æ•°æ®
  if (to.meta.requiresFetch) {
    try {
      // é¢„å–æ•°æ®
      await store.dispatch('fetchData', to.params.id);
      next(); // ç»§ç»­å¯¼èˆª
    } catch (error) {
      next({ name: 'Error' }); // é”™è¯¯å¤„ç†
    }
  } else {
    next(); // ä¸éœ€è¦é¢„å–ï¼Œç»§ç»­å¯¼èˆª
  }
});</pre>
        </div>
      </section>

      <!-- å…¨å±€åç½®é’©å­ -->
      <section id="after-each" class="guard-section">
        <div class="section-header">
          <div class="section-icon">ğŸ</div>
          <h2>å…¨å±€åç½®é’©å­ (afterEach)</h2>
          <div class="guard-tag global">å…¨å±€å®ˆå«</div>
        </div>

        <div class="guard-details">
          <div class="detail-card">
            <h3><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h3>
            <p>åœ¨å¯¼èˆªå®Œæˆåè§¦å‘ï¼Œæ²¡æœ‰èƒ½åŠ›æ”¹å˜å¯¼èˆªç»“æœ</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ¯</span> ä½œç”¨</h3>
            <p>æ‰§è¡Œå¯¼èˆªå®Œæˆåçš„æ“ä½œï¼Œå¦‚é¡µé¢åˆ†æã€æ»šåŠ¨å¤ä½</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h3>
            <ul>
              <li>é¡µé¢è®¿é—®ç»Ÿè®¡ï¼ˆå¦‚Google Analyticsï¼‰</li>
              <li>é¡µé¢æ ‡é¢˜è®¾ç½®</li>
              <li>é‡ç½®é¡µé¢æ»šåŠ¨ä½ç½®</li>
              <li>é€šçŸ¥/æé†’å…³é—­</li>
              <li>ç»“æŸåŠ è½½åŠ¨ç”»</li>
            </ul>
          </div>
        </div>

        <div class="code-example">
          <h3><span class="icon">ğŸ’»</span> ä»£ç ç¤ºä¾‹</h3>
          <pre class="code-block">router.afterEach((to) => {
  // è®¾ç½®é¡µé¢æ ‡é¢˜
  document.title = to.meta.title || 'é»˜è®¤æ ‡é¢˜';

  // å‘é€é¡µé¢è®¿é—®ç»Ÿè®¡
  ga('send', 'pageview', to.path);

  // æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
  window.scrollTo(0, 0);

  // å…³é—­å…¨å±€åŠ è½½åŠ¨ç”»
  hideGlobalLoading();
});</pre>
        </div>
      </section>

      <!-- è·¯ç”±ç‹¬äº«å®ˆå« -->
      <section id="before-enter" class="guard-section">
        <div class="section-header">
          <div class="section-icon">ğŸ”</div>
          <h2>è·¯ç”±ç‹¬äº«å®ˆå« (beforeEnter)</h2>
          <div class="guard-tag per-route">è·¯ç”±ç‹¬äº«</div>
        </div>

        <div class="guard-details">
          <div class="detail-card">
            <h3><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h3>
            <p>åœ¨è·¯ç”±é…ç½®ä¸­å®šä¹‰ï¼Œä»…åœ¨è¿›å…¥è¯¥ç‰¹å®šè·¯ç”±æ—¶è§¦å‘</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ¯</span> ä½œç”¨</h3>
            <p>ä¸ºç‰¹å®šè·¯ç”±è®¾ç½®è®¿é—®æƒé™æˆ–æ¡ä»¶æ£€æŸ¥</p>
          </div>

          <div class="detail-card">
            <h3><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h3>
            <ul>
              <li>ç‰¹å®šé¡µé¢çš„æƒé™éªŒè¯</li>
              <li>è·¯ç”±å‚æ•°éªŒè¯</li>
              <li>ç‰¹å®šé¡µé¢çš„æ•°æ®é¢„åŠ è½½</li>
              <li>ä»˜è´¹å†…å®¹è®¿é—®æ§åˆ¶</li>
            </ul>
          </div>
        </div>

        <div class="code-example">
          <h3><span class="icon">ğŸ’»</span> ä»£ç ç¤ºä¾‹</h3>
          <pre class="code-block">const routes = [
  {
    path: '/dashboard',
    name: 'Dashboard',
    component: Dashboard,
    meta: { requiresAdmin: true },
    beforeEnter: (to, from, next) => {
      // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜
      if (store.state.user.role === 'admin') {
        next(); // å…è®¸è®¿é—®
      } else {
        next({ name: 'Forbidden' }); // é‡å®šå‘åˆ°æ— æƒé™é¡µé¢
      }
    }
  },
  {
    path: '/article/:id',
    component: ArticleDetail,
    beforeEnter: (to, from, next) => {
      // éªŒè¯æ–‡ç« IDæ˜¯å¦æœ‰æ•ˆ
      if (isValidArticleId(to.params.id)) {
        next(); // å…è®¸è®¿é—®
      } else {
        next({ name: 'NotFound' }); // é‡å®šå‘åˆ°404é¡µé¢
      }
    }
  }
];</pre>
        </div>
      </section>

      <!-- ç»„ä»¶å†…å®ˆå« -->
      <section id="in-component" class="guard-section">
        <div class="section-header">
          <div class="section-icon">ğŸ§©</div>
          <h2>ç»„ä»¶å†…å®ˆå«</h2>
          <div class="guard-tag component">ç»„ä»¶å†…å®ˆå«</div>
        </div>
        <p class="section-desc">åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰çš„å®ˆå«ï¼Œç›´æ¥è®¿é—®ç»„ä»¶å®ä¾‹</p>

        <div class="sub-guard-section">
          <h3><span class="icon">â¡ï¸</span> beforeRouteEnter</h3>
          <div class="guard-details">
            <div class="detail-card">
              <h4><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h4>
              <p>åœ¨è·¯ç”±è¿›å…¥è¯¥ç»„ä»¶ä¹‹å‰è°ƒç”¨</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ¯</span> ç‰¹ç‚¹</h4>
              <p>æ— æ³•è®¿é—®ç»„ä»¶å®ä¾‹ (this)ï¼Œå› ä¸ºç»„ä»¶å°šæœªåˆ›å»º</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h4>
              <p>æ ¹æ®è·¯ç”±å‚æ•°è·å–æ•°æ®ï¼Œåœ¨ç»„ä»¶åˆ›å»ºå‰åŠ è½½å¿…è¦ä¿¡æ¯</p>
            </div>
          </div>
          <div class="code-example">
            <pre class="code-block">beforeRouteEnter(to, from, next) {
  // æ— æ³•è®¿é—®this
  // é€šè¿‡nextçš„å›è°ƒè®¿é—®ç»„ä»¶å®ä¾‹
  next(vm => {
    // é€šè¿‡vmè®¿é—®ç»„ä»¶å®ä¾‹
    vm.loadData(to.params.id);
  });
}</pre>
          </div>
        </div>

        <div class="sub-guard-section">
          <h3><span class="icon">ğŸ”„</span> beforeRouteUpdate</h3>
          <div class="guard-details">
            <div class="detail-card">
              <h4><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h4>
              <p>åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ¯</span> ç‰¹ç‚¹</h4>
              <p>å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ (this)</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h4>
              <p>è·¯ç”±å‚æ•°å˜åŒ–æ—¶ï¼ˆå¦‚ /article/1 åˆ° /article/2ï¼‰ï¼Œé‡æ–°è·å–æ•°æ®</p>
            </div>
          </div>
          <div class="code-example">
            <pre class="code-block">beforeRouteUpdate(to, from) {
  // å¯ä»¥è®¿é—®this
  // å½“è·¯ç”±å‚æ•°å˜åŒ–æ—¶é‡æ–°è·å–æ•°æ®
  if (to.params.id !== from.params.id) {
    this.fetchArticle(to.params.id);
  }
}</pre>
          </div>
        </div>

        <div class="sub-guard-section">
          <h3><span class="icon">â¬…ï¸</span> beforeRouteLeave</h3>
          <div class="guard-details">
            <div class="detail-card">
              <h4><span class="icon">â±ï¸</span> è§¦å‘æ—¶æœº</h4>
              <p>åœ¨ç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ¯</span> ç‰¹ç‚¹</h4>
              <p>å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ (this)</p>
            </div>
            <div class="detail-card">
              <h4><span class="icon">ğŸ’¡</span> ä½¿ç”¨åœºæ™¯</h4>
              <p>é˜²æ­¢ç”¨æˆ·åœ¨æœªä¿å­˜æ›´æ”¹æ—¶ç¦»å¼€é¡µé¢</p>
            </div>
          </div>
          <div class="code-example">
            <pre class="code-block">beforeRouteLeave(to, from) {
  // æ£€æŸ¥è¡¨å•æ˜¯å¦å·²ä¿®æ”¹
  if (this.formModified) {
    // ç¡®è®¤ç”¨æˆ·æ˜¯å¦è¦ç¦»å¼€
    const answer = window.confirm('æ‚¨æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ');
    if (!answer) return false; // å–æ¶ˆå¯¼èˆª
  }
}</pre>
          </div>
        </div>
      </section>

      <!-- å®ˆå«æ‰§è¡Œé¡ºåº -->
      <section id="execution-order" class="guard-section">
        <div class="section-header">
          <div class="section-icon">â©</div>
          <h2>å®ˆå«æ‰§è¡Œé¡ºåº</h2>
        </div>

        <div class="execution-flow">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-title">å¯¼èˆªè§¦å‘</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-title">å¤±æ´»ç»„ä»¶ beforeRouteLeave</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-title">å…¨å±€ beforeEach</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-title">è·¯ç”±ç‹¬äº« beforeEnter</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">5</div>
            <div class="step-title">æ¿€æ´»ç»„ä»¶ beforeRouteEnter</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">6</div>
            <div class="step-title">å…¨å±€ beforeResolve</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">7</div>
            <div class="step-title">å¯¼èˆªç¡®è®¤</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <div class="flow-step">
            <div class="step-number">8</div>
            <div class="step-title">å…¨å±€ afterEach</div>
          </div>
        </div>

        <div class="important-note">
          <h3><span class="icon">ğŸ“Œ</span> é‡è¦æç¤º</h3>
          <p>beforeRouteUpdate åœ¨ç»„ä»¶å¤ç”¨æ—¶è§¦å‘ï¼Œä¸åœ¨æ­¤ä¸»æµç¨‹ä¸­</p>
        </div>
      </section>
    </div>

    <footer class="footer">
      <div class="footer-content">
        <h3>è·¯ç”±å®ˆå«æœ€ä½³å®è·µ</h3>
        <div class="principles">
          <div class="principle">
            <div class="principle-icon">âœ…</div>
            <p>å®ˆå«ä¸­åº”å§‹ç»ˆè°ƒç”¨ next() æ–¹æ³•</p>
          </div>
          <div class="principle">
            <div class="principle-icon">ğŸš«</div>
            <p>é¿å…åœ¨å®ˆå«ä¸­è¿›è¡Œå¤æ‚ä¸šåŠ¡é€»è¾‘</p>
          </div>
          <div class="principle">
            <div class="principle-icon">âš–ï¸</div>
            <p>åˆç†åˆ†é…å…¨å±€å’Œå±€éƒ¨å®ˆå«èŒè´£</p>
          </div>
        </div>
        <p class="footer-note">åˆç†ä½¿ç”¨è·¯ç”±å®ˆå«ï¼Œæ„å»ºå®‰å…¨å¯æ§çš„å¯¼èˆªç³»ç»Ÿ</p>
      </div>
    </footer>
  </div>
</template>

<script lang="ts" setup>
import { ref } from 'vue';

const tocItems = ref([
  {
    id: 'before-each',
    title: 'å…¨å±€å‰ç½®å®ˆå«',
    description: 'è·¯ç”±å¯¼èˆªå¼€å§‹æ—¶è§¦å‘',
    type: 'global',
    typeLabel: 'å…¨å±€'
  },
  {
    id: 'before-resolve',
    title: 'å…¨å±€è§£æå®ˆå«',
    description: 'å¯¼èˆªç¡®è®¤å‰ï¼Œå¼‚æ­¥ç»„ä»¶è§£æå',
    type: 'global',
    typeLabel: 'å…¨å±€'
  },
  {
    id: 'after-each',
    title: 'å…¨å±€åç½®é’©å­',
    description: 'å¯¼èˆªå®Œæˆåè§¦å‘',
    type: 'global',
    typeLabel: 'å…¨å±€'
  },
  {
    id: 'before-enter',
    title: 'è·¯ç”±ç‹¬äº«å®ˆå«',
    description: 'è¿›å…¥ç‰¹å®šè·¯ç”±æ—¶è§¦å‘',
    type: 'per-route',
    typeLabel: 'è·¯ç”±ç‹¬äº«'
  },
  {
    id: 'in-component',
    title: 'ç»„ä»¶å†…å®ˆå«',
    description: 'ç»„ä»¶å†…éƒ¨å®šä¹‰çš„è·¯ç”±å®ˆå«',
    type: 'component',
    typeLabel: 'ç»„ä»¶å†…'
  },
  {
    id: 'execution-order',
    title: 'å®ˆå«æ‰§è¡Œé¡ºåº',
    description: 'å®Œæ•´å¯¼èˆªè§£ææµç¨‹',
    type: 'order',
    typeLabel: 'æµç¨‹'
  }
]);

const scrollToSection = (id: string) => {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({ behavior: 'smooth' });
  }
};
</script>

<style lang="less" scoped>


:root {
  --primary-color: #42b883;
  --primary-light: #e8f8f2;
  --secondary-color: #35495e;
  --accent-color: #ff7e67;
  --light-bg: #f8f9fa;
  --card-bg: #ffffff;
  --border-color: #eaeaea;
  --text-dark: #2c3e50;
  --text-light: #6c757d;
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --global-color: #4d7cff;
  --per-route-color: #9c27b0;
  --component-color: #00bcd4;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.router-guards-container {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
  color: var(--text-dark);
  line-height: 1.6;
  background-color: var(--light-bg);
  min-height: 100vh;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 2rem;
  margin-bottom: 3rem;
  padding-bottom: 2rem;
  border-bottom: 1px solid var(--border-color);

  .title-section {
    flex: 1;
    min-width: 300px;

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--secondary-color);
      margin-bottom: 0.5rem;

      .highlight {
        color: var(--primary-color);
        position: relative;

        &::after {
          content: '';
          position: absolute;
          bottom: 0;
          left: 0;
          width: 100%;
          height: 4px;
          background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
          border-radius: 2px;
        }
      }
    }

    .subtitle {
      font-size: 1.25rem;
      color: var(--text-light);
      font-weight: 400;
      max-width: 600px;
    }
  }

  .stats-card {
    display: flex;
    gap: 1.5rem;
    background: var(--card-bg);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    box-shadow: var(--shadow-md);

    .stat-item {
      text-align: center;

      .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.25rem;
      }

      .stat-label {
        font-size: 0.9rem;
        color: var(--text-light);
      }
    }
  }
}

.intro-section {
  margin-bottom: 3rem;

  .intro-card {
    background: var(--card-bg);
    border-radius: var(--radius-md);
    padding: 2rem;
    box-shadow: var(--shadow-sm);

    h2 {
      font-size: 1.8rem;
      color: var(--secondary-color);
      margin-bottom: 1rem;
    }

    p {
      font-size: 1.1rem;
      color: var(--text-light);
      margin-bottom: 1.5rem;
    }

    .navigation-flow {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      margin-top: 1.5rem;

      .flow-step {
        text-align: center;

        .flow-icon {
          font-size: 2.5rem;
          margin-bottom: 0.5rem;
        }

        .flow-text {
          font-weight: 500;
        }
      }

      .flow-arrow {
        font-size: 1.5rem;
        color: var(--text-light);
      }
    }
  }
}

.section-title {
  font-size: 1.75rem;
  margin-bottom: 1.5rem;
  color: var(--secondary-color);
  padding-bottom: 0.75rem;
  border-bottom: 2px solid var(--primary-light);
  position: relative;

  &::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 80px;
    height: 2px;
    background-color: var(--primary-color);
  }
}

.toc-section {
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 2rem;
  margin-bottom: 3rem;
  box-shadow: var(--shadow-sm);

  .toc-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;

    .toc-item {
      display: flex;
      gap: 1rem;
      padding: 1.25rem;
      border-radius: var(--radius-sm);
      background: var(--light-bg);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid transparent;
      position: relative;
      overflow: hidden;

      &:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-sm);
        background: var(--primary-light);
      }

      .toc-number {
        width: 36px;
        height: 36px;
        background: var(--primary-color);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.1rem;
        flex-shrink: 0;
      }

      .toc-content {
        flex: 1;

        h3 {
          font-size: 1.1rem;
          margin-bottom: 0.25rem;
          color: var(--secondary-color);
        }

        p {
          font-size: 0.9rem;
          color: var(--text-light);
          margin: 0;
        }
      }

      .guard-type {
        position: absolute;
        top: 0;
        right: 0;
        padding: 0.25rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 600;
        border-radius: 0 8px 0 8px;
        color: white;

        &.global {
          background: var(--global-color);
        }

        &.per-route {
          background: var(--per-route-color);
        }

        &.component {
          background: var(--component-color);
        }

        &.order {
          background: var(--accent-color);
        }
      }
    }
  }
}

.guards-container {
  display: flex;
  flex-direction: column;
  gap: 3rem;
}

.guard-section {
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 2rem;
  box-shadow: var(--shadow-sm);

  .section-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
    position: relative;

    .section-icon {
      font-size: 2rem;
      width: 60px;
      height: 60px;
      background: var(--primary-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    h2 {
      font-size: 1.8rem;
      color: var(--secondary-color);
    }

    .guard-tag {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-left: auto;

      &.global {
        background: rgba(77, 124, 255, 0.1);
        color: var(--global-color);
        border: 1px solid var(--global-color);
      }

      &.per-route {
        background: rgba(156, 39, 176, 0.1);
        color: var(--per-route-color);
        border: 1px solid var(--per-route-color);
      }

      &.component {
        background: rgba(0, 188, 212, 0.1);
        color: var(--component-color);
        border: 1px solid var(--component-color);
      }
    }
  }

  .section-desc {
    font-size: 1.1rem;
    color: var(--text-light);
    margin-bottom: 1.5rem;
    padding-left: 72px;
  }
}

.guard-details {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;

  .detail-card {
    background: var(--light-bg);
    border-radius: var(--radius-sm);
    padding: 1.5rem;

    h3,
    h4 {
      font-size: 1.2rem;
      color: var(--secondary-color);
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;

      .icon {
        font-size: 1.25rem;
      }
    }

    p,
    ul {
      font-size: 1rem;
      color: var(--text-light);
    }

    ul {
      padding-left: 1.5rem;

      li {
        margin-bottom: 0.5rem;
        position: relative;

        &::marker {
          color: var(--primary-color);
        }
      }
    }
  }
}

.sub-guard-section {
  background: rgba(66, 184, 131, 0.05);
  border-radius: var(--radius-sm);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  border-left: 3px solid var(--primary-color);

  h3 {
    font-size: 1.3rem;
    color: var(--secondary-color);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;

    .icon {
      font-size: 1.5rem;
    }
  }

  .guard-details {
    margin-bottom: 1rem;
  }
}

.code-example {
  margin-bottom: 2rem;

  h3 {
    font-size: 1.2rem;
    color: var(--secondary-color);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;

    .icon {
      font-size: 1.25rem;
    }
  }
}

.important-note {
  background: rgba(255, 167, 38, 0.1);
  border-left: 3px solid #ffa726;
  border-radius: var(--radius-sm);
  padding: 1.25rem;
  margin-top: 1.5rem;

  h3 {
    font-size: 1.2rem;
    color: #ffa726;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;

    .icon {
      font-size: 1.25rem;
    }
  }

  p {
    color: #ef6c00;
    font-size: 1rem;

    code {
      background: rgba(0, 0, 0, 0.05);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-family: monospace;
    }
  }
}

.code-block {
  background-color: #2d2d2d;
  color: #f8f8f2;
  padding: 1.25rem;
  margin: 0;
  font-size: 0.9rem;
  font-family: 'JetBrains Mono', monospace;
  overflow-x: auto;
  line-height: 1.5;
  border-radius: var(--radius-sm);

  // è¯­æ³•é«˜äº®ï¼ˆç®€åŒ–ç‰ˆï¼‰
  .tag {
    color: #e06c75;
  }

  .attr {
    color: #d19a66;
  }

  .str {
    color: #98c379;
  }

  .key {
    color: #61afef;
  }

  .com {
    color: #5c6370;
  }
}

.execution-flow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin: 2rem 0;

  .flow-step {
    flex: 1;
    min-width: 120px;
    text-align: center;
    background: var(--primary-light);
    border-radius: var(--radius-sm);
    padding: 1rem;

    .step-number {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .step-title {
      font-weight: 500;
      font-size: 0.9rem;
    }
  }

  .flow-arrow {
    color: var(--text-light);
    font-size: 1.25rem;
    padding: 0 0.5rem;
  }
}

.footer {
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 2.5rem;
  margin-top: 3rem;
  box-shadow: var(--shadow-sm);

  .footer-content {
    h3 {
      font-size: 1.5rem;
      margin-bottom: 1.5rem;
      color: var(--secondary-color);
    }

    .principles {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      margin-bottom: 1.5rem;

      .principle {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1.25rem;
        background: var(--light-bg);
        border-radius: 50px;

        .principle-icon {
          font-size: 1.5rem;
        }

        p {
          font-weight: 500;
          margin: 0;
        }
      }
    }

    .footer-note {
      font-style: italic;
      color: var(--text-light);
      font-size: 1.1rem;
      max-width: 600px;
    }
  }
}

// æ·»åŠ åª’ä½“æŸ¥è¯¢ç¡®ä¿å“åº”å¼å¸ƒå±€
@media (max-width: 768px) {
  .header {
    flex-direction: column;
    align-items: flex-start;

    .stats-card {
      width: 100%;
      justify-content: space-around;
    }
  }

  .toc-grid {
    grid-template-columns: 1fr !important;
  }

  .guard-details {
    grid-template-columns: 1fr !important;
  }

  .guard-section {
    padding: 1.5rem;
  }

  .execution-flow {
    flex-direction: column;

    .flow-arrow {
      transform: rotate(90deg) !important;
      padding: 0.5rem 0 !important;
    }
  }

  .navigation-flow {
    flex-wrap: wrap;
    gap: 0.5rem !important;

    .flow-arrow {
      display: none;
    }
  }

  .footer {
    padding: 1.5rem;
  }
}

@media (max-width: 480px) {
  .header .title-section h1 {
    font-size: 1.8rem;
  }

  .intro-card h2 {
    font-size: 1.5rem;
  }

  .guard-section .section-header {
    flex-wrap: wrap;

    h2 {
      font-size: 1.4rem;
    }

    .guard-tag {
      margin-left: 0;
      margin-top: 1rem;
    }
  }

  .stats-card {
    gap: 0.5rem;
    padding: 1rem !important;

    .stat-item {
      .stat-value {
        font-size: 1.5rem !important;
      }
    }
  }

  .code-block {
    font-size: 0.8rem;
    padding: 1rem;
  }
}

// æ»šåŠ¨æ¡ç¾åŒ–
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--light-bg);
}

::-webkit-scrollbar-thumb {
  background: var(--primary-color);
  border-radius: 4px;
}

// å¹³æ»‘æ»šåŠ¨
html {
  scroll-behavior: smooth;
}

// é”šç‚¹å®šä½åç§»
[id] {
  scroll-margin-top: 80px;
}

// ä»£ç å—è¯­æ³•é«˜äº®å¢å¼º
.code-block {
  position: relative;

  &::after {
    content: 'JS';
    position: absolute;
    top: 8px;
    right: 8px;
    color: rgba(255, 255, 255, 0.3);
    font-size: 0.8rem;
    font-weight: bold;
    letter-spacing: 1px;
  }
}

// æ·»åŠ æ‚¬æµ®æ•ˆæœå¢å¼ºäº¤äº’æ€§
.toc-item,
.guard-section,
.intro-card,
.stats-card,
.detail-card {
  transition: all 0.3s ease;

  &:hover {
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    transform: translateY(-3px);
  }
}

// æ·»åŠ åŠ¨ç”»æ•ˆæœ
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.guard-section {
  animation: fadeIn 0.6s ease-out forwards;

  &:nth-child(1) {
    animation-delay: 0.1s;
  }

  &:nth-child(2) {
    animation-delay: 0.2s;
  }

  &:nth-child(3) {
    animation-delay: 0.3s;
  }

  &:nth-child(4) {
    animation-delay: 0.4s;
  }

  &:nth-child(5) {
    animation-delay: 0.5s;
  }

  &:nth-child(6) {
    animation-delay: 0.6s;
  }
}

// æ‰“å°ä¼˜åŒ–
@media print {
  .router-guards-container {
    padding: 0.5cm;
    font-size: 12pt;
  }

  .stats-card,
  .toc-grid,
  .intro-card .navigation-flow,
  .footer {
    display: none;
  }

  .code-block {
    page-break-inside: avoid;
  }
}
</style>
