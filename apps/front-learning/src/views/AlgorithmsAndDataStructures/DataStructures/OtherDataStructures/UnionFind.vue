<template>
  <div class="union-find-container">
    <header class="page-header">
      <h1>å¹¶æŸ¥é›† (Union-Find)</h1>
      <p class="subtitle">é«˜æ•ˆçš„åŠ¨æ€è¿é€šæ€§æ•°æ®ç»“æ„</p>
    </header>

    <div class="intro-section">
      <p>å¹¶æŸ¥é›†æ˜¯ä¸€ç§æ ‘å‹çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå¤„ç†ä¸€äº›ä¸äº¤é›†åˆï¼ˆDisjoint Setsï¼‰çš„åˆå¹¶åŠæŸ¥è¯¢é—®é¢˜ã€‚å®ƒæ”¯æŒä¸¤ç§æ“ä½œï¼šæŸ¥æ‰¾å…ƒç´ æ‰€å±é›†åˆï¼Œä»¥åŠåˆå¹¶ä¸¤ä¸ªé›†åˆã€‚</p>
    </div>

    <div class="content-layout">
      <!-- å·¦ä¾§å†…å®¹åŒºåŸŸ -->
      <div class="main-content">
        <!-- ç»“æ„ç‰¹ç‚¹ -->
        <section class="content-section">
          <div class="section-header">
            <h2>ç»“æ„ç‰¹ç‚¹</h2>
            <div class="section-tag">æ ¸å¿ƒæ¦‚å¿µ</div>
          </div>

          <div class="features-grid">
            <div class="feature-card">
              <div class="feature-icon">ğŸŒ³</div>
              <h3>æ ‘å½¢ç»“æ„</h3>
              <p>æ¯ä¸ªé›†åˆç”¨ä¸€æ£µæ ‘è¡¨ç¤ºï¼Œæ ‘çš„æ ¹èŠ‚ç‚¹ä»£è¡¨æ•´ä¸ªé›†åˆï¼Œæ¯ä¸ªèŠ‚ç‚¹æŒ‡å‘å…¶çˆ¶èŠ‚ç‚¹ã€‚</p>
            </div>

            <div class="feature-card">
              <div class="feature-icon">âš¡</div>
              <h3>é«˜æ•ˆæ“ä½œ</h3>
              <p>ç»è¿‡è·¯å¾„å‹ç¼©å’ŒæŒ‰ç§©åˆå¹¶ä¼˜åŒ–åï¼ŒæŸ¥æ‰¾å’Œåˆå¹¶æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ¥è¿‘å¸¸æ•°ã€‚</p>
            </div>

            <div class="feature-card">
              <div class="feature-icon">ğŸ”„</div>
              <h3>åŠ¨æ€è¿æ¥</h3>
              <p>æ”¯æŒåŠ¨æ€æ·»åŠ å…ƒç´ å’Œè¿æ¥æ“ä½œï¼Œé€‚åˆå¤„ç†åŠ¨æ€å˜åŒ–çš„è¿é€šå…³ç³»ã€‚</p>
            </div>

            <div class="feature-card">
              <div class="feature-icon">ğŸ’¾</div>
              <h3>ç©ºé—´é«˜æ•ˆ</h3>
              <p>åªéœ€è¦ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨çˆ¶èŠ‚ç‚¹ä¿¡æ¯ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚</p>
            </div>
          </div>

          <div class="structure-details">
            <h3>æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h3>
            <div class="details-grid">
              <div class="detail-item">
                <h4>çˆ¶æŒ‡é’ˆè¡¨ç¤ºæ³•</h4>
                <div class="visual-structure">
                  <div class="tree-diagram">
                    <div class="node root">æ ¹èŠ‚ç‚¹ (0)</div>
                    <div class="node">èŠ‚ç‚¹ (1) â†’ 0</div>
                    <div class="node">èŠ‚ç‚¹ (2) â†’ 0</div>
                    <div class="node">èŠ‚ç‚¹ (3) â†’ 1</div>
                    <div class="node">èŠ‚ç‚¹ (4) â†’ 1</div>
                  </div>
                </div>
                <p>æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ ¹èŠ‚ç‚¹æŒ‡å‘è‡ªå·±ã€‚</p>
              </div>

              <div class="detail-item">
                <h4>ä¸¤ç§ä¼˜åŒ–ç­–ç•¥</h4>
                <div class="optimization-list">
                  <div class="optimization-item">
                    <h5>è·¯å¾„å‹ç¼©</h5>
                    <p>åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œå°†è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ç›´æ¥è¿æ¥åˆ°æ ¹èŠ‚ç‚¹ï¼Œ flatten æ ‘ç»“æ„ã€‚</p>
                  </div>
                  <div class="optimization-item">
                    <h5>æŒ‰ç§©åˆå¹¶</h5>
                    <p>åˆå¹¶æ—¶æ€»æ˜¯å°†è¾ƒçŸ®çš„æ ‘è¿æ¥åˆ°è¾ƒé«˜çš„æ ‘ï¼Œä¿æŒæ ‘çš„å¹³è¡¡ã€‚</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- å›¾å½¢æ¼”ç¤º -->
        <section class="content-section">
          <div class="section-header">
            <h2>å›¾å½¢æ¼”ç¤º</h2>
            <div class="section-tag">äº¤äº’ä½“éªŒ</div>
          </div>

          <div class="demo-area">
            <div class="demo-controls">
              <div class="control-group">
                <label>æ“ä½œç±»å‹:</label>
                <Select v-model="demoOperation" @change="resetDemo">
                  <option value="find">æŸ¥æ‰¾ (Find)</option>
                  <option value="union">åˆå¹¶ (Union)</option>
                  <option value="pathCompression">è·¯å¾„å‹ç¼©</option>
                </select>
              </div>
              <div class="control-group">
                <label>å‚æ•°:</label>
                <input v-model="demoParam1" type="number" placeholder="èŠ‚ç‚¹1">
                <input v-if="demoOperation === 'union'" v-model="demoParam2" type="number" placeholder="èŠ‚ç‚¹2">
                <button @click="performDemoOperation" class="demo-btn">æ‰§è¡Œ</button>
                <button @click="resetDemo" class="demo-btn secondary">é‡ç½®</button>
              </div>
            </div>

            <div class="visualization-container">
              <div class="sets-visual">
                <div class="set" v-for="set in currentSets" :key="set.id">
                  <div class="set-header">é›†åˆ {{ set.root }}</div>
                  <div class="set-content">
                    <div
                      v-for="node in set.nodes"
                      :key="node"
                      :class="['node', {
                        'active': demoActiveNodes.includes(node),
                        'root': node === set.root
                      }]"
                    >
                      {{ node }}
                    </div>
                  </div>
                </div>
              </div>

              <div class="parent-array">
                <h4>çˆ¶æŒ‡é’ˆæ•°ç»„</h4>
                <div class="array-visual">
                  <div
                    v-for="(parent, index) in parentArray"
                    :key="index"
                    :class="['array-item', { 'active': demoActiveNodes.includes(index) }]"
                  >
                    <div class="index">{{ index }}</div>
                    <div class="value">â†’ {{ parent }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="demo-status">
              <div v-if="demoStatus" :class="['status-message', demoStatus.type]">
                {{ demoStatus.message }}
              </div>
            </div>

            <div class="operation-steps">
              <h4>æ“ä½œæ­¥éª¤</h4>
              <div class="steps">
                <div
                  v-for="(step, index) in operationSteps"
                  :key="index"
                  class="step"
                >
                  {{ step }}
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ä½¿ç”¨åœºæ™¯ -->
        <section class="content-section">
          <div class="section-header">
            <h2>ä½¿ç”¨åœºæ™¯</h2>
            <div class="section-tag">å®é™…åº”ç”¨</div>
          </div>

          <div class="scenarios-grid">
            <div class="scenario-card">
              <div class="scenario-icon">ğŸŒ</div>
              <h3>è¿é€šåˆ†é‡æ£€æµ‹</h3>
              <p>åœ¨æ— å‘å›¾ä¸­è®¡ç®—è¿é€šåˆ†é‡æ•°é‡ï¼Œåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦è¿é€šã€‚</p>
              <div class="scenario-code">
                <pre><code>// è®¡ç®—æ— å‘å›¾çš„è¿é€šåˆ†é‡
function countComponents(n, edges) {
  const uf = new UnionFind(n);
  for (const [u, v] of edges) {
    uf.union(u, v);
  }
  return uf.getCount();
}</code></pre>
              </div>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸ”„</div>
              <h3>Kruskalç®—æ³•</h3>
              <p>æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ä¸­æ£€æµ‹ç¯ï¼Œç¡®ä¿åŠ å…¥çš„è¾¹ä¸ä¼šå½¢æˆç¯ã€‚</p>
              <div class="scenario-code">
                <pre><code>// Kruskalç®—æ³•æ ¸å¿ƒ
if (!uf.connected(u, v)) {
  uf.union(u, v);
  mst.push(edge);
}</code></pre>
              </div>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸ¤–</div>
              <h3>åŠ¨æ€è¿é€šæ€§</h3>
              <p>ç¤¾äº¤ç½‘ç»œä¸­çš„å¥½å‹å…³ç³»ï¼ŒåŠ¨æ€åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨åŒä¸€åœˆå­ã€‚</p>
              <div class="scenario-code">
                <pre><code>// åŠ¨æ€å¥½å‹å…³ç³»
uf.union(user1, user2);
const areFriends = uf.connected(user1, user2);</code></pre>
              </div>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸ§©</div>
              <h3>å›¾åƒå¤„ç†</h3>
              <p>å›¾åƒåˆ†å‰²ä¸­çš„åŒºåŸŸåˆå¹¶ï¼Œå°†ç›¸é‚»çš„ç›¸ä¼¼åƒç´ ç‚¹åˆå¹¶ã€‚</p>
              <div class="scenario-code">
                <pre><code>// å›¾åƒåŒºåŸŸåˆå¹¶
if (pixelsSimilar(pixel1, pixel2)) {
  uf.union(pixel1Id, pixel2Id);
}</code></pre>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- å³ä¾§ä¾§è¾¹æ  -->
      <div class="sidebar">
        <!-- ä¼˜ç¼ºç‚¹ -->
        <section class="sidebar-section">
          <div class="section-header">
            <h2>ä¼˜ç¼ºç‚¹åˆ†æ</h2>
 <div class="section-tag">æƒè¡¡</div>
          </div>

          <div class="pros-cons">
            <div class="pros">
              <h3>ä¼˜ç‚¹ âœ…</h3>
              <div class="advantage-list">
                <div class="advantage-item">
                  <h4>è¿‘ä¹å¸¸æ•°æ—¶é—´</h4>
                  <p>ç»è¿‡ä¼˜åŒ–åï¼Œæ“ä½œæ—¶é—´å¤æ‚åº¦ä¸ºO(Î±(n))ï¼Œå…¶ä¸­Î±(n)æ˜¯åé˜¿å…‹æ›¼å‡½æ•°ï¼Œå¢é•¿æå…¶ç¼“æ…¢ã€‚</p>
                </div>
                <div class="advantage-item">
                  <h4>å®ç°ç®€å•</h4>
                  <p>æ ¸å¿ƒä»£ç åªæœ‰å‡ åè¡Œï¼Œå®¹æ˜“ç†è§£å’Œå®ç°ã€‚</p>
                </div>
                <div class="advantage-item">
                  <h4>ç©ºé—´é«˜æ•ˆ</h4>
                  <p>åªéœ€è¦ä¸€ä¸ªå¤§å°ä¸ºnçš„æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚</p>
                </div>
                <div class="advantage-item">
                  <h4>åŠ¨æ€æ“ä½œ</h4>
                  <p>æ”¯æŒåŠ¨æ€æ·»åŠ è¿æ¥å…³ç³»ï¼Œé€‚åˆå®æ—¶å˜åŒ–çš„åœºæ™¯ã€‚</p>
                </div>
              </div>
            </div>

            <div class="cons">
              <h3>ç¼ºç‚¹ âŒ</h3>
              <div class="disadvantage-list">
                <div class="disadvantage-item">
                  <h4>æ— æ³•åˆ†ç¦»</h4>
                  <p>æ ‡å‡†å¹¶æŸ¥é›†ä¸æ”¯æŒåˆ†ç¦»æ“ä½œï¼Œä¸€æ—¦åˆå¹¶å°±æ— æ³•æ‹†åˆ†ã€‚</p>
                </div>
                <div class="disadvantage-item">
                  <h4>ä¿¡æ¯æœ‰é™</h4>
                  <p>åªèƒ½åˆ¤æ–­è¿é€šæ€§ï¼Œæ— æ³•è·å–å…·ä½“çš„è¿æ¥è·¯å¾„ã€‚</p>
                </div>
                <div class="disadvantage-item">
                  <h4>å¸¸æ•°å› å­</h4>
                  <p>è™½ç„¶æ¸è¿›å¤æ‚åº¦ä¼˜ç§€ï¼Œä½†å®é™…å¸¸æ•°å› å­å¯èƒ½è¾ƒå¤§ã€‚</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- å¤æ‚åº¦åˆ†æ -->
        <section class="sidebar-section">
          <div class="section-header">
            <h2>å¤æ‚åº¦åˆ†æ</h2>
            <div class="section-tag">æ€§èƒ½</div>
          </div>

          <div class="complexity-analysis">
            <div class="complexity-table">
              <div class="complexity-row">
                <div class="op">æ“ä½œ</div>
                <div class="without-opt">æœªä¼˜åŒ–</div>
                <div class="with-opt">ä¼˜åŒ–å</div>
              </div>
              <div class="complexity-row">
                <div class="op">æŸ¥æ‰¾ (Find)</div>
                <div class="without-opt">O(n)</div>
                <div class="with-opt">O(Î±(n))</div>
              </div>
              <div class="complexity-row">
                <div class="op">åˆå¹¶ (Union)</div>
                <div class="without-opt">O(n)</div>
                <div class="with-opt">O(Î±(n))</div>
              </div>
              <div class="complexity-row">
                <div class="op">ç©ºé—´</div>
                <div class="without-opt">O(n)</div>
                <div class="with-opt">O(n)</div>
              </div>
            </div>

            <div class="complexity-notes">
              <h4>å…³é”®è¯´æ˜ï¼š</h4>
              <ul>
                <li>Î±(n)æ˜¯åé˜¿å…‹æ›¼å‡½æ•°ï¼Œå¯¹äºæ‰€æœ‰å®é™…nå€¼ï¼ŒÎ±(n) â‰¤ 5</li>
                <li>ä¼˜åŒ–åŒ…æ‹¬è·¯å¾„å‹ç¼©å’ŒæŒ‰ç§©åˆå¹¶</li>
                <li>åœ¨ç®—æ³•ç«èµ›ä¸­ï¼Œå¹¶æŸ¥é›†é€šå¸¸è¢«è®¤ä¸ºæ˜¯å¸¸æ•°æ—¶é—´æ“ä½œ</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- ç›¸å…³ç®—æ³• -->
        <section class="sidebar-section">
          <div class="section-header">
            <h2>ç›¸å…³ç®—æ³•</h2>
            <div class="section-tag">æ‰©å±•</div>
          </div>

          <div class="related-algorithms">
            <div class="algorithm-item">
              <h4>Kruskalç®—æ³•</h4>
              <p>ä½¿ç”¨å¹¶æŸ¥é›†æ£€æµ‹ç¯ï¼Œæ„å»ºæœ€å°ç”Ÿæˆæ ‘ã€‚</p>
            </div>
            <div class="algorithm-item">
              <h4>Tarjanç¦»çº¿LCA</h4>
              <p>ä½¿ç”¨å¹¶æŸ¥é›†å¤„ç†æœ€è¿‘å…¬å…±ç¥–å…ˆæŸ¥è¯¢ã€‚</p>
            </div>
            <div class="algorithm-item">
              <h4>åŠ¨æ€è¿é€šæ€§</h4>
              <p>å¤„ç†åŠ¨æ€æ·»åŠ å’Œåˆ é™¤è¾¹çš„è¿é€šæ€§é—®é¢˜ã€‚</p>
            </div>
            <div class="algorithm-item">
              <h4>å¸¦æƒå¹¶æŸ¥é›†</h4>
              <p>åœ¨å¹¶æŸ¥é›†ä¸­ç»´æŠ¤èŠ‚ç‚¹é—´çš„é¢å¤–ä¿¡æ¯ã€‚</p>
            </div>
          </div>
        </section>
      </div>
    </div>

    <!-- ä»£ç å®ç° -->
    <section class="code-section">
      <div class="section-header">
        <h2>ä»£ç å®ç°</h2>
        <div class="section-tag">TypeScript</div>
      </div>

      <div class="code-tabs">
        <div class="tab-buttons">
          <button
            v-for="tab in codeTabs"
            :key="tab.id"
            :class="['tab-button', { active: activeCodeTab === tab.id }]"
            @click="activeCodeTab = tab.id"
          >
            {{ tab.label }}
          </button>
        </div>

        <div class="tab-content">
          <!-- åŸºç¡€å®ç° -->
          <div v-if="activeCodeTab === 'basic'" class="code-block">
            <h3>åŸºç¡€å¹¶æŸ¥é›†å®ç°</h3>
            <pre><code>class UnionFind {
  private parent: number[];
  private count: number;

  constructor(n: number) {
    this.parent = new Array(n);
    this.count = n;

    // åˆå§‹åŒ–ï¼Œæ¯ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹éƒ½æ˜¯è‡ªå·±
    for (let i = 0; i < n; i++) {
      this.parent[i] = i;
    }
  }

  // æŸ¥æ‰¾å…ƒç´ æ‰€åœ¨é›†åˆçš„æ ¹èŠ‚ç‚¹
  find(x: number): number {
    while (this.parent[x] !== x) {
      x = this.parent[x];
    }
    return x;
  }

  // åˆå¹¶ä¸¤ä¸ªé›†åˆ
  union(x: number, y: number): void {
    const rootX = this.find(x);
    const rootY = this.find(y);

    if (rootX !== rootY) {
      this.parent[rootX] = rootY;
      this.count--;
    }
  }

  // åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å±äºåŒä¸€é›†åˆ
  connected(x: number, y: number): boolean {
    return this.find(x) === this.find(y);
  }

  // è·å–é›†åˆæ•°é‡
  getCount(): number {
    return this.count;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const uf = new UnionFind(5);
console.log('åˆå§‹é›†åˆæ•°é‡:', uf.getCount()); // 5

uf.union(0, 1);
uf.union(2, 3);
console.log('åˆå¹¶åé›†åˆæ•°é‡:', uf.getCount()); // 3

console.log('0å’Œ1æ˜¯å¦è¿é€š:', uf.connected(0, 1)); // true
console.log('0å’Œ2æ˜¯å¦è¿é€š:', uf.connected(0, 2)); // false</code></pre>
          </div>

          <!-- ä¼˜åŒ–ç‰ˆæœ¬ -->
          <div v-if="activeCodeTab === 'optimized'" class="code-block">
            <h3>ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆè·¯å¾„å‹ç¼© + æŒ‰ç§©åˆå¹¶ï¼‰</h3>
            <pre><code>class OptimizedUnionFind {
  private parent: number[];
  private rank: number[];
  private count: number;

  constructor(n: number) {
    this.parent = new Array(n);
    this.rank = new Array(n).fill(0);
    this.count = n;

    // åˆå§‹åŒ–
    for (let i = 0; i < n; i++) {
      this.parent[i] = i;
    }
  }

  // æŸ¥æ‰¾ï¼ˆå¸¦è·¯å¾„å‹ç¼©ï¼‰
  find(x: number): number {
    if (this.parent[x] !== x) {
      this.parent[x] = this.find(this.parent[x]); // è·¯å¾„å‹ç¼©
    }
    return this.parent[x];
  }

  // åˆå¹¶ï¼ˆå¸¦æŒ‰ç§©åˆå¹¶ï¼‰
  union(x: number, y: number): void {
    const rootX = this.find(x);
    const rootY = this.find(y);

    if (rootX !== rootY) {
      // æŒ‰ç§©åˆå¹¶
      if (this.rank[rootX] < this.rank[rootY]) {
        this.parent[rootX] = rootY;
      } else if (this.rank[rootX] > this.rank[rootY]) {
        this.parent[rootY] = rootX;
      } else {
        this.parent[rootY] = rootX;
        this.rank[rootX]++;
      }
      this.count--;
    }
  }

  connected(x: number, y: number): boolean {
    return this.find(x) === this.find(y);
  }

  getCount(): number {
    return this.count;
  }

  // è·å–æ¯ä¸ªå…ƒç´ æ‰€å±çš„é›†åˆ
  getSets(): Map&lt;number, number[]&gt; {
    const sets = new Map&lt;number, number[]&gt;();

    for (let i = 0; i < this.parent.length; i++) {
      const root = this.find(i);
      if (!sets.has(root)) {
        sets.set(root, []);
      }
      sets.get(root)!.push(i);
    }

    return sets;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const optimizedUF = new OptimizedUnionFind(5);
optimizedUF.union(0, 1);
optimizedUF.union(1, 2);
optimizedUF.union(3, 4);

console.log('é›†åˆæ•°é‡:', optimizedUF.getCount()); // 2
console.log('æ‰€æœ‰é›†åˆ:', optimizedUF.getSets());
// è¾“å‡º: Map { 0 => [0, 1, 2], 3 => [3, 4] }</code></pre>
          </div>

          <!-- åº”ç”¨ç¤ºä¾‹ -->
          <div v-if="activeCodeTab === 'applications'" class="code-block">
            <h3>åº”ç”¨ç¤ºä¾‹ï¼šè®¡ç®—è¿é€šåˆ†é‡</h3>
            <pre><code>// è®¡ç®—æ— å‘å›¾ä¸­çš„è¿é€šåˆ†é‡æ•°é‡
function countConnectedComponents(n: number, edges: number[][]): number {
  const uf = new OptimizedUnionFind(n);

  for (const [u, v] of edges) {
    uf.union(u, v);
  }

  return uf.getCount();
}

// ç¤ºä¾‹ä½¿ç”¨
const n = 5;
const edges = [[0, 1], [1, 2], [3, 4]];
console.log('è¿é€šåˆ†é‡æ•°é‡:', countConnectedComponents(n, edges)); // 2

// Kruskalç®—æ³•å®ç°æœ€å°ç”Ÿæˆæ ‘
interface Edge {
  from: number;
  to: number;
  weight: number;
}

function kruskalMST(vertices: number, edges: Edge[]): Edge[] {
  // æŒ‰æƒé‡æ’åºè¾¹
  edges.sort((a, b) => a.weight - b.weight);

  const uf = new OptimizedUnionFind(vertices);
  const mst: Edge[] = [];

  for (const edge of edges) {
    if (!uf.connected(edge.from, edge.to)) {
      uf.union(edge.from, edge.to);
      mst.push(edge);

      // å½“ç”Ÿæˆæ ‘æœ‰n-1æ¡è¾¹æ—¶åœæ­¢
      if (mst.length === vertices - 1) {
        break;
      }
    }
  }

  return mst;
}

// ç¤ºä¾‹ä½¿ç”¨
const vertices = 4;
const weightedEdges = [
  { from: 0, to: 1, weight: 10 },
  { from: 0, to: 2, weight: 6 },
  { from: 0, to: 3, weight: 5 },
  { from: 1, to: 3, weight: 15 },
  { from: 2, to: 3, weight: 4 }
];

const mst = kruskalMST(vertices, weightedEdges);
console.log('æœ€å°ç”Ÿæˆæ ‘è¾¹:', mst);</code></pre>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<script setup lang="ts">
import { ref,  computed } from 'vue';

// ä»£ç æ ‡ç­¾é¡µ
const activeCodeTab = ref('basic');
const codeTabs = [
  { id: 'basic', label: 'åŸºç¡€å®ç°' },
  { id: 'optimized', label: 'ä¼˜åŒ–ç‰ˆæœ¬' },
  { id: 'applications', label: 'åº”ç”¨ç¤ºä¾‹' }
];

// æ¼”ç¤ºç›¸å…³çŠ¶æ€
const demoOperation = ref('find');
const demoParam1 = ref('1');
const demoParam2 = ref('2');
const demoActiveNodes = ref<number[]>([]);
const demoStatus = ref<{type: string, message: string} | null>(null);
const operationSteps = ref<string[]>([]);

// åˆå§‹å¹¶æŸ¥é›†çŠ¶æ€
const parentArray = ref([0, 1, 2, 3, 4]); // åˆå§‹æ¯ä¸ªèŠ‚ç‚¹æŒ‡å‘è‡ªå·±

// è®¡ç®—å½“å‰é›†åˆçŠ¶æ€
const currentSets = computed(() => {
  const sets = new Map<number, number[]>();

  for (let i = 0; i < parentArray.value.length; i++) {
    let current = i;

    // æ‰¾åˆ°æ ¹èŠ‚ç‚¹
    while (parentArray.value[current] !== current) {
      current = parentArray.value[current];
    }
    const root = current;

    if (!sets.has(root)) {
      sets.set(root, []);
    }
    sets.get(root)!.push(i);
  }

  return Array.from(sets.entries()).map(([root, nodes]) => ({
    id: root,
    root,
    nodes
  }));
});

// é‡ç½®æ¼”ç¤º
const resetDemo = () => {
  parentArray.value = [0, 1, 2, 3, 4];
  demoActiveNodes.value = [];
  demoStatus.value = null;
  operationSteps.value = [];
};

// æ‰§è¡Œæ¼”ç¤ºæ“ä½œ
const performDemoOperation = () => {
  const node1 = parseInt(demoParam1.value);
  const node2 = parseInt(demoParam2.value);

  if (isNaN(node1) || node1 < 0 || node1 >= parentArray.value.length) {
    demoStatus.value = {
      type: 'error',
      message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„èŠ‚ç‚¹1'
    };
    return;
  }

  demoActiveNodes.value = [];
  operationSteps.value = [];

  switch (demoOperation.value) {
    case 'find':
      performFind(node1);
      break;
    case 'union':
      if (isNaN(node2) || node2 < 0 || node2 >= parentArray.value.length) {
        demoStatus.value = {
          type: 'error',
          message: 'è¯·è¾“å…¥æœ‰æ•ˆçš„èŠ‚ç‚¹2'
        };
        return;
      }
      performUnion(node1, node2);
      break;
    case 'pathCompression':
      performPathCompression(node1);
      break;
  }
};

// æ‰§è¡ŒæŸ¥æ‰¾æ“ä½œ
const performFind = (node: number) => {
  operationSteps.value = [
    `å¼€å§‹æŸ¥æ‰¾èŠ‚ç‚¹ ${node} çš„æ ¹èŠ‚ç‚¹`,
    `å½“å‰çˆ¶èŠ‚ç‚¹: ${parentArray.value[node]}`
  ];

  let current = node;
  demoActiveNodes.value.push(current);

  while (parentArray.value[current] !== current) {
    current = parentArray.value[current];
    demoActiveNodes.value.push(current);
    operationSteps.value.push(`ç§»åŠ¨åˆ°çˆ¶èŠ‚ç‚¹: ${current}`);
  }

  operationSteps.value.push(`æ‰¾åˆ°æ ¹èŠ‚ç‚¹: ${current}`);

  demoStatus.value = {
    type: 'success',
    message: `èŠ‚ç‚¹ ${node} çš„æ ¹èŠ‚ç‚¹æ˜¯ ${current}`
  };
};

// æ‰§è¡Œåˆå¹¶æ“ä½œ
const performUnion = (node1: number, node2: number) => {
  operationSteps.value = [
    `å¼€å§‹åˆå¹¶èŠ‚ç‚¹ ${node1} å’Œ ${node2}`,
    `æŸ¥æ‰¾èŠ‚ç‚¹ ${node1} çš„æ ¹èŠ‚ç‚¹...`
  ];

  // ç®€åŒ–ç‰ˆæŸ¥æ‰¾ï¼Œä¸åŒ…å«è·¯å¾„å‹ç¼©
  let root1 = node1;
  while (parentArray.value[root1] !== root1) {
    root1 = parentArray.value[root1];
  }

  operationSteps.value.push(`èŠ‚ç‚¹ ${node1} çš„æ ¹èŠ‚ç‚¹æ˜¯ ${root1}`);
  operationSteps.value.push(`æŸ¥æ‰¾èŠ‚ç‚¹ ${node2} çš„æ ¹èŠ‚ç‚¹...`);

  let root2 = node2;
  while (parentArray.value[root2] !== root2) {
    root2 = parentArray.value[root2];
  }

  operationSteps.value.push(`èŠ‚ç‚¹ ${node2} çš„æ ¹èŠ‚ç‚¹æ˜¯ ${root2}`);

  if (root1 === root2) {
    operationSteps.value.push(`ä¸¤ä¸ªèŠ‚ç‚¹å·²ç»åœ¨åŒä¸€é›†åˆä¸­ï¼Œæ— éœ€åˆå¹¶`);
    demoStatus.value = {
      type: 'info',
      message: `èŠ‚ç‚¹ ${node1} å’Œ ${node2} å·²ç»åœ¨åŒä¸€é›†åˆä¸­`
    };
  } else {
    parentArray.value[root1] = root2;
    operationSteps.value.push(`å°†æ ¹èŠ‚ç‚¹ ${root1} è¿æ¥åˆ°æ ¹èŠ‚ç‚¹ ${root2}`);
    demoStatus.value = {
      type: 'success',
      message: `æˆåŠŸåˆå¹¶èŠ‚ç‚¹ ${node1} å’Œ ${node2}`
    };
  }

  demoActiveNodes.value = [node1, node2, root1, root2];
};

// æ‰§è¡Œè·¯å¾„å‹ç¼©æ¼”ç¤º
const performPathCompression = (node: number) => {
  operationSteps.value = [
    `å¯¹èŠ‚ç‚¹ ${node} æ‰§è¡Œè·¯å¾„å‹ç¼©`,
    `æŸ¥æ‰¾æ ¹èŠ‚ç‚¹å¹¶å‹ç¼©è·¯å¾„...`
  ];

  const path = [node];
  let current = node;

  // å…ˆæ‰¾åˆ°æ ¹èŠ‚ç‚¹
  while (parentArray.value[current] !== current) {
    current = parentArray.value[current];
    path.push(current);
  }
  const root = current;

  operationSteps.value.push(`æ‰¾åˆ°æ ¹èŠ‚ç‚¹: ${root}`);
  operationSteps.value.push(`è·¯å¾„ä¸Šçš„èŠ‚ç‚¹: [${path.join(', ')}]`);

  // è·¯å¾„å‹ç¼©ï¼šå°†è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç›´æ¥è¿æ¥åˆ°æ ¹èŠ‚ç‚¹
  for (const pathNode of path) {
    if (pathNode !== root) {
      parentArray.value[pathNode] = root;
      operationSteps.value.push(`å°†èŠ‚ç‚¹ ${pathNode} ç›´æ¥è¿æ¥åˆ°æ ¹èŠ‚ç‚¹ ${root}`);
    }
  }

  demoActiveNodes.value = [...path];
  demoStatus.value = {
    type: 'success',
    message: `è·¯å¾„å‹ç¼©å®Œæˆï¼Œæ‰€æœ‰èŠ‚ç‚¹ç°åœ¨ç›´æ¥è¿æ¥åˆ°æ ¹èŠ‚ç‚¹ ${root}`
  };
};
</script>

<style lang="less" scoped>
.union-find-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  color: #2c3e50;
  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  min-height: 100vh;
}

.page-header {
  text-align: center;
  margin-bottom: 3rem;

  h1 {
    font-size: 3rem;
    font-weight: 700;
    background: linear-gradient(135deg, #2c3e50 0%, #6366f1 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 0.5rem;
  }

  .subtitle {
    font-size: 1.3rem;
    color: #64748b;
    font-weight: 400;
  }
}

.intro-section {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  padding: 2rem;
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  margin-bottom: 2.5rem;
  font-size: 1.1rem;
  color: #475569;
  line-height: 1.7;
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.content-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 2rem;
  margin-bottom: 3rem;

  @media (max-width: 1024px) {
    grid-template-columns: 1fr;
  }
}

.content-section, .sidebar-section {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.3);
  margin-bottom: 2rem;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid #e2e8f0;

  h2 {
    font-size: 1.8rem;
    font-weight: 600;
    color: #1e293b;
    margin: 0;
  }

  .section-tag {
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 500;
  }
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.feature-card {
  background: white;
  padding: 1.5rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  border-left: 4px solid #6366f1;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
  }

  .feature-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
  }

  h3 {
    font-size: 1.2rem;
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 0.8rem;
  }

  p {
    color: #64748b;
    line-height: 1.6;
    margin: 0;
  }
}

.structure-details {
  margin-top: 2rem;

  h3 {
    font-size: 1.4rem;
    font-weight: 600;
    color: #334155;
    margin-bottom: 1.5rem;
  }
}

.details-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

.detail-item {
  background: #f8fafc;
  padding: 1.5rem;
  border-radius: 12px;
  border: 1px solid #e2e8f0;

  h4 {
    font-size: 1.1rem;
    font-weight: 600;
    color: #475569;
    margin-bottom: 1rem;
  }

  p {
    color: #64748b;
    line-height: 1.6;
    margin-top: 1rem;
  }
}

.visual-structure {
  .tree-diagram {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    padding: 1rem;
  }

  .node {
    padding: 0.8rem;
    margin: 0.5rem 0;
    border-radius: 6px;
    background: #f1f5f9;
    font-family: 'Fira Code', monospace;

    &.root {
      background: #dbeafe;
      color: #1e40af;
      font-weight: 600;
    }
  }
}

.optimization-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.optimization-item {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  border-left: 4px solid #10b981;

  h5 {
    font-size: 1rem;
    font-weight: 600;
    color: #047857;
    margin-bottom: 0.5rem;
  }

  p {
    color: #64748b;
    line-height: 1.5;
    margin: 0;
    font-size: 0.9rem;
  }
}

// æ¼”ç¤ºåŒºåŸŸæ ·å¼
.demo-area {
  .demo-controls {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;

    .control-group {
      display: flex;
      align-items: center;
      gap: 0.8rem;

      label {
        font-weight: 500;
        color: #475569;
      }

      select, input {
        padding: 0.5rem 1rem;
        border: 1px solid #cbd5e1;
        border-radius: 6px;
        background: white;
      }

      .demo-btn {
        padding: 0.5rem 1.5rem;
        background: #6366f1;
        color: white;
        border: none;
        border-radius: 6px;
        font-weight: 500;
        cursor: pointer;
        transition: background 0.3s ease;

        &:hover {
          background: #4f46e5;
        }

        &.secondary {
          background: #64748b;

          &:hover {
            background: #475569;
          }
        }
      }
    }
  }
}

.visualization-container {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 2rem;
  margin-bottom: 2rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

.sets-visual {
  background: #f8fafc;
  padding: 1.5rem;
  border-radius: 12px;
  border: 1px solid #e2e8f0;
}

.set {
  margin-bottom: 1.5rem;

  &:last-child {
    margin-bottom: 0;
  }

  .set-header {
    font-weight: 600;
    color: #475569;
    margin-bottom: 0.8rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #e2e8f0;
  }
}

.set-content {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.node {
  padding: 0.8rem 1.2rem;
  background: white;
  border: 2px solid #cbd5e1;
  border-radius: 8px;
  font-weight: 500;
  transition: all 0.3s ease;

  &.root {
    background: #dbeafe;
    border-color: #3b82f6;
    color: #1e40af;
  }

  &.active {
    background: #fef3c7;
    border-color: #f59e0b;
    animation: pulse 1.5s infinite;
  }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.parent-array {
  background: #f8fafc;
  padding: 1.5rem;
  border-radius: 12px;
  border: 1px solid #e2e8f0;

  h4 {
    font-weight: 600;
    color: #475569;
    margin-bottom: 1rem;
  }
}

.array-visual {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 0.5rem;

  @media (max-width: 768px) {
    grid-template-columns: repeat(3, 1fr);
  }
}

.array-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0.8rem;
  background: white;
  border: 2px solid #cbd5e1;
  border-radius: 6px;
  transition: all 0.3s ease;

  &.active {
    background: #fef3c7;
    border-color: #f59e0b;
  }

  .index {
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.3rem;
  }

  .value {
    font-size: 0.9rem;
    color: #6366f1;
    font-family: 'Fira Code', monospace;
  }
}

.demo-status {
  margin-bottom: 1.5rem;

  .status-message {
    padding: 1rem;
    border-radius: 8px;
    font-weight: 500;

    &.success {
      background: #dcfce7;
      color: #166534;
      border-left: 4px solid #22c55e;
    }

    &.error {
      background: #fef2f2;
      color: #dc2626;
      border-left: 4px solid #ef4444;
    }

    &.info {
      background: #eff6ff;
      color: #1e40af;
      border-left: 4px solid #3b82f6;
    }
  }
}

.operation-steps {
  h4 {
    font-weight: 600;
    color: #475569;
    margin-bottom: 1rem;
  }
}

.steps {
  background: #f8fafc;
  border-radius: 8px;
  padding: 1rem;
  max-height: 200px;
  overflow-y: auto;
}

.step {
  padding: 0.8rem;
  margin-bottom: 0.5rem;
  background: white;
  border-radius: 6px;
  border-left: 4px solid #6366f1;
  font-size: 0.9rem;
  color: #475569;

  &:last-child {
    margin-bottom: 0;
  }
}

// ä½¿ç”¨åœºæ™¯ç½‘æ ¼
.scenarios-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
}

.scenario-card {
  background: white;
  padding: 1.5rem;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border: 1px solid #e2e8f0;

  .scenario-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
  }

  h3 {
    font-size: 1.2rem;
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 0.8rem;
  }

  p {
    color: #64748b;
    line-height: 1.5;
    margin-bottom: 1rem;
  }
}

.scenario-code {
  background: #1e293b;
  border-radius: 6px;
  overflow: hidden;

  pre {
    margin: 0;
    padding: 1rem;
    overflow-x: auto;

    code {
      font-family: 'Fira Code', 'Courier New', monospace;
      font-size: 0.8rem;
      color: #e2e8f0;
      line-height: 1.4;
    }
  }
}

// ä¼˜ç¼ºç‚¹æ ·å¼
.pros-cons {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.pros, .cons {
  h3 {
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e2e8f0;
  }
}

.pros h3 {
  color: #059669;
}

.cons h3 {
  color: #dc2626;
}

.advantage-list, .disadvantage-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.advantage-item, .disadvantage-item {
  background: #f8fafc;
  padding: 1.2rem;
  border-radius: 8px;
  border-left: 4px solid;

  h4 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  p {
    color: #64748b;
    line-height: 1.5;
    margin: 0;
    font-size: 0.9rem;
  }
}

.advantage-item {
  border-left-color: #10b981;
}

.disadvantage-item {
  border-left-color: #ef4444;
}

// å¤æ‚åº¦åˆ†æ
.complexity-analysis {
  .complexity-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    margin-bottom: 1.5rem;
  }

  .complexity-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    border-bottom: 1px solid #e2e8f0;

    &:first-child {
      background: #475569;
      color: white;
      font-weight: 600;
    }

    &:last-child {
      border-bottom: none;
    }

    div {
      padding: 1rem;
      text-align: center;
    }

    .op {
      font-weight: 600;
      color: #374151;
      text-align: left;
    }
  }
}

.complexity-notes {
  h4 {
    font-size: 1rem;
    font-weight: 600;
    color: #475569;
    margin-bottom: 0.8rem;
  }

  ul {
    color: #64748b;
    padding-left: 1.2rem;

    li {
      margin-bottom: 0.5rem;
      line-height: 1.4;
    }
  }
}

// ç›¸å…³ç®—æ³•
.related-algorithms {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.algorithm-item {
  background: #f8fafc;
  padding: 1rem;
  border-radius: 8px;
  border-left: 4px solid #6366f1;

  h4 {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.5rem;
  }

  p {
    color: #64748b;
    line-height: 1.5;
    margin: 0;
    font-size: 0.9rem;
  }
}

// ä»£ç éƒ¨åˆ†
.code-section {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.3);
}

.code-tabs {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.tab-buttons {
  display: flex;
  background: #f8fafc;
  border-bottom: 1px solid #e2e8f0;

  .tab-button {
    flex: 1;
    padding: 1rem 1.5rem;
    border: none;
    background: transparent;
    color: #64748b;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;

    &:hover {
      background: #f1f5f9;
      color: #475569;
    }

    &.active {
      background: white;
      color: #6366f1;
      border-bottom: 2px solid #6366f1;
    }
  }
}

.tab-content {
  padding: 0;
}

.code-block {
  h3 {
    padding: 1.5rem 1.5rem 0.5rem;
    margin: 0;
    font-size: 1.2rem;
    color: #2c3e50;
    font-weight: 600;
  }

  pre {
    margin: 0;
    padding: 1.5rem;
    background: #1e293b;
    overflow-x: auto;

    code {
      font-family: 'Fira Code', 'Courier New', monospace;
      font-size: 0.85rem;
      color: #e2e8f0;
      line-height: 1.5;
    }
  }
}

// å“åº”å¼è®¾è®¡
@media (max-width: 768px) {
  .union-find-container {
    padding: 1rem;
  }

  .page-header h1 {
    font-size: 2.2rem;
  }

  .content-layout {
    gap: 1.5rem;
  }

  .content-section, .sidebar-section {
    padding: 1.5rem;
  }

  .features-grid {
    grid-template-columns: 1fr;
  }

  .details-grid {
    grid-template-columns: 1fr;
  }

  .demo-controls {
    flex-direction: column;
    gap: 1rem;

    .control-group {
      width: 100%;
    }
  }

  .visualization-container {
    grid-template-columns: 1fr;
  }

  .array-visual {
    grid-template-columns: repeat(5, 1fr);
  }

  .scenarios-grid {
    grid-template-columns: 1fr;
  }
}
</style>
