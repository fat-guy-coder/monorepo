// ProxyDocument.vue

<template>
  <div class="proxy-doc-container">
    <!-- å¤´éƒ¨ -->
    <header class="doc-header">
      <h1 class="title">ğŸ¯ ES6 Proxy åŸºæœ¬æŒ‡å—</h1>
      <p class="subtitle">å…ƒç¼–ç¨‹çš„é­”æ³•å·¥å…·</p>
      <div class="decorative-line"></div>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="doc-content">
      <!-- æ ¸å¿ƒæ¦‚å¿µ -->
      <section class="section concept">
        <h2 class="section-title"><span class="icon">ğŸ”®</span> æ ¸å¿ƒæ¦‚å¿µ</h2>
        <h4>
          Proxy
          æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå®ƒå¯ä»¥æ‹¦æˆªå¹¶å®šä¹‰åŸºæœ¬æ“ä½œï¼ˆå¦‚å±æ€§æŸ¥æ‰¾ã€èµ‹å€¼ã€æšä¸¾ã€å‡½æ•°è°ƒç”¨ç­‰ï¼‰çš„è‡ªå®šä¹‰è¡Œä¸ºã€‚é€šè¿‡ä½¿ç”¨
          Proxyï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¹å˜åŸå§‹å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œæ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ•°æ®éªŒè¯ã€æ—¥å¿—è®°å½•ç­‰ã€‚
        </h4>
        <div class="concept-grid">
          <div class="concept-card">
            <div class="card-header">ä»£ç†ç›®æ ‡</div>
            <div class="card-content">è¢«åŒ…è£…çš„åŸå§‹å¯¹è±¡</div>
          </div>
          <div class="concept-card">
            <div class="card-header">å¤„ç†å™¨å¯¹è±¡</div>
            <div class="card-content">åŒ…å«é™·é˜±æ–¹æ³•çš„é…ç½®å¯¹è±¡</div>
          </div>
          <div class="concept-card">
            <div class="card-header">é™·é˜±æ–¹æ³•</div>
            <div class="card-content">æ‹¦æˆªæ“ä½œçš„å‡½æ•°</div>
          </div>
        </div>
      </section>

      <!-- åŸºç¡€ç”¨æ³• -->
      <section class="section basic-usage">
        <h2 class="section-title"><span class="icon">ğŸ› ï¸</span> åŸºç¡€ç”¨æ³•</h2>
        <div class="code-example">
          <pre class="code-block"><code>interface User {
  name: string;
  age: number;
}

const target: User = { name: 'Alice', age: 25 };
const handler: ProxyHandler= {
  get(target, prop) {
    return prop in target ? target[prop] : 'N/A';
  }
};

const proxy = new Proxy(target, handler);

console.log(proxy.name); // Alice
console.log(proxy.gender); // N/A</code></pre>
        </div>
      </section>

      <!-- å¸¸ç”¨é™·é˜± -->
      <section class="section traps">
        <h2 class="section-title"><span class="icon">â›“ï¸</span> å¸¸ç”¨é™·é˜±æ–¹æ³•</h2>
        <div class="trap-grid">
          <div v-for="trap in traps" :key="trap.name" class="trap-card">
            <h3>{{ trap.name }}</h3>
            <p>{{ trap.desc }}</p>
            <div class="syntax">{{ trap.syntax }}</div>
          </div>
        </div>
      </section>

      <!-- Proxy vs defineProperty -->
      <section class="section comparison">
        <h2 class="section-title"><span class="icon">ğŸ”</span> Proxy vs Object.defineProperty</h2>

        <div class="comparison-grid">
          <div class="comparison-card">
            <h3>æ‹¦æˆªæ“ä½œèŒƒå›´</h3>
            <div class="compare-content">
              <div class="proxy-side">
                <h4>Proxy</h4>
                <p>å¯ä»¥æ‹¦æˆªå¤šè¾¾13ç§å¯¹è±¡æ“ä½œ,åŒ…æ‹¬å±æ€§è®¿é—®ã€èµ‹å€¼ã€åˆ é™¤ã€å‡½æ•°è°ƒç”¨ç­‰</p>
              </div>
              <div class="define-side">
                <h4>defineProperty</h4>
                <p>ä»…èƒ½æ‹¦æˆªå¯¹è±¡å±æ€§çš„getterå’Œsetteræ“ä½œ</p>
              </div>
            </div>
          </div>

          <div class="comparison-card">
            <h3>ä½¿ç”¨åœºæ™¯</h3>
            <div class="compare-content">
              <div class="proxy-side">
                <h4>Proxy</h4>
                <ul>
                  <li>æ•°æ®éªŒè¯å’Œè¿‡æ»¤</li>
                  <li>æ—¥å¿—è®°å½•</li>
                  <li>æ ¼å¼åŒ–</li>
                  <li>åªè¯»è§†å›¾</li>
                  <li>å±æ€§éšè—</li>
                </ul>
              </div>
              <div class="define-side">
                <h4>defineProperty</h4>
                <ul>
                  <li>ç®€å•çš„æ•°æ®åŠ«æŒ</li>
                  <li>è®¡ç®—å±æ€§</li>
                  <li>å±æ€§ä¿æŠ¤</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="comparison-card">
            <h3>ä½¿ç”¨é™åˆ¶</h3>
            <div class="compare-content">
              <div class="proxy-side">
                <h4>Proxy</h4>
                <ul>
                  <li>æ— æ³•ç›‘å¬åˆ°å¯¹è±¡å¼•ç”¨çš„å˜åŒ–</li>
                  <li>éœ€è¦é¢å¤–çš„polyfillæ”¯æŒ</li>
                  <li>æ€§èƒ½å¼€é”€ç›¸å¯¹è¾ƒå¤§</li>
                </ul>
              </div>
              <div class="define-side">
                <h4>defineProperty</h4>
                <ul>
                  <li>å¿…é¡»é¢„å…ˆçŸ¥é“è¦ç›‘å¬çš„å±æ€§</li>
                  <li>ä¸èƒ½ç›‘å¬æ•°ç»„é•¿åº¦å˜åŒ–</li>
                  <li>ä¸èƒ½ç›‘å¬å¯¹è±¡å±æ€§çš„æ·»åŠ å’Œåˆ é™¤</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="code-example">
          <h3>å¯¹æ¯”ç¤ºä¾‹:</h3>
          <pre class="code-block"><code>// Proxyæ–¹å¼
const target = { name: 'Alice' };
const proxy = new Proxy(target, {
  get(target, prop) {
    console.log(`è®¿é—®äº†${String(prop)}å±æ€§`);
    return target[prop];
  },
  set(target, prop, value) {
    console.log(`è®¾ç½®${String(prop)}=${value}`);
    target[prop] = value;
    return true;
  }
});

// definePropertyæ–¹å¼
const obj = {};
Object.defineProperty(obj, 'name', {
  get() {
    console.log('è®¿é—®äº†nameå±æ€§');
    return this._name;
  },
  set(value) {
    console.log(`è®¾ç½®name=${value}`);
    this._name = value;
  }
});</code></pre>
        </div>
      </section>

      <!-- åº”ç”¨åœºæ™¯ -->
      <section class="section use-cases">
        <h2 class="section-title"><span class="icon">ğŸ’¡</span> åº”ç”¨åœºæ™¯</h2>
        <div class="case-container">
          <div v-for="(scene, index) in scenes" :key="index" class="case-card">
            <h3>{{ scene.name }}</h3>
            <p>{{ scene.desc }}</p>
          </div>
        </div>
      </section>
    </main>

    <!-- æ³¨æ„äº‹é¡¹ -->
    <footer class="doc-footer">
      <div class="notice-box">
        <h3>âš ï¸ æ³¨æ„äº‹é¡¹</h3>
        <ul>
          <li>Proxyæ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å¼•ç”¨å˜åŒ–</li>
          <li>æ·±åº¦ä»£ç†éœ€è¦é€’å½’å®ç°</li>
          <li>éƒ¨åˆ†ä½ç‰ˆæœ¬æµè§ˆå™¨éœ€è¦polyfill</li>
        </ul>
      </div>
    </footer>
  </div>
</template>
<script lang="ts" setup>
interface TrapConfig {
  name: string
  desc: string
  syntax: string
}

const traps: TrapConfig[] = [
  {
    name: 'get',
    desc: 'æ‹¦æˆªå±æ€§è¯»å–æ“ä½œ',
    syntax: 'get(target, prop, receiver)',
  },
  {
    name: 'set',
    desc: 'æ‹¦æˆªå±æ€§è®¾ç½®æ“ä½œ',
    syntax: 'set(target, prop, value, receiver)',
  },
  {
    name: 'apply',
    desc: 'æ‹¦æˆªå‡½æ•°è°ƒç”¨æ“ä½œ',
    syntax: 'apply(target, thisArg, args)',
  },
  {
    name: 'construct',
    desc: 'æ‹¦æˆªnewæ“ä½œç¬¦',
    syntax: 'construct(target, args, newTarget)',
  },
  {
    name: 'deleteProperty',
    desc: 'æ‹¦æˆªå±æ€§åˆ é™¤æ“ä½œ',
    syntax: 'deleteProperty(target, prop)',
  },
  {
    name: 'has',
    desc: 'æ‹¦æˆªå±æ€§å­˜åœ¨æ€§æ£€æŸ¥',
    syntax: 'has(target, prop)',
  },
  {
    name: 'ownKeys',
    desc: 'æ‹¦æˆªå¯¹è±¡å±æ€§çš„æšä¸¾',
    syntax: 'ownKeys(target)',
  },
  {
    name: 'getOwnPropertyDescriptor',
    desc: 'æ‹¦æˆªè·å–å±æ€§æè¿°ç¬¦æ“ä½œ',
    syntax: 'getOwnPropertyDescriptor(target, prop)',
  },
  {
    name: 'setPrototypeOf',
    desc: 'æ‹¦æˆªè®¾ç½®å¯¹è±¡åŸå‹æ“ä½œ',
    syntax: 'setPrototypeOf(target, proto)',
  },
  {
    name: 'isExtensible',
    desc: 'æ‹¦æˆªå¯¹è±¡æ‰©å±•æ€§æ£€æŸ¥',
    syntax: 'isExtensible(target)',
  },
  {
    name: 'preventExtensions',
    desc: 'æ‹¦æˆªå¯¹è±¡é˜²æ­¢æ‰©å±•æ“ä½œ',
    syntax: 'preventExtensions(target)',
  },
]
const scenes = [
  { name: 'æ•°æ®éªŒè¯', desc: 'å±æ€§èµ‹å€¼æ—¶è‡ªåŠ¨éªŒè¯æ•°æ®ç±»å‹' },
  { name: 'æ—¥å¿—è¿½è¸ª', desc: 'è‡ªåŠ¨è®°å½•å¯¹è±¡æ“ä½œæ—¥å¿—' },
  { name: 'æƒ°æ€§åŠ è½½', desc: 'æŒ‰éœ€åŠ è½½å¤§å‹å¯¹è±¡å±æ€§' },
  { name: 'æ€§èƒ½ä¼˜åŒ–', desc: 'é€šè¿‡ä»£ç†å®ç°æ‡’åŠ è½½å’Œç¼“å­˜' },
  { name: 'æ•°æ®ç»‘å®š', desc: 'å®ç°å“åº”å¼æ•°æ®ç»‘å®š' },
  { name: 'æƒé™æ§åˆ¶', desc: 'åŠ¨æ€æ§åˆ¶å¯¹è±¡å±æ€§çš„è®¿é—®æƒé™' },
]
</script>

<style lang="less" scoped>
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;600;800&display=swap');

div,
code {
  color: #000;
}

.proxy-doc-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 2rem 3rem;
  background: linear-gradient(145deg, #f8f9fa 0%, #ffffff 100%);
  border-radius: 16px;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
  font-family: 'Inter', sans-serif;

  .doc-header {
    text-align: center;
    margin-bottom: 3rem;
    position: relative;

    .title {
      color: #6c5ce7;
      font-size: 2.8rem;
      margin: 1rem 0;
      text-shadow: 2px 2px 4px rgba(108, 92, 231, 0.1);
    }

    .subtitle {
      color: #a8a8a8;
      font-size: 1.4rem;
      letter-spacing: 0.05em;
    }

    .decorative-line {
      width: 80px;
      height: 4px;
      background: #6c5ce7;
      margin: 1.5rem auto;
      border-radius: 2px;
    }
  }

  .doc-content {
    .section {
      margin-bottom: 3rem;
      padding: 2rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
      transition: transform 0.3s ease;

      &:hover {
        transform: translateY(-5px);
      }

      .section-title {
        color: #2d3436;
        font-size: 2rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;

        .icon {
          font-size: 1.8rem;
        }
      }

      .concept-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;

        .concept-card {
          background: #f8f9fa;
          padding: 1.5rem;
          border-radius: 8px;
          border-left: 4px solid #6c5ce7;

          .card-header {
            color: #6c5ce7;
            font-weight: 600;
            margin-bottom: 0.8rem;
          }

          .card-content {
            color: #636e72;
          }
        }
      }

      .code-example {
        background: #2d3436;
        border-radius: 8px;
        overflow: hidden;

        .code-block {
          color: #dfe6e9;
          font-family: 'Fira Code', monospace;
          padding: 1.5rem;
          font-size: 0.95rem;
          line-height: 1.6;
          counter-reset: line;
          background-color: #000;

          code {
            color: #fff;
          }

          code::before {
            content: counter(line);
            counter-increment: line;
            margin-right: 1.5rem;
            color: #fff;
          }
        }
      }

      .trap-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;

        .trap-card {
          background: #fff;
          padding: 1.5rem;
          border-radius: 8px;
          border: 1px solid #eee;
          transition: all 0.3s ease;

          &:hover {
            border-color: #6c5ce7;
            box-shadow: 0 4px 12px rgba(108, 92, 231, 0.1);
          }

          h3 {
            color: #6c5ce7;
            margin-bottom: 0.5rem;
          }

          .syntax {
            background: #f8f9fa;
            padding: 0.5rem;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
            margin-top: 1rem;
          }
        }
      }

      .case-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;

        .case-card {
          padding: 1.5rem;
          background: #f8f9fa;
          border-radius: 8px;
          text-align: center;
          transition: transform 0.3s ease;

          &:hover {
            transform: scale(1.05);
          }

          h3 {
            color: #2d3436;
            margin-bottom: 0.5rem;
          }

          p {
            color: #636e72;
          }
        }
      }
    }
  }

  .doc-footer {
    .notice-box {
      background: #fff3e6;
      padding: 2rem;
      border-radius: 8px;
      border-left: 4px solid #ff9f43;

      h3 {
        color: #ff9f43;
        margin-bottom: 1rem;
      }

      ul {
        list-style: none;
        padding-left: 0;

        li {
          padding: 0.5rem 0;
          position: relative;
          padding-left: 2rem;

          &::before {
            content: 'âš ï¸';
            position: absolute;
            left: 0;
          }
        }
      }
    }
  }
}

@media (max-width: 768px) {
  .proxy-doc-container {
    padding: 1rem;
    margin: 1rem;

    .doc-header .title {
      font-size: 2rem;
    }

    .concept-grid,
    .case-container {
      grid-template-columns: 1fr !important;
      gap: 1rem;
    }

    .trap-grid {
      grid-template-columns: 1fr !important;
    }
  }
}

.comparison {
  background: linear-gradient(145deg, #f8f9fa 0%, #ffffff 100%) !important;

  .section-title {
    position: relative;
    padding-bottom: 0.8rem;

    &:after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: #6c5ce7;
      border-radius: 3px;
    }
  }

  .comparison-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .comparison-card {
    background: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;

    &:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    h3 {
      background: #6c5ce7;
      color: white;
      margin: 0;
      padding: 1rem;
      font-size: 1.2rem;
      text-align: center;
    }

    .compare-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      height: 100%;

      @media (max-width: 640px) {
        grid-template-columns: 1fr;
      }

      .proxy-side,
      .define-side {
        padding: 1.5rem;

        h4 {
          margin-top: 0;
          margin-bottom: 1rem;
          font-size: 1.1rem;
          position: relative;
          display: inline-block;
        }
      }

      .proxy-side {
        background: #f0f4ff;
        border-right: 1px solid #e0e0e0;

        @media (max-width: 640px) {
          border-right: none;
          border-bottom: 1px solid #e0e0e0;
        }

        h4 {
          color: #4834d4;

          &:after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 2px;
            background: #4834d4;
          }
        }

        ul li {
          margin-bottom: 0.5rem;
          position: relative;
          padding-left: 1.5rem;

          &:before {
            content: "âœ“";
            color: #4834d4;
            position: absolute;
            left: 0;
            font-weight: bold;
          }
        }
      }

      .define-side {
        background: #fff5f5;

        h4 {
          color: #ff6b6b;

          &:after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 2px;
            background: #ff6b6b;
          }
        }

        ul li {
          margin-bottom: 0.5rem;
          position: relative;
          padding-left: 1.5rem;

          &:before {
            content: "â€¢";
            color: #ff6b6b;
            position: absolute;
            left: 0;
            font-size: 1.5rem;
            line-height: 0.8;
          }
        }
      }

      p {
        margin: 0 0 1rem 0;
        line-height: 1.6;
      }

      ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
    }
  }

  .code-example {
    margin-top: 2.5rem;

    h3 {
      color: #2d3436;
      margin-bottom: 1rem;
      font-size: 1.3rem;
      border-left: 4px solid #6c5ce7;
      padding-left: 1rem;
    }
  }

  @media (max-width: 768px) {
    .comparison-grid {
      grid-template-columns: 1fr;
    }

    .comparison-card {
      .compare-content {
        grid-template-columns: 1fr;

        .proxy-side {
          border-right: none;
          border-bottom: 1px solid #e0e0e0;
        }
      }
    }
  }
}
</style>
