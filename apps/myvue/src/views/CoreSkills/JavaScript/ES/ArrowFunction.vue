<template>
  <div class="page-container">
    <div class="content-wrapper">
      <!-- é¡µé¢å¤´éƒ¨ -->
      <header class="page-header">
        <h1 class="page-title">
          <span class="card-icon">â¡ï¸</span>
          ES6 ç®­å¤´å‡½æ•°ä»‹ç»
        </h1>
        <p class="page-subtitle">ç°ä»£JavaScriptçš„æ ¸å¿ƒç‰¹æ€§ï¼šç®€æ´ã€å¼ºå¤§ä¸”ç‹¬ç‰¹çš„å‡½æ•°è¡¨è¾¾å¼</p>
      </header>

      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <div class="card mb-xl">
        <div class="card-body">
          <div class="grid grid-3">
            <div class="stat-card">
              <div class="stat-value">2015</div>
              <div class="stat-label">ES6å¼•å…¥</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">87%</div>
              <div class="stat-label">é¡¹ç›®ä½¿ç”¨ç‡</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">40%</div>
              <div class="stat-label">ä»£ç ç²¾ç®€</div>
            </div>
          </div>
        </div>
      </div>

      <!-- åŸºæœ¬è¯­æ³• -->
      <div class="card mb-xl">
        <div class="card-header">
          <h2 class="card-title">
            <span class="card-icon">â¡ï¸</span>
            åŸºæœ¬è¯­æ³•
          </h2>
        </div>
        <div class="card-body">
          <div class="grid grid-3">
            <div class="syntax-card">
              <h3 class="text-lg font-semibold mb-md">å•å‚æ•°</h3>
              <div class="code-block">
                <pre><code>// ä¼ ç»Ÿå‡½æ•°
<span class="code-bad">const double = function(n) {
  return n * 2;
}</span>

// ç®­å¤´å‡½æ•°
<span class="code-good">const double = n => n * 2;</span></code></pre>
              </div>
            </div>

            <div class="syntax-card">
              <h3 class="text-lg font-semibold mb-md">å¤šå‚æ•°</h3>
              <div class="code-block">
                <pre><code>// ä¼ ç»Ÿå‡½æ•°
<span class="code-bad">const sum = function(a, b) {
  return a + b;
}</span>

// ç®­å¤´å‡½æ•°
<span class="code-good">const sum = (a, b) => a + b;</span></code></pre>
              </div>
            </div>

            <div class="syntax-card">
              <h3 class="text-lg font-semibold mb-md">å¤šè¡Œè¯­å¥</h3>
              <div class="code-block">
                <pre><code>// ä¼ ç»Ÿå‡½æ•°
<span class="code-bad">const process = function(x) {
  const y = x * 2;
  return y + 10;
}</span>

// ç®­å¤´å‡½æ•°
<span class="code-good">const process = x => {
  const y = x * 2;
  return y + 10;
}</span></code></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- thisç»‘å®š -->
      <div class="card mb-xl">
        <div class="card-header">
          <h2 class="card-title">
            <span class="card-icon">ğŸ”—</span>
            thisç»‘å®šæœºåˆ¶
          </h2>
          <p class="page-subtitle">ç®­å¤´å‡½æ•°æœ€æ ¸å¿ƒçš„ç‰¹æ€§ï¼šè¯æ³•ä½œç”¨åŸŸçš„thisç»‘å®š</p>
        </div>
        <div class="card-body">
          <div class="grid grid-2">
            <div class="explanation-card">
              <h3 class="text-lg font-semibold mb-md">ä¼ ç»Ÿå‡½æ•°çš„thisé—®é¢˜</h3>
              <div class="code-block">
                <pre><code>class Timer {
  constructor() {
    this.seconds = 0;
  }

  start() {
    setInterval(function() {
      <span class="code-bad">// thisä¸å†æŒ‡å‘Timerå®ä¾‹
      this.seconds++; // é”™è¯¯ï¼</span>
    }, 1000);
  }
}</code></pre>
              </div>
              <p class="text-secondary">ä¼ ç»Ÿå‡½æ•°æœ‰è‡ªå·±çš„thisç»‘å®šï¼Œå–å†³äºè°ƒç”¨æ–¹å¼</p>
            </div>

            <div class="explanation-card">
              <h3 class="text-lg font-semibold mb-md">ç®­å¤´å‡½æ•°çš„è§£å†³æ–¹æ¡ˆ</h3>
              <div class="code-block">
                <pre><code>class Timer {
  constructor() {
    this.seconds = 0;
  }

  start() {
    setInterval(<span class="code-good">() => {
      //ç®­å¤´å‡½æ•°çš„thisåœ¨å®šä¹‰æ—¶å·²ç»‘å®šï¼Œæ— æ³•é€šè¿‡call/apply/bindæ”¹å˜
      this.seconds++; // æ­£ç¡®
    }</span>, 1000);
  }
}</code></pre>
              </div>
              <p class="text-secondary">
                ç®­å¤´å‡½æ•°çš„thisï¼Œåœ¨å‡½æ•°å®šä¹‰æ—¶ç»‘å®šï¼Œæ— æ³•é€šè¿‡call/apply/bindè¿è¡Œæ—¶æ”¹å˜
              </p>
            </div>
          </div>

          <div class="binding-diagram mt-xl">
            <div class="grid grid-3">
              <div class="binding-node">
                <div class="node-label">å¤–å±‚ä½œç”¨åŸŸ</div>
                <div class="node-this">this = obj</div>
              </div>

              <div class="binding-arrow">â†“</div>

              <div class="binding-node">
                <div class="node-label">ç®­å¤´å‡½æ•°</div>
                <div class="node-this">this = obj</div>
              </div>

              <div class="binding-arrow">â†“</div>

              <div class="binding-node">
                <div class="node-label">ä¼ ç»Ÿå‡½æ•°</div>
                <div class="node-this">this = è°ƒç”¨è€…</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ä½¿ç”¨åœºæ™¯ -->
      <div class="card mb-xl">
        <div class="card-header">
          <h2 class="card-title">
            <span class="card-icon">ğŸš€</span>
            æœ€ä½³ä½¿ç”¨åœºæ™¯
          </h2>
          <p class="page-subtitle">ç®­å¤´å‡½æ•°åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨</p>
        </div>
        <div class="card-body">
          <div class="grid grid-3">
            <div class="scenario-card">
              <div class="scenario-icon">1</div>
              <h3 class="text-lg font-semibold mb-md">æ•°ç»„æ–¹æ³•å›è°ƒ</h3>
              <div class="code-block">
                <pre><code>const numbers = [1, 2, 3, 4];

// ä½¿ç”¨ç®­å¤´å‡½æ•°
const doubled = numbers.map(<span class="code-good">n => n * 2</span>);

const evens = numbers.filter(<span class="code-good">n => n % 2 === 0</span>);</code></pre>
              </div>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">2</div>
              <h3 class="text-lg font-semibold mb-md">äº‹ä»¶å¤„ç†å‡½æ•°</h3>
              <div class="code-block">
                <pre><code>class Button {
  constructor() {
    this.count = 0;
    this.element = document.createElement('button');

    // ç®­å¤´å‡½æ•°ä¿æŒæ­£ç¡®çš„this
    this.element.addEventListener('click', <span class="code-good">() => {
      this.count++;
      this.updateText();
    }</span>);
  }

  updateText() {
    this.element.textContent = `Clicked ${this.count} times`;
  }
}</code></pre>
              </div>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">3</div>
              <h3 class="text-lg font-semibold mb-md">Promiseé“¾</h3>
              <div class="code-block">
                <pre><code>fetch('/api/data')
  .then(<span class="code-good">response => response.json()</span>)
  .then(<span class="code-good">data => processData(data)</span>)
  .catch(<span class="code-good">error => handleError(error)</span>);</code></pre>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- æ³¨æ„äº‹é¡¹ -->
      <div class="card mb-xl">
        <div class="card-header">
          <h2 class="card-title">
            <span class="card-icon">âš ï¸</span>
            æ³¨æ„äº‹é¡¹
          </h2>
          <p class="page-subtitle">ä½¿ç”¨ç®­å¤´å‡½æ•°æ—¶éœ€ç‰¹åˆ«æ³¨æ„è¿™äº›ç‚¹</p>
        </div>
        <div class="card-body">
          <div class="grid grid-3">
            <div class="warning-card">
              <div class="warning-icon">â—</div>
              <h3 class="text-lg font-semibold mb-md">ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°</h3>
              <div class="code-block">
                <pre><code><span class="code-bad">const Person = (name) => {
  this.name = name; // é”™è¯¯ï¼
}</span>

// å°è¯•å®ä¾‹åŒ–
<span class="code-bad">const john = new Person('John');
// TypeError: Person is not a constructor</span></code></pre>
              </div>
              <p class="text-secondary">ç®­å¤´å‡½æ•°æ²¡æœ‰prototypeå±æ€§ï¼Œä¸èƒ½ä½¿ç”¨newè°ƒç”¨</p>
            </div>

            <div class="warning-card">
              <div class="warning-icon">â—</div>
              <h3 class="text-lg font-semibold mb-md">æ²¡æœ‰argumentså¯¹è±¡</h3>
              <div class="code-block">
                <pre><code><span class="code-bad">const sum = () => {
  console.log(arguments); // é”™è¯¯ï¼
}</span>

// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨restå‚æ•°
<span class="code-good">const sum = (...args) => {
  console.log(args);
}</span></code></pre>
              </div>
              <p class="text-secondary">ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„argumentså¯¹è±¡ï¼Œä½¿ç”¨restå‚æ•°æ›¿ä»£</p>
            </div>

            <div class="warning-card">
              <div class="warning-icon">â—</div>
              <h3 class="text-lg font-semibold mb-md">ä¸èƒ½æ”¹å˜thisç»‘å®š</h3>
              <div class="code-block">
                <pre><code>const obj = {
  value: 42,
  getValue: () => this.value // é”™è¯¯ï¼
};

<span class="code-bad">obj.getValue(); // undefined</span>

// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ä¼ ç»Ÿå‡½æ•°
<span class="code-good">const obj = {
  value: 42,
  getValue() {
    return this.value; // æ­£ç¡®
  }
};</span></code></pre>
              </div>
              <p class="text-secondary">
                ç®­å¤´å‡½æ•°çš„thisåœ¨å®šä¹‰æ—¶å·²ç»‘å®šï¼Œæ— æ³•é€šè¿‡call/apply/bindæ”¹å˜
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- ä¼˜ç¼ºç‚¹ -->
      <div class="card mb-xl">
        <div class="card-header">
          <h2 class="card-title">
            <span class="card-icon">âš–ï¸</span>
            ä¼˜ç‚¹ä¸ç¼ºç‚¹
          </h2>
          <p class="page-subtitle">åˆç†ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå¹³è¡¡ä»£ç ç®€æ´æ€§å’Œå¯è¯»æ€§</p>
        </div>
        <div class="card-body">
          <div class="grid grid-2">
            <div class="pros">
              <h3 class="text-lg font-semibold mb-md">ä¼˜ç‚¹</h3>
              <ul class="feature-list">
                <li><strong>ç®€æ´è¯­æ³•</strong>ï¼šå‡å°‘æ ·æ¿ä»£ç ï¼Œæ›´æ˜“è¯»</li>
                <li><strong>è¯æ³•ä½œç”¨åŸŸ</strong>ï¼šthisç»‘å®šæ›´å¯é¢„æµ‹</li>
                <li><strong>é€‚åˆå›è°ƒ</strong>ï¼šé¿å…thisç»‘å®šé—®é¢˜</li>
                <li><strong>éšå¼è¿”å›</strong>ï¼šå•è¡Œè¡¨è¾¾å¼æ— éœ€return</li>
                <li><strong>å‡½æ•°å¼ç¼–ç¨‹</strong>ï¼šæ›´é€‚åˆçº¯å‡½æ•°</li>
              </ul>
            </div>

            <div class="cons">
              <h3 class="text-lg font-semibold mb-md">ç¼ºç‚¹</h3>
              <ul class="feature-list">
                <li><strong>ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°</strong>ï¼šæ— æ³•ä½¿ç”¨new</li>
                <li><strong>æ²¡æœ‰argumentså¯¹è±¡</strong>ï¼šéœ€ä½¿ç”¨restå‚æ•°</li>
                <li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šåŒ¿åå‡½æ•°æ ˆè¿½è¸ªæ›´å›°éš¾</li>
                <li><strong>ä¸é€‚åˆæ–¹æ³•</strong>ï¼šå¯¹è±¡æ–¹æ³•ä¸­thisè¡Œä¸ºå¼‚å¸¸</li>
                <li><strong>å¯è¯»æ€§é™ä½</strong>ï¼šè¿‡åº¦ä½¿ç”¨å¯èƒ½é™ä½ä»£ç æ¸…æ™°åº¦</li>
              </ul>
            </div>
          </div>

          <div class="recommendation mt-xl">
            <h3 class="text-lg font-semibold mb-md">ä½¿ç”¨å»ºè®®</h3>
            <div class="grid grid-3">
              <div class="rec-card rec-good">
                <div class="rec-icon">âœ“</div>
                <p>å›è°ƒå‡½æ•°ï¼ˆæ•°ç»„æ–¹æ³•ã€äº‹ä»¶å¤„ç†ã€å®šæ—¶å™¨ï¼‰</p>
              </div>
              <div class="rec-card rec-good">
                <div class="rec-icon">âœ“</div>
                <p>å‡½æ•°å¼ç¼–ç¨‹ï¼ˆçº¯å‡½æ•°ã€æ— çŠ¶æ€æ“ä½œï¼‰</p>
              </div>
              <div class="rec-card rec-bad">
                <div class="rec-icon">âœ—</div>
                <p>å¯¹è±¡æ–¹æ³•ï¼ˆéœ€è¦è®¿é—®å®ä¾‹å±æ€§æ—¶ï¼‰</p>
              </div>
              <div class="rec-card rec-bad">
                <div class="rec-icon">âœ—</div>
                <p>éœ€è¦åŠ¨æ€thisç»‘å®šçš„åœºæ™¯</p>
              </div>
              <div class="rec-card rec-good">
                <div class="rec-icon">âœ“</div>
                <p>é¡¶å±‚å‡½æ•°ï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼‰</p>
              </div>
              <div class="rec-card rec-bad">
                <div class="rec-icon">âœ—</div>
                <p>æ„é€ å‡½æ•°æˆ–åŸå‹æ–¹æ³•</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- é¡µè„š -->
      <div class="card">
        <div class="card-body">
          <p class="text-center text-secondary">ES6 ç‰¹æ€§ä»‹ç» | ç®­å¤´å‡½æ•° | Vue 3 æŠ€æœ¯æ¼”ç¤º</p>
          <p class="text-center text-secondary">
            ç†è§£ç®­å¤´å‡½æ•°çš„ç‰¹æ€§ï¼Œç¼–å†™æ›´ç®€æ´ã€å¯ç»´æŠ¤çš„JavaScriptä»£ç 
          </p>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import '@/assets/css/unified-styles.css'

// ç¤ºä¾‹å“åº”å¼æ•°æ®
const activeSection = ref('syntax')
</script>

<style scoped>
/* ç»„ä»¶ç‰¹å®šæ ·å¼ */
.stat-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  text-align: center;
  border: 1px solid var(--border-light);
  transition: transform 0.3s ease;
}

.stat-card:hover {
  transform: translateY(-5px);
}

.stat-value {
  font-size: 2.2rem;
  font-weight: 700;
  color: var(--primary-color);
  margin-bottom: var(--spacing-sm);
}

.stat-label {
  font-size: 0.9rem;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.syntax-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  border: 1px solid var(--border-light);
}

.explanation-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  border: 1px solid var(--border-light);
}

.binding-diagram {
  text-align: center;
}

.binding-node {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  border: 2px solid var(--border-light);
  text-align: center;
}

.node-label {
  font-weight: 600;
  color: var(--primary-color);
  margin-bottom: var(--spacing-sm);
}

.node-this {
  background: var(--primary-bg);
  padding: var(--spacing-sm);
  border-radius: var(--radius-md);
  font-family: var(--font-mono);
}

.binding-arrow {
  font-size: 2rem;
  color: var(--primary-color);
  display: flex;
  align-items: center;
  justify-content: center;
}

.scenario-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  border: 1px solid var(--border-light);
}

.scenario-icon {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--primary-bg);
  border-radius: 50%;
  margin-bottom: var(--spacing-md);
  font-weight: 700;
  color: var(--primary-color);
}

.warning-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  border: 1px solid var(--border-light);
}

.warning-icon {
  font-size: 1.8rem;
  color: var(--error-color);
  margin-bottom: var(--spacing-sm);
}

.feature-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.feature-list li {
  padding: var(--spacing-sm) 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text-secondary);
}

.feature-list li:last-child {
  border-bottom: none;
}

.pros .feature-list li {
  color: var(--success-color);
}

.cons .feature-list li {
  color: var(--error-color);
}

.rec-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--spacing-md);
  display: flex;
  align-items: center;
  border: 1px solid var(--border-light);
}

.rec-icon {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-md);
  margin-right: var(--spacing-md);
  font-weight: bold;
  font-size: 1.2rem;
  flex-shrink: 0;
}

.rec-good .rec-icon {
  background: var(--success-bg);
  color: var(--success-color);
}

.rec-bad .rec-icon {
  background: var(--error-bg);
  color: var(--error-color);
}

.rec-card p {
  color: var(--text-secondary);
  line-height: var(--leading-relaxed);
  margin: 0;
}

.code-good {
  color: var(--success-color);
}

.code-bad {
  color: var(--error-color);
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
  .grid-2,
  .grid-3 {
    grid-template-columns: 1fr;
  }

  .binding-diagram .grid-3 {
    grid-template-columns: 1fr;
  }

  .binding-arrow {
    transform: rotate(90deg);
    margin: var(--spacing-md) 0;
  }
}
</style>
