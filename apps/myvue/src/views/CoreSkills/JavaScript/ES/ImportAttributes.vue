<template>
  <div class="import-attributes-guide">
    <header class="guide-header">
      <h1 class="title">ES Import Attributes å®Œå…¨è§£æ</h1>
      <p class="subtitle">æ–°ä¸€ä»£æ¨¡å—å¯¼å…¥çš„å…ƒæ•°æ®æ§åˆ¶æ–¹æ¡ˆ</p>
    </header>

    <div class="content-grid">
      <!-- åŸºç¡€ä»‹ç» -->
      <section class="intro-section">
        <h2 class="section-title">ğŸ” ä»€ä¹ˆæ˜¯ Import Attributesï¼Ÿ</h2>
        <div class="intro-card">
          <p>
            Import Attributes æ˜¯ ECMAScript ææ¡ˆï¼ˆç°å·²è¿›å…¥ Stage
            3ï¼‰ä¸­çš„æ–°ç‰¹æ€§ï¼Œå…è®¸å¼€å‘è€…åœ¨å¯¼å…¥æ¨¡å—æ—¶é™„åŠ å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¸ºæ¨¡å—ç³»ç»Ÿæä¾›æ›´ç²¾ç»†çš„æ§åˆ¶èƒ½åŠ›ã€‚
          </p>
          <div class="feature-highlight">
            <div class="feature-item">
              <div class="icon">ğŸ†•</div>
              <p>ES2023+ æ–°ç‰¹æ€§</p>
            </div>
            <div class="feature-item">
              <div class="icon">ğŸ§©</div>
              <p>æ¨¡å—å¯¼å…¥çš„å…ƒæ•°æ®æ§åˆ¶</p>
            </div>
            <div class="feature-item">
              <div class="icon">âš¡</div>
              <p>æ›¿ä»£å·²åºŸå¼ƒçš„ import assertions</p>
            </div>
          </div>
        </div>
      </section>

      <!-- åŸºç¡€ç”¨æ³• -->
      <section class="usage-section">
        <h2 class="section-title">ğŸ› ï¸ åŸºç¡€ç”¨æ³•</h2>
        <div class="code-example">
          <h3>JSON å¯¼å…¥</h3>
          <pre class="code-block"><code>import jsonData from "./data.json" with { type: "json" };

console.log(jsonData.message); // ç›´æ¥ä½¿ç”¨è§£æåçš„JSONå¯¹è±¡</code></pre>
          <p class="usage-scenario"><b>ä½¿ç”¨åœºæ™¯ï¼š</b>å®‰å…¨å¯¼å…¥JSONæ–‡ä»¶ï¼Œé¿å…ç›´æ¥evalçš„é£é™©</p>
        </div>

        <div class="code-example">
          <h3>WebAssembly å¯¼å…¥</h3>
          <pre
            class="code-block"
          ><code>import wasmModule from "./module.wasm" with { type: "webassembly" };

const instance = await WebAssembly.instantiate(wasmModule);</code></pre>
          <p class="usage-scenario"><b>ä½¿ç”¨åœºæ™¯ï¼š</b>ç±»å‹å®‰å…¨çš„WASMæ¨¡å—å¯¼å…¥</p>
        </div>
      </section>

      <!-- é«˜çº§ç”¨æ³• -->
      <section class="advanced-section">
        <h2 class="section-title">ğŸš€ é«˜çº§ç”¨æ³•</h2>
        <div class="code-example">
          <h3>è‡ªå®šä¹‰æ¨¡å—ç±»å‹</h3>
          <pre class="code-block"><code>// é…ç½®viteç­‰æ‰“åŒ…å·¥å…·æ”¯æŒè‡ªå®šä¹‰ç±»å‹
import shaderSource from "./shader.glsl" with { type: "text" };

// åœ¨WebGLä¸­ä½¿ç”¨
gl.shaderSource(shader, shaderSource);</code></pre>
          <p class="usage-scenario"><b>ä½¿ç”¨åœºæ™¯ï¼š</b>éæ ‡å‡†èµ„æºå¯¼å…¥ï¼ˆGLSLã€CSVç­‰ï¼‰</p>
        </div>

        <div class="code-example">
          <h3>æ¡ä»¶æ€§å¯¼å…¥</h3>
          <pre class="code-block"><code>// æ ¹æ®ç¯å¢ƒå˜é‡é€‰æ‹©å¯¼å…¥æ–¹å¼
const config = import.meta.env.PROD
  ? await import("./config.prod.json", { with: { type: "json" } })
  : await import("./config.dev.json", { with: { type: "json" } });</code></pre>
          <p class="usage-scenario"><b>ä½¿ç”¨åœºæ™¯ï¼š</b>ç¯å¢ƒç‰¹å®šçš„é…ç½®åŠ è½½</p>
        </div>
      </section>

      <!-- ä¸ç°æœ‰æ–¹æ¡ˆå¯¹æ¯” -->
      <section class="comparison-section">
        <h2 class="section-title">âš–ï¸ ä¸ä¼ ç»Ÿæ–¹æ¡ˆå¯¹æ¯”</h2>
        <div class="comparison-grid">
          <div class="comparison-card old">
            <h3>ä¼ ç»Ÿæ–¹å¼</h3>
            <pre class="code-block"><code>// åŠ¨æ€å¯¼å…¥JSON
const data = await fetch('/data.json')
  .then(res => res.json());

// Webpack loaderè¯­æ³•
import json from 'json-loader!./file.json';</code></pre>
            <ul class="drawbacks">
              <li>éœ€è¦é¢å¤–è¯·æ±‚</li>
              <li>ä¾èµ–æ„å»ºå·¥å…·</li>
              <li>ç±»å‹ä¸å®‰å…¨</li>
            </ul>
          </div>
          <div class="comparison-card new">
            <h3>Import Attributes</h3>
            <pre class="code-block"><code>// é™æ€å¯¼å…¥
import data from './data.json'
  with { type: 'json' };

// åŠ¨æ€å¯¼å…¥
const mod = await import('./mod.wasm',
  { with: { type: 'webassembly' } });</code></pre>
            <ul class="benefits">
              <li>åŸç”Ÿæµè§ˆå™¨æ”¯æŒ</li>
              <li>ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥</li>
              <li>æ ‡å‡†åŒ–è¯­æ³•</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- é…ç½®ä¸æ”¯æŒ -->
      <section class="config-section">
        <h2 class="section-title">âš™ï¸ ç¯å¢ƒé…ç½®</h2>
        <div class="config-grid">
          <div class="config-card">
            <h3>TypeScript é…ç½®</h3>
            <pre class="code-block"><code>// tsconfig.json
{
  "compilerOptions": {
    "module": "esnext",
    "moduleResolution": "bundler",
    "types": ["vite/client"] // å¯¹äºViteç¯å¢ƒ
  }
}</code></pre>
          </div>
          <div class="config-card">
            <h3>Vite é…ç½®</h3>
            <pre class="code-block"><code>// vite.config.ts
export default defineConfig({
  esbuild: {
    supported: {
      'import-attributes': true // å¯ç”¨æ”¯æŒ
    }
  }
})</code></pre>
          </div>
        </div>
      </section>
    </div>
  </div>
</template>

<script setup lang="ts">
// ç¤ºä¾‹åŠ¨æ€å¯¼å…¥
// async function loadConfig() {
//   return await import("../config.json", {
//     with: { type: "json" }
//   });
// }
</script>

<style lang="less" scoped>
.import-attributes-guide {
  max-width: 1000px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Inter', system-ui, sans-serif;
  color: #2d3748;
  line-height: 1.6;
}

.guide-header {
  text-align: center;
  margin-bottom: 3rem;

  .title {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    color: #2d3748;
    font-weight: 800;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .subtitle {
    font-size: 1.2rem;
    color: #64748b;
    font-weight: 400;
  }
}

.section-title {
  font-size: 1.8rem;
  color: #2d3748;
  margin-top: 0;
  margin-bottom: 1.5rem;
  position: relative;
  padding-bottom: 0.5rem;

  &::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
  }
}

.content-grid {
  display: grid;
  gap: 2rem;
}

.intro-card {
  background: white;
  border-radius: 0.75rem;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);

  p {
    font-size: 1.1rem;
    color: #475569;
    margin-top: 0;
  }
}

.feature-highlight {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin-top: 1.5rem;
}

.feature-item {
  background: #f8fafc;
  border-radius: 0.5rem;
  padding: 1rem;
  display: flex;
  align-items: center;
  gap: 0.8rem;

  .icon {
    font-size: 1.5rem;
  }

  p {
    margin: 0;
    font-weight: 500;
    color: #334155;
  }
}

.code-example {
  background: white;
  border-radius: 0.5rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);

  h3 {
    margin-top: 0;
    color: #1e40af;
    font-size: 1.2rem;
  }
}

.usage-scenario {
  margin: 0.8rem 0 0;
  font-size: 0.9rem;
  color: #64748b;

  b {
    color: #475569;
  }
}

.code-block {
  background: #1e293b;
  border-radius: 0.375rem;
  padding: 1rem;
  overflow-x: auto;

  code {
    font-family: 'Fira Code', monospace;
    font-size: 0.85rem;
    color: #f8fafc;
    line-height: 1.5;
    white-space: pre;
  }
}

.comparison-section {
  margin: 2rem 0;
}

.comparison-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

.comparison-card {
  background: white;
  border-radius: 0.75rem;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);

  h3 {
    margin-top: 0;
    color: #1e40af;
    font-size: 1.3rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e2e8f0;
  }

  pre {
    margin: 1rem 0;
  }
}

.old {
  border-top: 4px solid #f87171;

  .drawbacks {
    color: #b91c1c;
    padding-left: 1.2rem;

    li {
      margin-bottom: 0.5rem;
      position: relative;

      &::before {
        content: 'Ã—';
        color: #ef4444;
        font-weight: bold;
        display: inline-block;
        width: 1em;
        margin-left: -1em;
      }
    }
  }
}

.new {
  border-top: 4px solid #4ade80;

  .benefits {
    color: #166534;
    padding-left: 1.2rem;

    li {
      margin-bottom: 0.5rem;
      position: relative;

      &::before {
        content: 'âœ“';
        color: #22c55e;
        font-weight: bold;
        display: inline-block;
        width: 1em;
        margin-left: -1em;
      }
    }
  }
}

.config-section {
  margin-top: 2rem;
}

.config-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

.config-card {
  background: white;
  border-radius: 0.5rem;
  padding: 1.5rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);

  h3 {
    margin-top: 0;
    color: #1e40af;
    font-size: 1.2rem;
  }

  pre {
    margin: 0;
  }
}
</style>
