<template>
  <div class="math-docs-container">
    <h1 class="title">ğŸ“ JavaScript Math å¯¹è±¡æ–‡æ¡£</h1>

    <!-- æ¦‚è¿°éƒ¨åˆ† -->
    <section class="overview-card">
      <h2 class="section-title">ğŸ” æ¦‚è¿°</h2>
      <p class="content">
        Math æ˜¯ JavaScript å†…ç½®çš„æ•°å­¦å¯¹è±¡ï¼Œæä¾›åŸºç¡€æ•°å­¦å‡½æ•°å’Œå¸¸é‡çš„è®¿é—®ã€‚ES6+
        æ–°å¢äº†å¤šä¸ªå®ç”¨æ–¹æ³•ï¼Œå¢å¼ºäº†æ•°å­¦è®¡ç®—èƒ½åŠ›ã€‚
      </p>
    </section>

    <!-- åŸºç¡€å±æ€§ -->
    <section class="properties-card">
      <h3>ğŸ”¢ å¸¸ç”¨å±æ€§</h3>
      <div class="grid-container">
        <div v-for="(desc, key) in mathConstants" :key="key" class="property-item">
          <span class="constant-name">Math.{{ key }}</span>
          <span class="constant-value">{{ desc.value.toFixed(5) }}</span>
          <p class="constant-desc">{{ desc.description }}</p>
        </div>
      </div>
    </section>

    <!-- ä¼ ç»Ÿæ–¹æ³• -->
    <section class="methods-card">
      <h3>ğŸ› ï¸ ä¼ ç»Ÿå¸¸ç”¨æ–¹æ³•</h3>
      <div class="method-grid">
        <div v-for="method in basicMethods" :key="method.name" class="method-item">
          <div class="method-header">
            <span class="method-name">Math.{{ method.name }}({{ method.args }})</span>
            <span class="method-example">{{ method.example }}</span>
          </div>
          <p class="method-desc">{{ method.description }}</p>
        </div>
      </div>
    </section>

    <!-- ES6+ æ–°å¢æ–¹æ³• -->
    <section class="es6-methods-card">
      <h3>ğŸš€ ES6+ æ–°å¢æ–¹æ³•</h3>
      <div class="es6-grid">
        <div v-for="method in es6Methods" :key="method.name" class="es6-item">
          <div class="method-title">
            <span class="icon">âœ¨</span>
            Math.{{ method.name }}()
          </div>
          <div class="method-detail">
            <p>{{ method.description }}</p>
            <pre><code>{{ method.examples.join('\n') }}</code></pre>
          </div>
        </div>
      </div>
    </section>

    <!-- Math.random() åº•å±‚å®ç°æœºåˆ¶ -->
    <section class="random-mechanism-card">
      <h3>ğŸ² Math.random() åº•å±‚å®ç°æœºåˆ¶</h3>
      <div class="mechanism-content">
        <div class="mechanism-overview">
          <h4>ğŸ”§ å®ç°åŸç†</h4>
          <p>Math.random() ä½¿ç”¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨(PRNG)ç®—æ³•ï¼Œé€šå¸¸åŸºäºçº¿æ€§åŒä½™æ³•(LCG)å®ç°ã€‚</p>
        </div>

        <div class="algorithm-details">
          <h4>ğŸ“Š çº¿æ€§åŒä½™æ³•å…¬å¼</h4>
          <div class="formula-box">
            <code>X<sub>n+1</sub> = (a Ã— X<sub>n</sub> + c) mod m</code>
          </div>
          <div class="parameter-list">
            <div class="parameter-item">
              <span class="param-name">a (ä¹˜æ•°):</span>
              <span class="param-value">é€šå¸¸é€‰æ‹©è¾ƒå¤§çš„è´¨æ•°</span>
            </div>
            <div class="parameter-item">
              <span class="param-name">c (å¢é‡):</span>
              <span class="param-value">é€šå¸¸ä¸ºå¥‡æ•°</span>
            </div>
            <div class="param-item">
              <span class="param-name">m (æ¨¡æ•°):</span>
              <span class="param-value">2<sup>32</sup> æˆ– 2<sup>64</sup></span>
            </div>
            <div class="parameter-item">
              <span class="param-name">X<sub>0</sub> (ç§å­):</span>
              <span class="param-value">åˆå§‹å€¼ï¼Œé€šå¸¸åŸºäºæ—¶é—´æˆ³</span>
            </div>
          </div>
        </div>

        <div class="implementation-steps">
          <h4>âš™ï¸ å®ç°æ­¥éª¤</h4>
          <div class="step-list">
            <div class="step-item">
              <span class="step-number">1</span>
              <div class="step-content">
                <strong>ç§å­åˆå§‹åŒ–</strong>
                <p>ä½¿ç”¨å½“å‰æ—¶é—´æˆ³ã€è¿›ç¨‹IDç­‰ä½œä¸ºåˆå§‹ç§å­å€¼</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-number">2</span>
              <div class="step-content">
                <strong>çº¿æ€§å˜æ¢</strong>
                <p>åº”ç”¨çº¿æ€§åŒä½™å…¬å¼ç”Ÿæˆä¸‹ä¸€ä¸ªéšæœºæ•°</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-number">3</span>
              <div class="step-content">
                <strong>å½’ä¸€åŒ–å¤„ç†</strong>
                <p>å°†ç”Ÿæˆçš„æ•´æ•°é™¤ä»¥æ¨¡æ•°ï¼Œå¾—åˆ°[0,1)åŒºé—´çš„å°æ•°</p>
              </div>
            </div>
            <div class="step-item">
              <span class="step-number">4</span>
              <div class="step-content">
                <strong>ç²¾åº¦æ§åˆ¶</strong>
                <p>æ§åˆ¶è¾“å‡ºç²¾åº¦ï¼Œé€šå¸¸ä¸º53ä½æµ®ç‚¹æ•°</p>
              </div>
            </div>
          </div>
        </div>

        <div class="browser-implementations">
          <h4>ğŸŒ ä¸åŒæµè§ˆå™¨çš„å®ç°</h4>
          <div class="browser-grid">
            <div class="browser-item">
              <div class="browser-header">
                <span class="browser-icon">ğŸ¦Š</span>
                <span class="browser-name">Firefox</span>
              </div>
              <p>ä½¿ç”¨ xorshift ç®—æ³•ï¼Œå‘¨æœŸä¸º 2<sup>128</sup>-1</p>
            </div>
            <div class="browser-item">
              <div class="browser-header">
                <span class="browser-icon">ğŸŒ</span>
                <span class="browser-name">Chrome</span>
              </div>
              <p>ä½¿ç”¨ xorshift128+ ç®—æ³•ï¼Œæ€§èƒ½æ›´ä¼˜</p>
            </div>
            <div class="browser-item">
              <div class="browser-header">
                <span class="browser-icon">ğŸ¦</span>
                <span class="browser-name">Safari</span>
              </div>
              <p>åŸºäº arc4random ç®—æ³•ï¼Œå®‰å…¨æ€§æ›´é«˜</p>
            </div>
            <div class="browser-item">
              <div class="browser-header">
                <span class="browser-icon">âš¡</span>
                <span class="browser-name">Edge</span>
              </div>
              <p>ä½¿ç”¨ä¸Chromeç›¸åŒçš„ xorshift128+ ç®—æ³•</p>
            </div>
          </div>
        </div>

        <div class="security-considerations">
          <h4>ğŸ”’ å®‰å…¨æ€§è€ƒè™‘</h4>
          <div class="security-list">
            <div class="security-item warning">
              <span class="security-icon">âš ï¸</span>
              <div class="security-content">
                <strong>ä¸å¯ç”¨äºåŠ å¯†</strong>
                <p>Math.random() æ˜¯ä¼ªéšæœºæ•°ï¼Œå¯é¢„æµ‹ï¼Œä¸é€‚åˆå¯†ç å­¦åº”ç”¨</p>
              </div>
            </div>
            <div class="security-item info">
              <span class="security-icon">â„¹ï¸</span>
              <div class="security-content">
                <strong>é€‚åˆä¸€èˆ¬ç”¨é€”</strong>
                <p>æ¸¸æˆã€åŠ¨ç”»ã€æµ‹è¯•ç­‰åœºæ™¯ä½¿ç”¨å®Œå…¨å®‰å…¨</p>
              </div>
            </div>
            <div class="security-item success">
              <span class="security-icon">âœ…</span>
              <div class="security-content">
                <strong>åŠ å¯†éœ€æ±‚ä½¿ç”¨</strong>
                <p>crypto.getRandomValues() æä¾›çœŸéšæœºæ•°</p>
              </div>
            </div>
          </div>
        </div>

        <div class="code-example">
          <h4>ğŸ’» æ¨¡æ‹Ÿå®ç°ç¤ºä¾‹</h4>
          <pre><code>class SimpleRandom {
  constructor(seed = Date.now()) {
    this.seed = seed;
  }

  // ç®€å•çš„çº¿æ€§åŒä½™æ³•å®ç°
  next() {
    this.seed = (this.seed * 1664525 + 1013904223) % Math.pow(2, 32);
    return this.seed / Math.pow(2, 32);
  }

  // ç”ŸæˆæŒ‡å®šèŒƒå›´çš„éšæœºæ•°
  random(min = 0, max = 1) {
    return min + (max - min) * this.next();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const random = new SimpleRandom();
console.log(random.random()); // [0, 1)
console.log(random.random(1, 10)); // [1, 10)</code></pre>
        </div>
      </div>
    </section>



    <!-- æ³¨æ„äº‹é¡¹ -->
    <section class="notice-card">
      <h3>âš ï¸ æ³¨æ„äº‹é¡¹</h3>
      <ul>
        <li>æµ®ç‚¹æ•°è®¡ç®—å­˜åœ¨ç²¾åº¦é—®é¢˜ï¼Œéœ€æ³¨æ„èˆå…¥è¯¯å·®</li>
        <li>å‚æ•°ç±»å‹ä¸ç¬¦åˆè¦æ±‚æ—¶è¿”å›NaN</li>
        <li>ES6æ–°å¢æ–¹æ³•éœ€è€ƒè™‘æµè§ˆå™¨å…¼å®¹æ€§</li>
      </ul>
    </section>
  </div>
</template>

<script lang="ts">
import { defineComponent, reactive } from 'vue'

export default defineComponent({
  name: 'MathDocumentation',
  setup() {
    const mathConstants = reactive({
      PI: {
        value: Math.PI,
        description: 'åœ†å‘¨ç‡å¸¸æ•°',
      },
      E: {
        value: Math.E,
        description: 'è‡ªç„¶å¯¹æ•°çš„åº•æ•°',
      },
      LN2: {
        value: Math.LN2,
        description: '2çš„è‡ªç„¶å¯¹æ•°',
      },
    })

    const basicMethods = reactive([
      {
        name: 'sqrt',
        args: 'x',
        example: 'Math.sqrt(9) â†’ 3',
        description: 'è®¡ç®—å¹³æ–¹æ ¹',
      },
      {
        name: 'pow',
        args: 'x, y',
        example: 'Math.pow(2, 3) â†’ 8',
        description: `è®¡ç®—xçš„yæ¬¡å¹‚
æ–°å†™æ³• 2**3 â†’ 8`,
      },
      {
        name: 'abs',
        args: 'x',
        example: 'Math.abs(-5) â†’ 5',
        description: 'è¿”å›ç»å¯¹å€¼',
      },
      {
        name: 'ceil',
        args: 'x',
        example: 'Math.ceil(4.1) â†’ 5',
        description: 'å‘ä¸Šå–æ•´',
      },
      {
        name: 'floor',
        args: 'x',
        example: 'Math.floor(4.9) â†’ 4',
        description: 'å‘ä¸‹å–æ•´',
      },
      {
        name: 'random',
        args: '',
        example: 'Math.random() â†’ 0~1',
        description: 'ç”Ÿæˆ[0,1)éšæœºæ•°',
      },
      {
        name: 'max',
        args: '...values',
        example: 'Math.max(1, 2, 3) â†’ 3',
        description: 'è¿”å›æœ€å¤§å€¼',
      },
      {
        name: 'min',
        args: '...values',
        example: 'Math.min(1, 2, 3) â†’ 1',
        description: 'è¿”å›æœ€å°å€¼',
      },
      {
        name: 'round',
        args: 'x',
        example: 'Math.round(4.5) â†’ 5',
        description: 'å››èˆäº”å…¥',
      },
      {
        name: 'sin',
        args: 'x',
        example: 'Math.sin(Math.PI / 2) â†’ 1',
        description: 'è®¡ç®—æ­£å¼¦',
      },
      {
        name: 'cos',
        args: 'x',
        example: 'Math.cos(0) â†’ 1',
        description: 'è®¡ç®—ä½™å¼¦',
      },
      {
        name: 'tan',
        args: 'x',
        example: 'Math.tan(Math.PI / 4) â†’ 1',
        description: 'è®¡ç®—æ­£åˆ‡',
      },
      {
        name: 'log',
        args: 'x',
        example: 'Math.log(Math.E) â†’ 1',
        description: 'è®¡ç®—è‡ªç„¶å¯¹æ•°',
      },
      {
        name: 'exp',
        args: 'x',
        example: 'Math.exp(1) â†’ 2.71828',
        description: 'è®¡ç®—eçš„xæ¬¡å¹‚',
      },
      {
        name: 'sqrt',
        args: 'x',
        example: 'Math.sqrt(16) â†’ 4',
        description: 'è®¡ç®—å¹³æ–¹æ ¹',
      },
      {
        name: 'cbrt',
        args: 'x',
        example: 'Math.cbrt(27) â†’ 3',
        description: 'è®¡ç®—ç«‹æ–¹æ ¹',
      },
      {
        name: 'hypot',
        args: '...values',
        example: 'Math.hypot(3, 4) â†’ 5',
        description: 'è®¡ç®—å‚æ•°å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹',
      },
    ])

    const es6Methods = reactive([
      {
        name: 'trunc',
        description: 'å»é™¤å°æ•°éƒ¨åˆ†ï¼Œä¿ç•™æ•´æ•°',
        examples: ['Math.trunc(4.9)    // 4', 'Math.trunc(-4.1)   // -4'],
      },
      {
        name: 'sign',
        description: 'åˆ¤æ–­æ•°å€¼ç¬¦å·',
        examples: ['Math.sign(5)      // 1', 'Math.sign(-5)     // -1', 'Math.sign(0)      // 0'],
      },
      {
        name: 'cbrt',
        description: 'è®¡ç®—ç«‹æ–¹æ ¹',
        examples: ['Math.cbrt(27)     // 3', 'Math.cbrt(64)     // 4'],
      },
      {
        name: 'hypot',
        description: 'è®¡ç®—å‚æ•°å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹',
        examples: ['Math.hypot(3,4)   // 5', 'Math.hypot(5,12)  // 13'],
      },
    ])

    return { mathConstants, basicMethods, es6Methods }
  },
})
</script>

<style scoped>
.math-docs-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 1.5rem;
  font-family: 'Segoe UI', system-ui;
}

.title {
  text-align: center;
  color: #2c3e50;
  margin-bottom: 2rem;
}

/* å¡ç‰‡é€šç”¨æ ·å¼ */
.overview-card,
.properties-card,
.methods-card,
.es6-methods-card,
.random-mechanism-card,
.notice-card {
  background: #ffffff;
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.grid-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
}

.property-item {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 8px;
  transition: transform 0.2s;
}

.property-item:hover {
  transform: translateY(-2px);
}

.constant-name {
  font-weight: 600;
  color: #34495e;
}

.constant-value {
  float: right;
  color: #3498db;
}

.method-grid {
  display: grid;
  gap: 1rem;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

.method-item {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 8px;
}

.es6-grid {
  display: grid;
  gap: 1.5rem;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
}

.es6-item {
  background: #f4f5f7;
  border-left: 4px solid #3498db;
  padding: 1rem;
  border-radius: 6px;
}

pre {
  background: #282c34;
  padding: 1rem;
  border-radius: 6px;
  overflow-x: auto;
  margin: 1rem 0;
}

code {
  font-family: 'Fira Code', monospace;
  color: #abb2bf;
  font-size: 0.9em;
}

.notice-card {
  background: #fff3cd;
  border-color: #ffeeba;
  color: #856404;
}

.method-title {
  font-size: 1.1em;
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 0.5rem;
}

.icon {
  margin-right: 0.5rem;
}

/* Math.random() æœºåˆ¶æ ·å¼ */
.random-mechanism-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.mechanism-content {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.mechanism-overview h4,
.algorithm-details h4,
.implementation-steps h4,
.browser-implementations h4,
.security-considerations h4,
.code-example h4 {
  color: #000;
  margin-bottom: 1rem;
  font-size: 1.2em;
  border-bottom: 2px solid rgba(255, 255, 255, 0.3);
  padding-bottom: 0.5rem;
}

.formula-box {
  background: rgba(255, 255, 255, 0.1);
  padding: 1.5rem;
  border-radius: 8px;
  text-align: center;
  margin: 1rem 0;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.formula-box code {
  font-size: 1.3em;
  color: #000;
  font-weight: 600;
}

.parameter-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.parameter-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 1rem;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.param-name {
  font-weight: 600;
  color: #ffd700;
  display: block;
  margin-bottom: 0.5rem;
}

.param-value {
  color: #ffffff;
  font-size: 0.9em;
}

.step-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.step-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  background: rgba(255, 255, 255, 0.1);
  padding: 1rem;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.step-number {
  background: #ffd700;
  color: #333;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  flex-shrink: 0;
}

.step-content strong {
  color: #ffd700;
  display: block;
  margin-bottom: 0.5rem;
}

.step-content p {
  color: #ffffff;
  margin: 0;
  font-size: 0.9em;
}

.browser-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.browser-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 1rem;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  text-align: center;
}

.browser-header {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.browser-icon {
  font-size: 1.5em;
}

.browser-name {
  font-weight: 600;
  color: #ffd700;
}

.browser-item p {
  color: #ffffff;
  font-size: 0.9em;
  margin: 0;
}

.security-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.security-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 1rem;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.security-item.warning {
  background: rgba(255, 193, 7, 0.2);
  border-color: rgba(255, 193, 7, 0.4);
}

.security-item.info {
  background: rgba(23, 162, 184, 0.2);
  border-color: rgba(23, 162, 184, 0.4);
}

.security-item.success {
  background: rgba(40, 167, 69, 0.2);
  border-color: rgba(40, 167, 69, 0.4);
}

.security-icon {
  font-size: 1.2em;
  flex-shrink: 0;
}

.security-content strong {
  color: #ffd700;
  display: block;
  margin-bottom: 0.5rem;
}

.security-content p {
  color: #ffffff;
  margin: 0;
  font-size: 0.9em;
}

.code-example pre {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.code-example code {
  color: #ffffff;
}
</style>
