<template>
  <div class="reflect-docs">
    <header class="docs-header">
      <h1>JavaScript Reflect åŸºæœ¬æŒ‡å—</h1>
    </header>
    <Nav class="toc" :list="sections" />

    <div class="content-wrapper">
      <!-- åŸºç¡€ä»‹ç» -->
      <section id="overview" class="method-card">
        <h2>ğŸ” Reflect æ¦‚è¿°</h2>
        <div class="info-box">
          <p>Reflectå¯¹è±¡ä¸Proxyå¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° APIã€‚Reflectå¯¹è±¡çš„è®¾è®¡ç›®çš„æœ‰è¿™æ ·å‡ ä¸ª</p>
          <ol>
            <li>
              å°†Objectå¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚Object.definePropertyï¼‰ï¼Œæ”¾åˆ°Reflectå¯¹è±¡ä¸Šã€‚ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨Objectå’ŒReflectå¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨Reflectå¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»Reflectå¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•
            </li>
            <li>ä¿®æ”¹æŸäº›Objectæ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚æ¯”å¦‚ï¼ŒObject.defineProperty(obj, name,
              desc)åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€ŒReflect.defineProperty(obj, name, desc)åˆ™ä¼šè¿”å›false</li>
          </ol>
        </div>
      </section>

      <!-- æ ¸å¿ƒæ–¹æ³• -->
      <section id="methods" class="method-card">
        <h2>ğŸ¯ æ ¸å¿ƒæ–¹æ³•</h2>

        <div class="method-item">
          <h3>1. Reflect.get(target, propertyKey[, receiver])</h3>
          <CodeBlock :code="reflectGetExample" language="js" />
          <div class="use-case">
            <h4>ä½¿ç”¨åœºæ™¯</h4>
            <ul>
              <li>æ›¿ä»£ <code>target[property]</code> çš„è¯»å–æ“ä½œ</li>
              <li>éœ€è¦å¤„ç†è®¿é—®å™¨ä¸Šä¸‹æ–‡æ—¶</li>
            </ul>
          </div>
        </div>

        <div class="method-item">
          <h3>2. Reflect.set(target, propertyKey, value[, receiver])</h3>
          <CodeBlock :code="reflectSetExample" language="js" />
          <div class="use-case warning">
            <h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
            <p>ä¸ç›´æ¥èµ‹å€¼ä¸åŒï¼Œè¿”å›å¸ƒå°”å€¼è¡¨ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸ</p>
          </div>
        </div>

        <!-- å…¶ä»–æ–¹æ³•ç¤ºä¾‹... -->
      </section>

      <!-- æœ€ä½³å®è·µ -->
      <section id="best-practices" class="method-card highlight">
        <h2>ğŸŒŸ æœ€ä½³å®è·µ</h2>
        <div class="practice-grid">
          <div class="practice-item">
            <h3>ä¸ Proxy é…åˆä½¿ç”¨</h3>
            <CodeBlock :code="proxyExample" language="js" />
          </div>

          <div class="practice-item">
            <h3>æ›¿ä»£ Object æ–¹æ³•</h3>
            <CodeBlock :code="objectComparison" language="js" />
          </div>
        </div>
      </section>

      <!-- å¯¹æ¯”è¡¨æ ¼ -->
      <section id="comparison" class="method-card">
        <h2>ğŸ†š ä¸ä¼ ç»Ÿæ–¹æ³•å¯¹æ¯”</h2>
        <div class="comparison-table">
          <table>
            <thead>
              <tr>
                <th>æ“ä½œ</th>
                <th>ä¼ ç»Ÿæ–¹å¼</th>
                <th>Reflectæ–¹å¼</th>
                <th>ä¼˜åŠ¿</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>å±æ€§è¯»å–</td>
                <td><code>obj.prop</code></td>
                <td><code>Reflect.get(obj, 'prop')</code></td>
                <td>æ”¯æŒreceiverç»‘å®š</td>
              </tr>
              <!-- æ›´å¤šå¯¹æ¯”è¡Œ... -->
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </div>
</template>

<script setup lang="ts">
import CodeBlock from '../Components/CodeBlock.vue'
import Nav from '@/components/ScrollNav.vue'

const sections = [
  { id: 'overview', name: 'æ¦‚è¿°' },
  { id: 'methods', name: 'æ ¸å¿ƒæ–¹æ³•' },
  { id: 'best-practices', name: 'æœ€ä½³å®è·µ' },
  { id: 'comparison', name: 'æ–¹æ³•å¯¹æ¯”' },
]

const reflectGetExample = `
const obj = { x: 1, y: 2 };
// ä¼ ç»Ÿæ–¹å¼
console.log(obj.x); // 1

// Reflectæ–¹å¼
console.log(Reflect.get(obj, 'y')); // 2

// å¤„ç†è®¿é—®å™¨
const user = {
  _name: 'John',
  get name() {
    return this._name
  }
};
const receiver = { _name: 'Alice' };
console.log(Reflect.get(user, 'name', receiver)); // 'Alice'
`.trim()

const reflectSetExample = `
const target = {};
// æˆåŠŸè®¾ç½®
console.log(Reflect.set(target, 'prop', 123)); // true
console.log(target.prop); // 123

// è®¾ç½®ä¸å¯å†™å±æ€§
const obj = {};
Object.defineProperty(obj, 'fixed', {
  value: 'ä¸å¯å˜',
  writable: false
});
console.log(Reflect.set(obj, 'fixed', 'æ–°å€¼')); // false
`.trim()

const proxyExample = `
const handler = {
  get(target, prop, receiver) {
    console.log(\`è®¿é—®å±æ€§: \${prop}\`);
    return Reflect.get(...arguments);
  }
};

const proxy = new Proxy({ a: 1 }, handler);
proxy.a; // è¾“å‡º: "è®¿é—®å±æ€§: a"
`.trim()

const objectComparison = `
// æ—§æ–¹å¼
try {
  Object.defineProperty(obj, prop, descriptor);
} catch (e) {
  // å¤„ç†é”™è¯¯
}

// Reflectæ–¹å¼
if (Reflect.defineProperty(obj, prop, descriptor)) {
  // æˆåŠŸé€»è¾‘
} else {
  // å¤±è´¥å¤„ç†
}
`.trim()
</script>

<style scoped>
.catalogue {
  color: #fff;
}

.reflect-docs {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Inter', system-ui, sans-serif;
  line-height: 1.6;
}

.docs-header {
  text-align: center;
  margin-bottom: 3rem;
  padding-bottom: 1.5rem;
  border-bottom: 3px solid #647eff;
}

ul {
  list-style: none;
}

h1 {
  color: #213547;
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.method-card {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s;
}

.method-card:hover {
  transform: translateY(-3px);
}

.highlight {
  border: 2px solid #647eff;
  background: #f8faff;
}

.info-box {
  background: #f8fafc;
  padding: 1.5rem;
  border-radius: 8px;
  border-left: 4px solid #647eff;
}

.use-case {
  background: #fff9db;
  padding: 1rem;
  border-radius: 6px;
  margin: 1rem 0;
}

.warning {
  background: #ffe3e3;
  border-left: 4px solid #ff6b6b;
}

.practice-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.comparison-table {
  overflow-x: auto;
  margin-top: 1.5rem;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
}

th,
td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid #eee;
}

th {
  background: #647eff;
  color: white;
}

tr:hover {
  background: #f8fafc;
}

@media (max-width: 768px) {
  .reflect-docs {
    padding: 1rem;
  }

  h1 {
    font-size: 2rem;
  }

  .method-card {
    padding: 1.5rem;
  }
}
</style>
