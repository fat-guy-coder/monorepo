<template>
  <div class="timer-container">
    <header class="header">
      <div class="title-container">
        <h1>JavaScript å®šæ—¶å™¨ä»‹ç»</h1>
        <p>æŒæ¡ setTimeoutã€setInterval åŠé«˜æ€§èƒ½å®šæ—¶å™¨çš„å®ç°åŸç†</p>
      </div>
      <div class="visual-timer">
        <div class="timer-circle" :style="timerCircleStyle">
          <div class="timer-progress" :style="timerProgressStyle"></div>
          <div class="timer-center"></div>
        </div>
      </div>
    </header>

    <main class="content">
      <!-- åŸºç¡€çŸ¥è¯†éƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">â±ï¸</i> å®šæ—¶å™¨åŸºç¡€</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="info-grid">
            <div class="info-card">
              <div class="info-icon">âŒ›</div>
              <h3>å®šæ—¶å™¨ä½œç”¨</h3>
              <ul>
                <li>å»¶è¿Ÿæ‰§è¡Œä»£ç </li>
                <li>å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡</li>
                <li>å®ç°åŠ¨ç”»æ•ˆæœ</li>
                <li>èŠ‚æµä¸é˜²æŠ–</li>
                <li>è½®è¯¢æ•°æ®æ›´æ–°</li>
              </ul>
            </div>

            <div class="info-card">
              <div class="info-icon">âš™ï¸</div>
              <h3>æ ¸å¿ƒAPI</h3>
              <div class="api-list">
                <div class="api-item">
                  <code>setTimeout(fn, delay)</code>
                  <span>å»¶è¿Ÿæ‰§è¡Œä¸€æ¬¡</span>
                </div>
                <div class="api-item">
                  <code>setInterval(fn, interval)</code>
                  <span>å‘¨æœŸæ€§æ‰§è¡Œ</span>
                </div>
                <div class="api-item">
                  <code>clearTimeout(id)</code>
                  <span>å–æ¶ˆå®šæ—¶å™¨</span>
                </div>
                <div class="api-item">
                  <code>clearInterval(id)</code>
                  <span>å–æ¶ˆå®šæ—¶å™¨</span>
                </div>
              </div>
            </div>
          </div>

          <div class="code-block">
            <div class="code-header">
              <span class="code-title">åŸºæœ¬ç”¨æ³•ç¤ºä¾‹</span>
              <button class="copy-button" @click="copyCode('basicExample')">å¤åˆ¶</button>
            </div>
            <pre><code ref="basicExample">// setTimeout ç¤ºä¾‹
const timeoutId = setTimeout(() => {
  console.log('2ç§’åæ‰§è¡Œ');
}, 2000);

// setInterval ç¤ºä¾‹
const intervalId = setInterval(() => {
  console.log('æ¯ç§’æ‰§è¡Œä¸€æ¬¡');
}, 1000);

// æ¸…é™¤å®šæ—¶å™¨
clearTimeout(timeoutId);
clearInterval(intervalId);</code></pre>
          </div>
        </div>
      </section>

      <!-- å‚æ•°ä»‹ç»éƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">ğŸ”</i> å‚æ•°ä»‹ç»</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="parameter-table">
            <div class="table-header">
              <div class="col">å‚æ•°ä½ç½®</div>
              <div class="col">å‚æ•°ç±»å‹</div>
              <div class="col">è¯´æ˜</div>
              <div class="col">é»˜è®¤å€¼</div>
            </div>

            <div class="table-row">
              <div class="col">ç¬¬ä¸€ä¸ªå‚æ•°</div>
              <div class="col">Function | String</div>
              <div class="col">è¦æ‰§è¡Œçš„å‡½æ•°æˆ–ä»£ç å­—ç¬¦ä¸²ï¼ˆä¸æ¨èï¼‰</div>
              <div class="col">-</div>
            </div>

            <div class="table-row">
              <div class="col">ç¬¬äºŒä¸ªå‚æ•°</div>
              <div class="col">Number</div>
              <div class="col">å»¶è¿Ÿ/é—´éš”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</div>
              <div class="col">0</div>
            </div>

            <div class="table-row">
              <div class="col">åç»­å‚æ•°</div>
              <div class="col">Any</div>
              <div class="col">ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°</div>
              <div class="col">timerId</div>
            </div>
          </div>

          <div class="code-block">
            <div class="code-header">
              <span class="code-title">å‚æ•°ä¼ é€’ç¤ºä¾‹</span>
              <button class="copy-button" @click="copyCode('paramExample')">å¤åˆ¶</button>
            </div>
            <pre><code ref="paramExample">// ä¼ é€’å‚æ•°ç»™å›è°ƒå‡½æ•°
setTimeout((name, age) => {
  console.log(`å§“å: ${name}, å¹´é¾„: ${age}`);
}, 1000, 'å¼ ä¸‰', 25);

// è¾“å‡ºï¼šå§“å: å¼ ä¸‰, å¹´é¾„: 25</code></pre>
          </div>

          <div class="note-box">
            <div class="note-icon">âš ï¸</div>
            <p>
              æ³¨æ„ï¼šå›è°ƒå‡½æ•°ä¸­çš„ <code>this</code> åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º
              <code>undefined</code>ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘
              <code>window</code> å¯¹è±¡ã€‚å»ºè®®ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–ç»‘å®šä¸Šä¸‹æ–‡ã€‚
            </p>
          </div>
        </div>
      </section>

      <!-- é€‚ç”¨åœºæ™¯éƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">ğŸš€</i> é€‚ç”¨åœºæ™¯</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="scenario-grid">
            <div class="scenario-card">
              <div class="scenario-icon">â³</div>
              <h3>å»¶è¿Ÿæ‰§è¡Œ</h3>
              <p>é¡µé¢åŠ è½½åå»¶è¿Ÿæ‰§è¡ŒæŸäº›æ“ä½œï¼Œå¦‚æ˜¾ç¤ºæç¤ºä¿¡æ¯</p>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸ”„</div>
              <h3>å‘¨æœŸæ€§ä»»åŠ¡</h3>
              <p>å®šæœŸæ£€æŸ¥æ•°æ®æ›´æ–°ã€è½®è¯¢æœåŠ¡å™¨çŠ¶æ€</p>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸšï¸</div>
              <h3>èŠ‚æµä¸é˜²æŠ–</h3>
              <p>ä¼˜åŒ–é«˜é¢‘äº‹ä»¶å¤„ç†ï¼ˆæ»šåŠ¨ã€è¾“å…¥ã€è°ƒæ•´å¤§å°ï¼‰</p>
            </div>

            <div class="scenario-card">
              <div class="scenario-icon">ğŸ®</div>
              <h3>åŠ¨ç”»å®ç°</h3>
              <p>ç®€å•çš„åŠ¨ç”»æ•ˆæœå®ç°ï¼ˆç°ä»£åŠ¨ç”»å»ºè®®ä½¿ç”¨ requestAnimationFrameï¼‰</p>
            </div>
          </div>

          <div class="code-block">
            <div class="code-header">
              <span class="code-title">é˜²æŠ–å‡½æ•°å®ç°</span>
              <button class="copy-button" @click="copyCode('debounceExample')">å¤åˆ¶</button>
            </div>
            <pre><code ref="debounceExample">function debounce(fn, delay) {
  let timerId;
  return function(...args) {
    clearTimeout(timerId);
    timerId = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const searchInput = document.getElementById('search');
searchInput.addEventListener('input', debounce(() => {
  console.log('æ‰§è¡Œæœç´¢æ“ä½œ');
}, 300));</code></pre>
          </div>
        </div>
      </section>

      <!-- æ³¨æ„äº‹é¡¹éƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">âš ï¸</i> æ³¨æ„äº‹é¡¹</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="warnings">
            <div class="warning-item">
              <div class="warning-icon">1</div>
              <div>
                <h3>å®šæ—¶å™¨æ¸…é™¤</h3>
                <p>åŠ¡å¿…åœ¨ç»„ä»¶å¸è½½æˆ–ä¸éœ€è¦æ—¶æ¸…é™¤å®šæ—¶å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</p>
              </div>
            </div>

            <div class="warning-item">
              <div class="warning-icon">2</div>
              <div>
                <h3>æ‰§è¡Œæ—¶é—´ä¸ç¡®å®š</h3>
                <p>å®šæ—¶å™¨ä¸æ˜¯ç²¾ç¡®çš„ï¼Œä¼šå—åˆ°ä¸»çº¿ç¨‹é˜»å¡çš„å½±å“</p>
              </div>
            </div>

            <div class="warning-item">
              <div class="warning-icon">3</div>
              <div>
                <h3>æœ€å°å»¶è¿Ÿæ—¶é—´</h3>
                <p>æµè§ˆå™¨ä¸­æœ€å°å»¶è¿Ÿä¸º 4msï¼ˆHTML5 è§„èŒƒè¦æ±‚ï¼‰</p>
              </div>
            </div>

            <div class="warning-item">
              <div class="warning-icon">4</div>
              <div>
                <h3>ä¸Šä¸‹æ–‡é—®é¢˜</h3>
                <p>å›è°ƒå‡½æ•°ä¸­çš„ <code>this</code> æŒ‡å‘å¯èƒ½ä¸æ˜¯é¢„æœŸå¯¹è±¡</p>
              </div>
            </div>

            <div class="warning-item">
              <div class="warning-icon">5</div>
              <div>
                <h3>å¼‚æ­¥æ‰§è¡Œ</h3>
                <p>å®šæ—¶å™¨å›è°ƒæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</p>
              </div>
            </div>
          </div>

          <div class="code-block">
            <div class="code-header">
              <span class="code-title">Vue ç»„ä»¶ä¸­çš„å®šæ—¶å™¨æ¸…ç†</span>
              <button class="copy-button" @click="copyCode('vueExample')">å¤åˆ¶</button>
            </div>
            <pre><code ref="vueExample">import { onMounted, onUnmounted, ref } from 'vue';

export default {
  setup() {
    const timerId = ref&lt;number | null&gt;(null);

    onMounted(() => {
      timerId.value = setInterval(() => {
        console.log('å®šæ—¶ä»»åŠ¡æ‰§è¡Œ');
      }, 1000);
    });

    onUnmounted(() => {
      if (timerId.value) {
        clearInterval(timerId.value);
      }
    });

    return { timerId };
  }
}</code></pre>
          </div>
        </div>
      </section>

      <!-- é«˜ç²¾åº¦å®šæ—¶å™¨éƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">ğŸ¯</i> é«˜ç²¾åº¦å®šæ—¶å™¨</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="precision-info">
            <p>ç”±äº JavaScript çš„å•çº¿ç¨‹ç‰¹æ€§ï¼Œä¼ ç»Ÿå®šæ—¶å™¨åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼šå‡ºç°å»¶è¿Ÿï¼š</p>
            <ul>
              <li>ä¸»çº¿ç¨‹é•¿æ—¶é—´é˜»å¡ï¼ˆå¤æ‚è®¡ç®—ã€åŒæ­¥æ“ä½œï¼‰</li>
              <li>é¡µé¢å¤„äºåå°çŠ¶æ€ï¼ˆæµè§ˆå™¨èŠ‚æµï¼‰</li>
              <li>è®¾å¤‡æ€§èƒ½é™åˆ¶</li>
            </ul>

            <p>å®ç°é«˜ç²¾åº¦å®šæ—¶å™¨çš„ç­–ç•¥ï¼š</p>
            <ol>
              <li>ä½¿ç”¨ <code>performance.now()</code> è·å–é«˜ç²¾åº¦æ—¶é—´æˆ³</li>
              <li>è®°å½•æ¯æ¬¡æ‰§è¡Œçš„ç³»ç»Ÿæ—¶é—´</li>
              <li>è®¡ç®—æ—¶é—´åå·®å¹¶è¿›è¡Œè¡¥å¿</li>
              <li>åŠ¨æ€è°ƒæ•´ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´</li>
            </ol>
          </div>

          <div class="code-block">
            <div class="code-header">
              <span class="code-title">é«˜ç²¾åº¦å®šæ—¶å™¨å®ç°</span>
              <button class="copy-button" @click="copyCode('precisionExample')">å¤åˆ¶</button>
            </div>
            <pre><code ref="precisionExample">class HighPrecisionTimer {
  private callback: () => void;
  private interval: number;
  private expected: number;
  private timeoutId: number | null;
  private startTime: number;

  constructor(callback: () => void, interval: number) {
    this.callback = callback;
    this.interval = interval;
    this.expected = 0;
    this.timeoutId = null;
    this.startTime = 0;
  }

  start() {
    this.startTime = performance.now();
    this.expected = this.startTime + this.interval;
    this.timeoutId = setTimeout(this.step.bind(this), this.interval);
  }

  stop() {
    if (this.timeoutId) {
      clearTimeout(this.timeoutId);
      this.timeoutId = null;
    }
  }

  private step() {
    const now = performance.now();
    const drift = now - this.expected;

    // æ‰§è¡Œå›è°ƒ
    this.callback();

    // è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ï¼ˆè¡¥å¿æ—¶é—´åå·®ï¼‰
    this.expected += this.interval;
    const nextTime = Math.max(0, this.interval - drift);

    this.timeoutId = setTimeout(this.step.bind(this), nextTime);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const timer = new HighPrecisionTimer(() => {
  console.log('é«˜ç²¾åº¦å®šæ—¶å™¨æ‰§è¡Œ');
}, 1000);
timer.start();</code></pre>
          </div>
        </div>
      </section>

      <!-- äº¤äº’æ¼”ç¤ºéƒ¨åˆ† -->
      <section class="section">
        <div class="section-header">
          <h2><i class="icon">ğŸ§ª</i> å®šæ—¶å™¨æ¼”ç¤º</h2>
          <div class="divider"></div>
        </div>

        <div class="section-content">
          <div class="demo-container">
            <div class="demo-controls">
              <div class="control-group">
                <label>å®šæ—¶å™¨ç±»å‹ï¼š</label>
                <Select v-model="demoType">
                  <option value="timeout">setTimeout</option>
                  <option value="interval">setInterval</option>
                  <option value="precision">é«˜ç²¾åº¦å®šæ—¶å™¨</option>
                </select>
              </div>

              <div class="control-group">
                <label>å»¶è¿Ÿ/é—´éš”æ—¶é—´ (ms)ï¼š</label>
                <input type="number" v-model="demoInterval" min="10" max="5000" />
              </div>

              <div class="button-group">
                <button class="demo-button" @click="startDemo">
                  {{ isRunning ? 'åœæ­¢' : 'å¼€å§‹' }}
                </button>
                <button class="demo-button" @click="resetDemo">é‡ç½®</button>
              </div>
            </div>

            <div class="demo-output">
              <div class="output-header">
                <span>æ‰§è¡Œæ—¥å¿—</span>
                <span>åå·®: {{ lastDrift !== null ? lastDrift + 'ms' : '-' }}</span>
              </div>
              <div class="output-content">
                <div v-for="(log, index) in demoLogs" :key="index" class="log-entry">
                  <span class="log-time">[{{ log.time }}]</span>
                  <span class="log-message">{{ log.message }}</span>
                  <span v-if="log.drift !== null" class="log-drift">(åå·®: {{ log.drift }}ms)</span>
                </div>
                <div v-if="demoLogs.length === 0" class="empty-log">ç‚¹å‡»"å¼€å§‹"æŒ‰é’®å¯åŠ¨å®šæ—¶å™¨</div>
              </div>
            </div>

            <div class="stats-container">
              <div class="stat-card">
                <div class="stat-value">{{ executionCount }}</div>
                <div class="stat-label">æ‰§è¡Œæ¬¡æ•°</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">{{ avgDrift !== null ? avgDrift.toFixed(2) : '0.00' }}</div>
                <div class="stat-label">å¹³å‡åå·® (ms)</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">{{ maxDrift !== null ? maxDrift : '0' }}</div>
                <div class="stat-label">æœ€å¤§åå·® (ms)</div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>JavaScript å®šæ—¶å™¨æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„é‡è¦å·¥å…· | åˆç†ä½¿ç”¨å®šæ—¶å™¨å¯ä»¥æå‡ç”¨æˆ·ä½“éªŒå’Œç¨‹åºæ€§èƒ½</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onUnmounted } from 'vue'

// æ¼”ç¤ºç›¸å…³çŠ¶æ€
const demoType = ref<'timeout' | 'interval' | 'precision'>('interval')
const demoInterval = ref(1000)
const isRunning = ref(false)
const demoLogs = ref<Array<{ time: string; message: string; drift: number | null }>>([])
const executionCount = ref(0)
const lastDrift = ref<number | null>(null)
const avgDrift = ref<number | null>(null)
const maxDrift = ref<number | null>(null)
const driftSamples = ref<number[]>([])

let timerId: number | null = null
let precisionTimer: HighPrecisionTimer | null = null
let startTimestamp: number | null = null

class HighPrecisionTimer {
  private callback: () => void
  private interval: number
  private expected: number
  private timeoutId: number | null
  private startTime: number

  constructor(callback: () => void, interval: number) {
    this.callback = callback
    this.interval = interval
    this.expected = 0
    this.timeoutId = null
    this.startTime = 0
  }

  start() {
    this.startTime = performance.now()
    this.expected = this.startTime + this.interval
    this.timeoutId = window.setTimeout(this.step.bind(this), this.interval)
  }

  stop() {
    if (this.timeoutId) {
      clearTimeout(this.timeoutId)
      this.timeoutId = null
    }
  }

  private step() {
    const now = performance.now()
    const drift = now - this.expected

    // æ‰§è¡Œå›è°ƒ
    this.callback()

    // è®°å½•åå·®
    recordDrift(drift)

    // è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ï¼ˆè¡¥å¿æ—¶é—´åå·®ï¼‰
    this.expected += this.interval
    const nextTime = Math.max(0, this.interval - drift)

    this.timeoutId = window.setTimeout(this.step.bind(this), nextTime)
  }
}

// è®°å½•æ—¶é—´åå·®
function recordDrift(drift: number) {
  driftSamples.value.push(Math.abs(drift))
  lastDrift.value = drift
  executionCount.value++

  // è®¡ç®—å¹³å‡åå·®
  const sum = driftSamples.value.reduce((acc, val) => acc + val, 0)
  avgDrift.value = sum / driftSamples.value.length

  // è®¡ç®—æœ€å¤§åå·®
  maxDrift.value = Math.max(...driftSamples.value)
}

// æ·»åŠ æ—¥å¿—
function addLog(message: string, drift: number | null = null) {
  const now = new Date()
  const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`

  demoLogs.value.push({
    time: timeString,
    message,
    drift,
  })

  // é™åˆ¶æ—¥å¿—æ•°é‡
  if (demoLogs.value.length > 20) {
    demoLogs.value.shift()
  }
}

// å¼€å§‹æ¼”ç¤º
function startDemo() {
  if (isRunning.value) {
    stopDemo()
    return
  }

  // é‡ç½®çŠ¶æ€
  isRunning.value = true
  demoLogs.value = []
  executionCount.value = 0
  lastDrift.value = null
  avgDrift.value = null
  maxDrift.value = null
  driftSamples.value = []
  startTimestamp = performance.now()

  addLog('å®šæ—¶å™¨å¯åŠ¨')

  const interval = Math.max(10, Math.min(5000, demoInterval.value))

  switch (demoType.value) {
    case 'timeout':
      timerId = window.setTimeout(() => {
        addLog('setTimeout æ‰§è¡Œ')
        isRunning.value = false
      }, interval)
      break

    case 'interval':
      timerId = window.setInterval(() => {
        const now = performance.now()
        const drift = startTimestamp ? now - startTimestamp - executionCount.value * interval : 0
        recordDrift(drift)
        startTimestamp = now

        addLog(`setInterval æ‰§è¡Œ (${executionCount.value})`, drift)
      }, interval)
      break

    case 'precision':
      precisionTimer = new HighPrecisionTimer(() => {
        addLog(`é«˜ç²¾åº¦å®šæ—¶å™¨æ‰§è¡Œ (${executionCount.value})`, lastDrift.value)
      }, interval)
      precisionTimer.start()
      break
  }
}

// åœæ­¢æ¼”ç¤º
function stopDemo() {
  isRunning.value = false

  if (timerId) {
    if (demoType.value === 'interval') {
      clearInterval(timerId)
    } else {
      clearTimeout(timerId)
    }
    timerId = null
  }

  if (precisionTimer) {
    precisionTimer.stop()
    precisionTimer = null
  }

  addLog('å®šæ—¶å™¨å·²åœæ­¢')
}

// é‡ç½®æ¼”ç¤º
function resetDemo() {
  stopDemo()
  demoLogs.value = []
  executionCount.value = 0
  lastDrift.value = null
  avgDrift.value = null
  maxDrift.value = null
  driftSamples.value = []
}

// å¤åˆ¶ä»£ç 
function copyCode(refName: string) {
  const codeElement = document.querySelector(`[ref="${refName}"]`)
  if (codeElement) {
    const code = codeElement.textContent || ''
    navigator.clipboard.writeText(code).then(() => {
      alert('ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')
    })
  }
}

// å®šæ—¶å™¨åŠ¨ç”»æ•ˆæœ
const timerProgress = ref(0)
const timerCircleStyle = computed(() => ({
  transform: `rotate(${timerProgress.value * 360}deg)`,
}))

const timerProgressStyle = computed(() => ({
  transform: `rotate(${timerProgress.value * 360}deg)`,
}))

// æ¸…ç†å®šæ—¶å™¨
onUnmounted(() => {
  stopDemo()
})

// å®šæ—¶å™¨åŠ¨ç”»å¾ªç¯
function animateTimer() {
  if (isRunning.value) {
    timerProgress.value = (timerProgress.value + 0.002) % 1
  } else {
    timerProgress.value = 0
  }
  requestAnimationFrame(animateTimer)
}

animateTimer()
</script>

<style lang="less" scoped>
.timer-container {
  font-family:
    'Inter',
    -apple-system,
    BlinkMacSystemFont,
    'Segoe UI',
    Roboto,
    Oxygen,
    Ubuntu,
    sans-serif;
  background-color: #f8fafc;
  color: #334155;
  line-height: 1.6;
  min-height: 100vh;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, #3b82f6, #60a5fa);
  border-radius: 16px;
  padding: 40px;
  margin-bottom: 30px;
  color: white;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);

  .title-container {
    max-width: 600px;

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 15px;
      letter-spacing: -0.5px;
    }

    p {
      font-size: 1.1rem;
      opacity: 0.9;
    }
  }
}

.visual-timer {
  position: relative;
  width: 160px;
  height: 160px;

  .timer-circle {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    position: relative;
    transition: transform 0.1s linear;

    .timer-progress {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      clip: rect(0, 80px, 160px, 0);
      background: rgba(255, 255, 255, 0.3);
      transition: transform 0.1s linear;
    }

    .timer-center {
      position: absolute;
      width: 130px;
      height: 130px;
      background: #3b82f6;
      border-radius: 50%;
      top: 15px;
      left: 15px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
    }
  }
}

.content {
  display: grid;
  grid-template-columns: 1fr;
  gap: 30px;
  margin-bottom: 40px;
}

.section {
  background: white;
  border-radius: 16px;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.03);
  border: 1px solid #e2e8f0;
  padding: 30px;
  transition: all 0.3s ease;

  &:hover {
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
    transform: translateY(-3px);
  }
}

.section-header {
  margin-bottom: 25px;

  h2 {
    font-size: 1.8rem;
    color: #1e40af;
    display: flex;
    align-items: center;
    gap: 12px;

    .icon {
      background: #dbeafe;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }
  }

  .divider {
    height: 2px;
    background: linear-gradient(90deg, #3b82f6, #93c5fd);
    margin-top: 15px;
    border-radius: 2px;
  }
}

.section-content {
  p {
    margin-bottom: 20px;
    font-size: 1.05rem;
    color: #475569;
    line-height: 1.7;
  }

  .highlight {
    background: #dbeafe;
    color: #1e40af;
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 500;
  }
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin-bottom: 30px;
}

.info-card {
  background: #f1f5f9;
  border-radius: 16px;
  padding: 25px;
  transition: all 0.3s;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
  }

  .info-icon {
    font-size: 2.5rem;
    margin-bottom: 20px;
  }

  h3 {
    color: #1e40af;
    margin-bottom: 15px;
    font-size: 1.4rem;
  }

  ul {
    padding-left: 25px;

    li {
      margin-bottom: 12px;
      position: relative;

      &:before {
        content: 'â€¢';
        color: #3b82f6;
        font-weight: bold;
        position: absolute;
        left: -18px;
      }
    }
  }
}

.api-list {
  .api-item {
    padding: 12px 0;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    flex-direction: column;

    &:last-child {
      border-bottom: none;
    }

    code {
      font-family: 'Fira Code', monospace;
      background: #dbeafe;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.95rem;
      margin-bottom: 5px;
    }

    span {
      color: #64748b;
      font-size: 0.95rem;
    }
  }
}

.code-block {
  background: #f1f5f9;
  border-radius: 12px;
  overflow: hidden;
  margin: 25px 0;
  border: 1px solid #e2e8f0;

  .code-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
    background-color: #e2e8f0;
    border-bottom: 1px solid #cbd5e1;

    .code-title {
      font-weight: 600;
      color: #1e293b;
    }

    .copy-button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 6px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      font-size: 0.9rem;
      transition: all 0.2s;

      &:hover {
        background: #2563eb;
      }
    }
  }

  pre {
    padding: 20px;
    overflow-x: auto;
  }

  code {
    font-family: 'Fira Code', Consolas, Monaco, monospace;
    font-size: 0.95rem;
    line-height: 1.6;
    color: #1e293b;
  }
}

.parameter-table {
  border-radius: 12px;
  overflow: hidden;
  margin: 25px 0;
  border: 1px solid #e2e8f0;

  .table-header,
  .table-row {
    display: grid;
    grid-template-columns: 1fr 1fr 2fr 1fr;
  }

  .table-header {
    background: #3b82f6;
    color: white;
    font-weight: 600;

    .col {
      padding: 15px 20px;
    }
  }

  .table-row {
    background: white;
    border-bottom: 1px solid #e2e8f0;

    &:nth-child(even) {
      background: #f8fafc;
    }

    &:last-child {
      border-bottom: none;
    }

    .col {
      padding: 15px 20px;
      display: flex;
      align-items: center;
    }
  }
}

.note-box {
  display: flex;
  gap: 15px;
  background: #fffbeb;
  border-left: 4px solid #f59e0b;
  padding: 18px;
  border-radius: 0 8px 8px 0;
  margin: 25px 0;

  .note-icon {
    font-size: 1.5rem;
    color: #f59e0b;
  }

  p {
    margin: 0;
  }
}

.scenario-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 25px 0;
}

.scenario-card {
  background: #f1f5f9;
  border-radius: 12px;
  padding: 25px;
  transition: all 0.3s;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  }

  .scenario-icon {
    font-size: 2rem;
    margin-bottom: 15px;
  }

  h3 {
    color: #1e40af;
    margin-bottom: 12px;
    font-size: 1.3rem;
  }

  p {
    color: #475569;
    font-size: 1rem;
    margin-bottom: 0;
  }
}

.warnings {
  margin: 25px 0;

  .warning-item {
    display: flex;
    gap: 20px;
    padding: 20px;
    border-bottom: 1px solid #e2e8f0;

    &:last-child {
      border-bottom: none;
    }

    .warning-icon {
      width: 36px;
      height: 36px;
      background: #3b82f6;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
    }

    h3 {
      color: #1e40af;
      margin-bottom: 5px;
      font-size: 1.2rem;
    }

    p {
      margin: 0;
      color: #475569;
    }
  }
}

.precision-info {
  background: #f0f9ff;
  border-radius: 12px;
  padding: 25px;
  margin: 25px 0;

  p {
    font-weight: 500;
    margin-bottom: 15px;
  }

  ul,
  ol {
    padding-left: 30px;
    margin-bottom: 20px;

    li {
      margin-bottom: 10px;
      position: relative;

      &:before {
        position: absolute;
        left: -20px;
      }
    }
  }

  ul li:before {
    content: 'â€¢';
    color: #3b82f6;
    font-weight: bold;
  }

  ol {
    counter-reset: item;

    li {
      counter-increment: item;

      &:before {
        content: counter(item) '.';
        color: #3b82f6;
        font-weight: bold;
      }
    }
  }
}

.demo-container {
  background: #f8fafc;
  border-radius: 16px;
  border: 1px solid #e2e8f0;
  padding: 25px;
  margin-top: 20px;
}

.demo-controls {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 25px;
  align-items: center;

  .control-group {
    display: flex;
    align-items: center;
    gap: 10px;

    label {
      font-weight: 500;
      color: #1e293b;
    }

    select,
    input {
      padding: 10px 15px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      background: white;
      font-family: inherit;
      font-size: 1rem;

      &:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
      }
    }

    input {
      width: 120px;
    }
  }

  .button-group {
    display: flex;
    gap: 15px;
    margin-left: auto;
  }

  .demo-button {
    background: #3b82f6;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.2s;

    &:hover {
      background: #2563eb;
    }
  }
}

.demo-output {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 25px;
  border: 1px solid #e2e8f0;

  .output-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
    background-color: #e2e8f0;
    color: #1e293b;
    font-weight: 500;
  }

  .output-content {
    padding: 20px;
    min-height: 200px;
    max-height: 300px;
    overflow-y: auto;

    .log-entry {
      padding: 10px 0;
      border-bottom: 1px solid #f1f5f9;
      display: flex;
      gap: 15px;
      align-items: center;

      &:last-child {
        border-bottom: none;
      }

      .log-time {
        color: #64748b;
        font-family: 'Fira Code', monospace;
        font-size: 0.9rem;
      }

      .log-message {
        flex: 1;
      }

      .log-drift {
        color: #ef4444;
        font-weight: 500;
      }
    }

    .empty-log {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 160px;
      color: #94a3b8;
      font-style: italic;
    }
  }
}

.stats-container {
  display: flex;
  gap: 20px;

  .stat-card {
    flex: 1;
    background: white;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);

    .stat-value {
      font-size: 2.2rem;
      font-weight: 700;
      color: #3b82f6;
      margin-bottom: 10px;
    }

    .stat-label {
      color: #64748b;
      font-size: 0.95rem;
    }
  }
}

.footer {
  text-align: center;
  padding: 30px;
  color: #64748b;
  font-size: 0.95rem;
  border-top: 1px solid #e2e8f0;
  margin-top: 20px;
}

@media (max-width: 768px) {
  .header {
    flex-direction: column;
    text-align: center;
    padding: 30px 20px;

    .visual-timer {
      margin-top: 30px;
    }
  }

  .section {
    padding: 20px;
  }

  .demo-controls {
    flex-direction: column;
    align-items: stretch;

    .button-group {
      margin-left: 0;
      justify-content: center;
    }
  }

  .stats-container {
    flex-direction: column;
  }
}
</style>
