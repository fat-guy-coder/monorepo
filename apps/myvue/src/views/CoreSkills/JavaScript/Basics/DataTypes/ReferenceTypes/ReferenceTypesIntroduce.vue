<template>
  <div class="data-type-container">
    <!-- æ ‡é¢˜éƒ¨åˆ† -->
    <header class="header">
      <h1>ğŸ¯ JavaScript å¼•ç”¨æ•°æ®ç±»å‹</h1>
    </header>

    <h3>åŸºæœ¬æ•°æ®ç±»å‹å­˜å‚¨åœ¨æ ˆå†…å­˜ä¸­ï¼Œå¼•ç”¨æ•°æ®ç±»å‹æ˜¯å­˜å‚¨åœ¨å †å†…å­˜ä¸­çš„ï¼Œå˜é‡ä¿å­˜çš„æ˜¯å†…å­˜åœ°å€å¼•ç”¨</h3>

    <section class="memory-explanation">
      <h2 class="section-title">
        <span class="icon">ğŸ’¾</span>
        å†…å­˜å­˜å‚¨æœºåˆ¶
      </h2>

      <div class="memory-types">
        <div class="memory-type stack-memory">
          <h3>æ ˆå†…å­˜ (Stack)</h3>
          <ul>
            <li>æ ˆå†…å­˜æ˜¯ä¸€ä¸ªæœ‰åºçš„æ•°æ®ç»“æ„,éµå¾ª"åè¿›å…ˆå‡º"åŸåˆ™</li>
            <li>å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼å’Œå¼•ç”¨ç±»å‹çš„åœ°å€å¼•ç”¨</li>
            <li>ç©ºé—´è¾ƒå°ä½†è¯»å–é€Ÿåº¦å¿«</li>
            <li>ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾å†…å­˜</li>
            <li>å­˜å‚¨çš„æ•°æ®å¤§å°å›ºå®š</li>
          </ul>
        </div>

        <div class="memory-type heap-memory">
          <h3>å †å†…å­˜ (Heap)</h3>
          <ul>
            <li>å †å†…å­˜æ˜¯ä¸€ä¸ªæ— åºçš„å†…å­˜ç©ºé—´</li>
            <li>ä¸»è¦å­˜å‚¨å¼•ç”¨ç±»å‹çš„æ•°æ®æœ¬èº«</li>
            <li>ç©ºé—´è¾ƒå¤§ä½†è¯»å–é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢</li>
            <li>éœ€è¦æ‰‹åŠ¨æ¸…ç†å†…å­˜(JavaScripté€šè¿‡åƒåœ¾å›æ”¶æœºåˆ¶è‡ªåŠ¨å®Œæˆ)</li>
            <li>å­˜å‚¨çš„æ•°æ®å¤§å°å¯åŠ¨æ€è°ƒæ•´</li>
          </ul>
        </div>
      </div>

      <div class="memory-process">
        <h3>å­˜å‚¨è¿‡ç¨‹</h3>
        <p>å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¼•ç”¨ç±»å‹çš„æ•°æ®(å¦‚å¯¹è±¡)æ—¶:</p>
        <ol>
          <li>å¯¹è±¡çš„å…·ä½“æ•°æ®è¢«å­˜å‚¨åœ¨å †å†…å­˜ä¸­</li>
          <li>ç³»ç»Ÿä¼šä¸ºè¿™ä¸ªå¯¹è±¡åˆ†é…ä¸€ä¸ªå†…å­˜åœ°å€</li>
          <li>å˜é‡å®é™…ä¿å­˜çš„æ˜¯è¿™ä¸ªå†…å­˜åœ°å€(å¼•ç”¨)</li>
          <li>å½“éœ€è¦è®¿é—®å¯¹è±¡æ—¶,ç³»ç»Ÿä¼šé€šè¿‡å†…å­˜åœ°å€æ‰¾åˆ°å †å†…å­˜ä¸­çš„å®é™…æ•°æ®</li>
        </ol>
      </div>
    </section>


    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
      <!-- å­˜å‚¨æ–¹å¼ç¤ºæ„å›¾ -->
      <div class="memory-diagram">
        <div class="stack">
          <h3>æ ˆå†…å­˜ (Stack)</h3>
          <div class="stack-items">
            <div v-for="item in stackData" :key="item.name" class="stack-item">
              <span class="var-name">{{ item.name }}</span>
              <span class="var-value">{{ item.value }}</span>
            </div>
          </div>
        </div>
        <div class="heap">
          <h3>å †å†…å­˜ (Heap)</h3>
          <div class="heap-objects">
            <div class="heap-object" v-for="obj in heapData" :key="obj.address">
              <div class="obj-header">åœ°å€: {{ obj.address }}</div>
              <div class="obj-content">
                <div v-for="(value, key) in obj.data" :key="key" class="obj-property">
                  {{ key }}: {{ value }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- æ ¸å¿ƒç‰¹æ€§ -->
      <section class="card-section">
        <h2 class="section-title">
          <span class="icon">ğŸŒŸ</span>
          æ ¸å¿ƒç‰¹æ€§
        </h2>
        <div class="feature-grid">
          <div v-for="(feature, index) in features" :key="index" class="feature-card">
            <div class="feature-icon">{{ feature.icon }}</div>
            <h3>{{ feature.title }}</h3>
            <p>{{ feature.description }}</p>
            <pre v-if="feature.code" class="code-sample">{{ feature.code }}</pre>
          </div>
        </div>
      </section>

      <!-- ç±»å‹å¯¹æ¯”è¡¨æ ¼ -->
      <div class="comparison-table">
        <h2 class="section-title">
          <span class="icon">âš–ï¸</span>
          ä¸åŸºæœ¬ç±»å‹å¯¹æ¯”
        </h2>
        <table>
          <thead>
            <tr>
              <th>å¯¹æ¯”é¡¹</th>
              <th>å¼•ç”¨ç±»å‹</th>
              <th>åŸºæœ¬ç±»å‹</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(row, index) in comparisonData" :key="index">
              <td>{{ row.name }}</td>
              <td :class="{ highlight: row.reference }">{{ row.reference }}</td>
              <td :class="{ highlight: row.primitive }">{{ row.primitive }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

interface FeatureItem {
  icon: string;
  title: string;
  description: string;
  code?: string;
}

interface ComparisonRow {
  name: string;
  reference: string;
  primitive: string;
}

const stackData = ref([
  { name: 'num', value: '42' },
  { name: 'str', value: '"Hello"' },
  { name: 'objRef', value: '0x123' }
]);

const heapData = ref([
  {
    address: '0x123',
    data: {
      name: '"Example"',
      value: '100'
    }
  }
]);

const features = ref<FeatureItem[]>([
  {
    icon: 'ğŸ“¦',
    title: 'å †å†…å­˜å­˜å‚¨',
    description: 'å®é™…æ•°æ®å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼Œå˜é‡ä¿å­˜çš„æ˜¯å†…å­˜åœ°å€å¼•ç”¨',
    code: 'let obj = { a: 1 };\nlet copy = obj;'
  },
  {
    icon: 'ğŸ”—',
    title: 'åŠ¨æ€å¤§å°',
    description: 'å¯ä»¥åŠ¨æ€æ·»åŠ /åˆ é™¤å±æ€§ï¼Œå¤§å°ä¸å›ºå®š',
    code: 'obj.newProp = "dynamic";'
  },
  {
    icon: 'ğŸ”„',
    title: 'æŒ‰å¼•ç”¨ä¼ é€’',
    description: 'èµ‹å€¼å’Œä¼ å‚æ—¶ä¼ é€’å†…å­˜åœ°å€',
    code: 'function change(obj) {\n  obj.value = 100;\n}'
  }
]);

const comparisonData = ref<ComparisonRow[]>([
  {
    name: 'å­˜å‚¨ä½ç½®',
    reference: 'å †å†…å­˜',
    primitive: 'æ ˆå†…å­˜'
  },
  {
    name: 'èµ‹å€¼è¡Œä¸º',
    reference: 'å¤åˆ¶å¼•ç”¨åœ°å€',
    primitive: 'å¤åˆ¶å®é™…å€¼'
  },
  {
    name: 'å¤§å°',
    reference: 'åŠ¨æ€å˜åŒ–',
    primitive: 'å›ºå®šå¤§å°'
  },
  {
    name: 'æ¯”è¾ƒæ–¹å¼',
    reference: 'æ¯”è¾ƒå¼•ç”¨åœ°å€',
    primitive: 'æ¯”è¾ƒå®é™…å€¼'
  }
]);
</script>

<style scoped lang="less">
.data-type-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  background: linear-gradient(145deg, #f8f9fa, #e9ecef);

  .header {
    text-align: center;
    margin-bottom: 3rem;

    h1 {
      font-size: 2.5rem;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: #7f8c8d;
      font-size: 1.1rem;
    }
  }

  .memory-diagram {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 2rem;
    margin-bottom: 3rem;
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);

    .stack,
    .heap {
      padding: 1.5rem;
      border-radius: 8px;

      h3 {
        color: #2c3e50;
        margin-bottom: 1rem;
      }
    }

    .stack {
      background: #e3f2fd;
      border: 2px solid #2196F3;

      .stack-items {
        display: grid;
        gap: 1rem;

        .stack-item {
          background: white;
          padding: 1rem;
          border-radius: 6px;
          display: flex;
          justify-content: space-between;
          font-family: 'Fira Code', monospace;

          .var-name {
            color: #2196F3;
          }
        }
      }
    }

    .heap {
      background: #f0f4c3;
      border: 2px solid #cddc39;

      .heap-objects {
        display: grid;
        gap: 1rem;

        .heap-object {
          background: white;
          border-radius: 6px;
          overflow: hidden;

          .obj-header {
            background: #cddc39;
            padding: 0.5rem;
            font-family: 'Fira Code', monospace;
          }

          .obj-content {
            padding: 1rem;

            .obj-property {
              padding: 0.3rem 0;
              font-family: 'Fira Code', monospace;
            }
          }
        }
      }
    }
  }

  .card-section {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);

    .section-title {
      font-size: 1.8rem;
      color: #34495e;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      gap: 1rem;

      .icon {
        font-size: 1.5em;
      }
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;

      .feature-card {
        padding: 1.5rem;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #2196F3;

        .feature-icon {
          font-size: 2rem;
          margin-bottom: 1rem;
        }

        .code-sample {
          background: #2c3e50;
          color: white;
          padding: 1rem;
          border-radius: 6px;
          margin-top: 1rem;
          font-family: 'Fira Code', monospace;
          white-space: pre-wrap;
        }
      }
    }
  }

  .comparison-table {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;

      th,
      td {
        padding: 1rem;
        text-align: left;
        border-bottom: 1px solid #eee;
      }

      th {
        background: #f8f9fa;
      }

      .highlight {
        color: #2196F3;
        font-weight: 500;
      }
    }
  }
}
</style>
