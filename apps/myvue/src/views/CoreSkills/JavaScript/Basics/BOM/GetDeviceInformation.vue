<template>
  <div class="device-info-docs">
    <div class="header">
      <h1><i class="icon icon-cpu"></i> JavaScriptè®¾å¤‡ä¿¡æ¯APIæ–‡æ¡£</h1>
      <p>æ¢ç´¢æµè§ˆå™¨æä¾›çš„è®¾å¤‡ä¿¡æ¯è·å–èƒ½åŠ›</p>
    </div>

    <div class="api-grid">
      <!-- CPUä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-cpu"></i>
          <h2>CPUä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–å¤„ç†å™¨æ ¸å¿ƒæ•°å’Œå¹¶å‘èƒ½åŠ›</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–å¯ç”¨CPUæ ¸å¿ƒæ•°
const cores = navigator.hardwareConcurrency;

console.log(`å¯ç”¨CPUæ ¸å¿ƒæ•°: ${cores}`);
// è¾“å‡º: å¯ç”¨CPUæ ¸å¿ƒæ•°: 8 (å–å†³äºè®¾å¤‡)</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>æ­¤APIè¿”å›æµè§ˆå™¨å¯ç”¨çš„é€»è¾‘å¤„ç†å™¨æ ¸å¿ƒæ•°ï¼Œè¡¨ç¤ºæœ€å¤§å¹¶è¡Œçº¿ç¨‹æ•°</p>
          </div>
        </div>
      </div>

      <!-- GPUä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-gpu"></i>
          <h2>GPUä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–å›¾å½¢å¤„ç†å™¨è¯¦ç»†ä¿¡æ¯</p>
          </div>
          <div class="code-block">
            <pre><code>// é€šè¿‡WebGLè·å–GPUä¿¡æ¯
const canvas = document.createElement('canvas');
const gl = canvas.getContext('webgl');

if (gl) {
  const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
  if (debugInfo) {
    const vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);

    console.log(`GPUä¾›åº”å•†: ${vendor}`);
    console.log(`GPUå‹å·: ${renderer}`);
  }
}</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>éœ€è¦æµè§ˆå™¨æ”¯æŒWebGLï¼ŒæŸäº›æµè§ˆå™¨å¯èƒ½é™åˆ¶è®¿é—®ç²¾ç¡®çš„GPUä¿¡æ¯</p>
          </div>
        </div>
      </div>

      <!-- å†…å­˜ä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-memory"></i>
          <h2>å†…å­˜ä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–å†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆä»…Chromeæ”¯æŒï¼‰</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–å†…å­˜ä½¿ç”¨ä¿¡æ¯
if (performance && performance.memory) {
  const memory = performance.memory;

  const totalJSHeapSize = memory.totalJSHeapSize;
  const usedJSHeapSize = memory.usedJSHeapSize;
  const jsHeapSizeLimit = memory.jsHeapSizeLimit;

  console.log(`æ€»å †å¤§å°: ${formatBytes(totalJSHeapSize)}`);
  console.log(`å·²ä½¿ç”¨å †: ${formatBytes(usedJSHeapSize)}`);
  console.log(`å †å¤§å°é™åˆ¶: ${formatBytes(jsHeapSizeLimit)}`);
}

function formatBytes(bytes, decimals = 2) {
  if (bytes === 0) return '0 Bytes';
  const k = 1024;
  const dm = decimals < 0 ? 0 : decimals;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
}</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>ç›®å‰åªæœ‰åŸºäºChromiumçš„æµè§ˆå™¨æ”¯æŒæ­¤APIï¼Œè¿”å›çš„æ˜¯JavaScriptå †å†…å­˜ä¿¡æ¯</p>
          </div>
        </div>
      </div>

      <!-- å±å¹•ä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-screen"></i>
          <h2>å±å¹•ä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–æ˜¾ç¤ºè®¾å¤‡è¯¦ç»†ä¿¡æ¯</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–å±å¹•ä¿¡æ¯
const screenInfo = {
  width: screen.width,
  height: screen.height,
  colorDepth: screen.colorDepth,
  pixelDepth: screen.pixelDepth,
  orientation: screen.orientation.type,
  availWidth: screen.availWidth,
  availHeight: screen.availHeight
};

console.log('å±å¹•ä¿¡æ¯:', screenInfo);
// è¾“å‡ºç¤ºä¾‹:
// {
//   width: 1920,
//   height: 1080,
//   colorDepth: 24,
//   pixelDepth: 24,
//   orientation: 'landscape-primary',
//   availWidth: 1920,
//   availHeight: 1040
// }</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>availWidth/availHeightè¡¨ç¤ºå‡å»æ“ä½œç³»ç»Ÿç•Œé¢çš„å¯ç”¨ç©ºé—´</p>
          </div>
        </div>
      </div>

      <!-- ç½‘ç»œä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-network"></i>
          <h2>ç½‘ç»œä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–ç½‘ç»œè¿æ¥ç±»å‹å’Œæ€§èƒ½æ•°æ®</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–ç½‘ç»œè¿æ¥ä¿¡æ¯
const connection = navigator.connection ||
                  navigator.mozConnection ||
                  navigator.webkitConnection;

if (connection) {
  console.log(`ç½‘ç»œç±»å‹: ${connection.effectiveType}`);
  console.log(`ä¸‹è¡Œé€Ÿåº¦: ${connection.downlink} Mbps`);
  console.log(`å¾€è¿”å»¶è¿Ÿ: ${connection.rtt} ms`);
  console.log(`ä¿å­˜æ•°æ®æ¨¡å¼: ${connection.saveData ? 'å¼€å¯' : 'å…³é—­'}`);
}

// ç›‘å¬ç½‘ç»œå˜åŒ–
connection.addEventListener('change', () => {
  console.log('ç½‘ç»œçŠ¶æ€å˜åŒ–:', connection.effectiveType);
});</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>effectiveTypeå¯èƒ½çš„å–å€¼: 'slow-2g', '2g', '3g', '4g'</p>
          </div>
        </div>
      </div>

      <!-- åª’ä½“è®¾å¤‡API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-media"></i>
          <h2>åª’ä½“è®¾å¤‡</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>æšä¸¾æ‘„åƒå¤´ã€éº¦å…‹é£ç­‰åª’ä½“è®¾å¤‡</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–åª’ä½“è®¾å¤‡åˆ—è¡¨
navigator.mediaDevices.enumerateDevices()
  .then(devices => {
    const cameras = devices.filter(d => d.kind === 'videoinput');
    const mics = devices.filter(d => d.kind === 'audioinput');
    const speakers = devices.filter(d => d.kind === 'audiooutput');

    console.log(`æ‘„åƒå¤´æ•°é‡: ${cameras.length}`);
    console.log(`éº¦å…‹é£æ•°é‡: ${mics.length}`);
    console.log(`æ‰¬å£°å™¨æ•°é‡: ${speakers.length}`);

    // è¾“å‡ºè®¾å¤‡è¯¦ç»†ä¿¡æ¯
    devices.forEach(device => {
      console.log(`${device.kind}: ${device.label} (ID: ${device.deviceId})`);
    });
  })
  .catch(err => {
    console.error('è·å–åª’ä½“è®¾å¤‡å¤±è´¥:', err);
  });</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>éœ€è¦ç”¨æˆ·æˆæƒè®¿é—®åª’ä½“è®¾å¤‡åï¼Œæ‰èƒ½è·å–éç©ºç™½çš„è®¾å¤‡æ ‡ç­¾</p>
          </div>
        </div>
      </div>

      <!-- ç”µæ± ä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-battery"></i>
          <h2>ç”µæ± ä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–ç”µæ± çŠ¶æ€å’Œå……ç”µä¿¡æ¯</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–ç”µæ± ä¿¡æ¯
if ('getBattery' in navigator) {
  navigator.getBattery().then(battery => {
    console.log(`ç”µé‡: ${Math.round(battery.level * 100)}%`);
    console.log(`å……ç”µçŠ¶æ€: ${battery.charging ? 'å……ç”µä¸­' : 'æœªå……ç”µ'}`);
    console.log(`å……æ»¡ç”µé¢„è®¡æ—¶é—´: ${battery.chargingTime}ç§’`);
    console.log(`è€—å°½ç”µé¢„è®¡æ—¶é—´: ${battery.dischargingTime}ç§’`);

    // ç›‘å¬å……ç”µçŠ¶æ€å˜åŒ–
    battery.addEventListener('chargingchange', () => {
      console.log('å……ç”µçŠ¶æ€å˜åŒ–:', battery.charging);
    });

    // ç›‘å¬ç”µé‡å˜åŒ–
    battery.addEventListener('levelchange', () => {
      console.log('ç”µé‡å˜åŒ–:', battery.level);
    });
  });
} else {
  console.log('æ­¤æµè§ˆå™¨ä¸æ”¯æŒç”µæ± çŠ¶æ€API');
}</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>æ­¤APIå·²è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼Œä½†è®¸å¤šæµè§ˆå™¨ä»æ”¯æŒï¼Œæœªæ¥å¯èƒ½è¢«æ–°APIå–ä»£</p>
          </div>
        </div>
      </div>

      <!-- ä¼ æ„Ÿå™¨API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-sensor"></i>
          <h2>ä¼ æ„Ÿå™¨</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>æ£€æµ‹è®¾å¤‡æ”¯æŒçš„ä¼ æ„Ÿå™¨ç±»å‹</p>
          </div>
          <div class="code-block">
            <pre><code>// æ£€æµ‹ä¼ æ„Ÿå™¨æ”¯æŒæƒ…å†µ
const sensors = {
  // è¿åŠ¨ä¼ æ„Ÿå™¨ï¼ˆåŠ é€Ÿåº¦è®¡/é™€èºä»ªï¼‰
  motion: 'DeviceMotionEvent' in window,

  // æ–¹å‘ä¼ æ„Ÿå™¨ï¼ˆæŒ‡å—é’ˆï¼‰
  orientation: 'DeviceOrientationEvent' in window,

  // æ¥è¿‘ä¼ æ„Ÿå™¨
  proximity: 'DeviceProximityEvent' in window,

  // ç¯å¢ƒå…‰ä¼ æ„Ÿå™¨
  ambientLight: 'AmbientLightSensor' in window,

  // åœ°ç†ä½ç½®
  geolocation: 'geolocation' in navigator
};

console.log('ä¼ æ„Ÿå™¨æ”¯æŒæƒ…å†µ:', sensors);

// ä½¿ç”¨åœ°ç†ä½ç½®API
if (sensors.geolocation) {
  navigator.geolocation.getCurrentPosition(position => {
    console.log('å½“å‰ä½ç½®:', {
      latitude: position.coords.latitude,
      longitude: position.coords.longitude,
      accuracy: position.coords.accuracy
    });
  }, error => {
    console.error('è·å–ä½ç½®å¤±è´¥:', error.message);
  });
}</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>è®¿é—®æŸäº›ä¼ æ„Ÿå™¨ï¼ˆå¦‚åœ°ç†ä½ç½®ï¼‰éœ€è¦ç”¨æˆ·æ˜ç¡®æˆæƒ</p>
          </div>
        </div>
      </div>

      <!-- Navigatorä¿¡æ¯API -->
      <div class="api-card">
        <div class="card-header">
          <i class="icon icon-navigator"></i>
          <h2>Navigatorä¿¡æ¯</h2>
        </div>
        <div class="card-content">
          <div class="api-description">
            <p>è·å–æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯</p>
          </div>
          <div class="code-block">
            <pre><code>// è·å–æµè§ˆå™¨ä¿¡æ¯
const browserInfo = {
  userAgent: navigator.userAgent,
  platform: navigator.platform,
  language: navigator.language,
  languages: navigator.languages,
  cookieEnabled: navigator.cookieEnabled,
  maxTouchPoints: navigator.maxTouchPoints,
  pdfViewerEnabled: navigator.pdfViewerEnabled,
  // å…¶ä»–æœ‰ç”¨å±æ€§
  deviceMemory: navigator.deviceMemory || 'æœªçŸ¥',
  hardwareConcurrency: navigator.hardwareConcurrency,
  onLine: navigator.onLine,
  serviceWorker: 'serviceWorker' in navigator,
  storage: navigator.storage ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ'
};

console.log('æµè§ˆå™¨ä¿¡æ¯:', browserInfo);

// æ£€æµ‹è®¾å¤‡ç±»å‹
const isMobile = /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i
  .test(navigator.userAgent);
console.log(`ç§»åŠ¨è®¾å¤‡: ${isMobile ? 'æ˜¯' : 'å¦'}`);</code></pre>
          </div>
          <div class="api-notes">
            <p><strong>æ³¨æ„ï¼š</strong>userAgentä¿¡æ¯å¯è¢«ç”¨æˆ·ä¿®æ”¹ï¼Œä¸åº”ç”¨ä½œåŠŸèƒ½æ£€æµ‹çš„å”¯ä¸€ä¾æ®</p>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>JavaScriptè®¾å¤‡ä¿¡æ¯APIæ–‡æ¡£ | å®é™…ä½¿ç”¨éœ€è€ƒè™‘æµè§ˆå™¨å…¼å®¹æ€§å’Œç”¨æˆ·éšç§</p>
    </div>
  </div>
</template>

<script setup lang="ts">
// æ­¤ç»„ä»¶ä»…ç”¨äºå±•ç¤ºAPIæ–‡æ¡£ï¼Œä¸éœ€è¦å®é™…é€»è¾‘
</script>

<style lang="less" scoped>
@primary-color: #4361ee;
@secondary-color: #3a0ca3;
@text-color: #2b2d42;
@light-bg: #f8f9fa;
@card-bg: #ffffff;
@border-color: #e9ecef;
@code-bg: #f5f7ff;
@success-color: #4cc9f0;
@warning-color: #f72585;
@muted-color: #8d99ae;

.device-info-docs {
  max-width: 1400px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: @text-color;
  background: linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%);
  min-height: 100vh;

  .header {
    text-align: center;
    margin-bottom: 2.5rem;
    padding: 1.5rem;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);

    h1 {
      font-size: 2.4rem;
      color: @secondary-color;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
    }

    p {
      font-size: 1.1rem;
      color: @muted-color;
      max-width: 600px;
      margin: 0 auto;
    }
  }

  .api-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
    gap: 1.8rem;
    margin-bottom: 2rem;
  }

  .api-card {
    background: @card-bg;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
    border: 1px solid @border-color;

    &:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }
  }

  .card-header {
    background: linear-gradient(135deg, lighten(@primary-color, 42%) 0%, lighten(@secondary-color, 50%) 100%);
    padding: 1.2rem 1.8rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    border-bottom: 1px solid @border-color;

    h2 {
      font-size: 1.4rem;
      font-weight: 700;
      color: darken(@secondary-color, 10%);
      margin: 0;
    }
  }

  .card-content {
    padding: 1.8rem;
  }

  .api-description {
    margin-bottom: 1.2rem;

    p {
      color: lighten(@text-color, 15%);
      line-height: 1.6;
    }
  }

  .code-block {
    background: @code-bg;
    border-radius: 8px;
    padding: 1.2rem;
    margin-bottom: 1.2rem;
    border-left: 4px solid @primary-color;
    overflow-x: auto;

    pre {
      margin: 0;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 0.9rem;
      line-height: 1.5;
      color: darken(@primary-color, 15%);
    }

    code {
      display: block;
      white-space: pre-wrap;
    }
  }

  .api-notes {
    background: lighten(@light-bg, 1%);
    border-radius: 8px;
    padding: 1rem;
    font-size: 0.9rem;

    p {
      margin: 0.3rem 0;
      color: @muted-color;

      strong {
        color: @text-color;
      }
    }
  }

  .footer {
    text-align: center;
    color: @muted-color;
    font-size: 0.9rem;
    padding-top: 2rem;
    margin-top: 1rem;
    border-top: 1px solid @border-color;
  }

  // å›¾æ ‡æ ·å¼
  .icon {
    font-size: 1.6rem;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.7);

    &-cpu:before {
      content: "ğŸ§ ";
    }

    &-gpu:before {
      content: "ğŸ®";
    }

    &-memory:before {
      content: "ğŸ’¾";
    }

    &-screen:before {
      content: "ğŸ“º";
    }

    &-network:before {
      content: "ğŸ“¡";
    }

    &-media:before {
      content: "ğŸ¥";
    }

    &-battery:before {
      content: "ğŸ”‹";
    }

    &-sensor:before {
      content: "ğŸ“¡";
    }

    &-navigator:before {
      content: "ğŸ§­";
    }
  }

  @media (max-width: 768px) {
    padding: 1.2rem;

    .header h1 {
      font-size: 1.8rem;
    }

    .api-grid {
      grid-template-columns: 1fr;
    }
  }
}
</style>
