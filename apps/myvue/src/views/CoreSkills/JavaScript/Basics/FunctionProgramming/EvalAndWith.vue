<template>
  <div class="js-with-eval">
    <header class="page-header">
      <div class="header-content">
        <h1>JavaScript with å’Œ eval å‡½æ•°</h1>
        <p class="subtitle">å¼ºå¤§ä½†å±é™©çš„ç‰¹æ€§ - æ·±å…¥ç†è§£å…¶æœºåˆ¶ä¸æœ€ä½³å®è·µ</p>
        <div class="header-stats">
          <div class="stat">
            <span class="stat-number">âš ï¸</span>
            <span class="stat-label">è°¨æ…ä½¿ç”¨</span>
          </div>
          <div class="stat">
            <span class="stat-number">ğŸš«</span>
            <span class="stat-label">ä¸¥æ ¼æ¨¡å¼ç¦ç”¨</span>
          </div>
          <div class="stat">
            <span class="stat-number">ğŸ”</span>
            <span class="stat-label">ç†è§£åŸç†</span>
          </div>
        </div>
      </div>
    </header>

    <main class="content">
      <section class="warning-banner">
        <div class="warning-content">
          <div class="warning-icon">âš ï¸</div>
          <div class="warning-text">
            <h3>å®‰å…¨è­¦å‘Š</h3>
            <p><code>with</code> å’Œ <code>eval</code> æ˜¯ JavaScript ä¸­å¼ºå¤§ä½†å±é™©çš„ç‰¹æ€§ã€‚åœ¨ç°ä»£å¼€å‘ä¸­åº”å°½é‡é¿å…ä½¿ç”¨ï¼Œé™¤éåœ¨éå¸¸ç‰¹å®šçš„åœºæ™¯ä¸‹ä¸”å®Œå…¨äº†è§£å…¶é£é™©ã€‚</p>
          </div>
        </div>
      </section>

      <section class="comparison-section">
        <h2 class="section-title">ç‰¹æ€§å¯¹æ¯”</h2>
        <div class="comparison-table">
          <div class="table-header">
            <div class="header-cell">ç‰¹æ€§</div>
            <div class="header-cell">with è¯­å¥</div>
            <div class="header-cell">eval å‡½æ•°</div>
          </div>
          <div class="table-row" v-for="row in comparisonData" :key="row.feature">
            <div class="row-cell feature-cell">{{ row.feature }}</div>
<div class="row-cell" :class="{ 'highlight-warning': row.with.warning }">
              <span class="cell-content">{{ row.with.value }}</span>
              <span class="cell-tag" :class="row.with.tagType" v-if="row.with.tag">{{ row.with.tag }}</span>
            </div>
            <div class="row-cell" :class="{ 'highlight-warning': row.eval.warning }">
              <span class="cell-content">{{ row.eval.value }}</span>
              <span class="cell-tag" :class="row.eval.tagType" v-if="row.eval.tag">{{ row.eval.tag }}</span>
            </div>
          </div>
        </div>
      </section>

      <div class="content-grid">
        <section class="with-section">
          <div class="section-header">
            <h2>with è¯­å¥</h2>
            <div class="danger-level level-high">é«˜é£é™©</div>
          </div>

          <div class="definition-card">
            <h3>ä½œç”¨ä¸å®šä¹‰</h3>
            <p><code>with</code> è¯­å¥ç”¨äºæ‰©å±•ä¸€ä¸ªè¯­å¥çš„ä½œç”¨åŸŸé“¾ï¼Œå°†æŒ‡å®šçš„å¯¹è±¡æ·»åŠ åˆ°ä½œç”¨åŸŸé“¾çš„å¤´éƒ¨ã€‚</p>
            <div class="code-block">
              <pre><code>with (expression)
  statement</code></pre>
            </div>
          </div>

          <div class="example-card">
            <h3>ä»£ç ç¤ºä¾‹</h3>
            <div class="example-tabs">
              <button
                v-for="example in withExamples"
                :key="example.id"
                class="example-tab"
                :class="{ active: activeWithExample === example.id }"
                @click="activeWithExample = example.id"
              >
                {{ example.title }}
              </button>
            </div>
            <div class="example-content">
              <div v-for="example in withExamples" :key="example.id" v-show="activeWithExample === example.id">
                <div class="code-block">
                  <pre><code>{{ example.code }}</code></pre>
                </div>
                <p class="example-description">{{ example.description }}</p>
              </div>
            </div>
          </div>

          <div class="pros-cons-grid">
            <div class="pros-card">
              <h3>ä¼˜ç‚¹</h3>
              <ul>
                <li v-for="pro in withPros" :key="pro">
                  <span class="check-icon">âœ…</span>
                  {{ pro }}
                </li>
              </ul>
            </div>
            <div class="cons-card">
              <h3>ç¼ºç‚¹</h3>
              <ul>
                <li v-for="con in withCons" :key="con">
                  <span class="warning-icon">âŒ</span>
                  {{ con }}
                </li>
              </ul>
            </div>
          </div>

          <div class="usage-card">
            <h3>é€‚ç”¨åœºæ™¯</h3>
            <div class="scenarios">
              <div
                v-for="scenario in withScenarios"
                :key="scenario.id"
                class="scenario-item"
                :class="{ 'discouraged': scenario.discouraged }"
              >
                <div class="scenario-icon">{{ scenario.icon }}</div>
                <div class="scenario-content">
                  <h4>{{ scenario.title }}</h4>
                  <p>{{ scenario.description }}</p>
                </div>
                <div class="scenario-tag" :class="scenario.tagType">{{ scenario.tag }}</div>
              </div>
            </div>
          </div>
        </section>

        <section class="eval-section">
          <div class="section-header">
            <h2>eval å‡½æ•°</h2>
            <div class="danger-level level-critical">æé«˜é£é™©</div>
          </div>

          <div class="definition-card">
            <h3>ä½œç”¨ä¸å®šä¹‰</h3>
            <p><code>eval()</code> å‡½æ•°ä¼šå°†ä¼ å…¥çš„å­—ç¬¦ä¸²å½“åš JavaScript ä»£ç è¿›è¡Œæ‰§è¡Œã€‚</p>
            <div class="code-block">
              <pre><code>eval(string)</code></pre>
            </div>
          </div>

          <div class="example-card">
            <h3>ä»£ç ç¤ºä¾‹</h3>
            <div class="example-tabs">
              <button
                v-for="example in evalExamples"
                :key="example.id"
                class="example-tab"
                :class="{ active: activeEvalExample === example.id }"
                @click="activeEvalExample = example.id"
              >
                {{ example.title }}
              </button>
            </div>
            <div class="example-content">
              <div v-for="example in evalExamples" :key="example.id" v-show="activeEvalExample === example.id">
                <div class="code-block">
                  <pre><code>{{ example.code }}</code></pre>
                </div>
                <p class="example-description">{{ example.description }}</p>
              </div>
            </div>
          </div>

          <div class="pros-cons-grid">
            <div class="pros-card">
              <h3>ä¼˜ç‚¹</h3>
              <ul>
                <li v-for="pro in evalPros" :key="pro">
                  <span class="check-icon">âœ…</span>
                  {{ pro }}
                </li>
              </ul>
            </div>
            <div class="cons-card">
              <h3>ç¼ºç‚¹</h3>
              <ul>
                <li v-for="con in evalCons" :key="con">
                  <span class="warning-icon">âŒ</span>
                  {{ con }}
                </li>
              </ul>
            </div>
          </div>

          <div class="security-card">
            <h3>å®‰å…¨æ³¨æ„äº‹é¡¹</h3>
            <div class="security-tips">
              <div
                v-for="tip in securityTips"
                :key="tip.id"
                class="security-tip"
                :class="tip.level"
              >
                <div class="tip-header">
                  <span class="tip-icon">{{ tip.icon }}</span>
                  <h4>{{ tip.title }}</h4>
                </div>
                <p>{{ tip.description }}</p>
                <div class="tip-code" v-if="tip.code">
                  <pre><code>{{ tip.code }}</code></pre>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <section class="alternatives-section">
        <h2 class="section-title">æ›¿ä»£æ–¹æ¡ˆ</h2>
        <div class="alternatives-grid">
          <div
            v-for="alternative in alternatives"
            :key="alternative.id"
            class="alternative-card"
          >
            <div class="alt-header">
              <h3>{{ alternative.title }}</h3>
              <span class="alt-type">{{ alternative.type }}</span>
            </div>
            <p class="alt-description">{{ alternative.description }}</p>
            <div class="alt-example">
              <h4>ç¤ºä¾‹ï¼š</h4>
              <div class="code-block">
                <pre><code>{{ alternative.example }}</code></pre>
              </div>
            </div>
            <div class="alt-benefits">
              <span
                v-for="benefit in alternative.benefits"
                :key="benefit"
                class="benefit-tag"
              >{{ benefit }}</span>
            </div>
          </div>
        </div>
      </section>

      <section class="best-practices-section">
        <h2 class="section-title">æœ€ä½³å®è·µæ€»ç»“</h2>
        <div class="practices-list">
          <div
            v-for="practice in bestPractices"
            :key="practice.id"
            class="practice-item"
          >
            <div class="practice-icon">{{ practice.icon }}</div>
            <div class="practice-content">
              <h3>{{ practice.title }}</h3>
              <p>{{ practice.description }}</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <div class="footer-content">
        <div class="footer-info">
          <h3>JavaScript with å’Œ eval</h3>
          <p>ç†è§£å…¶åŸç†ï¼Œè°¨æ…ä½¿ç”¨ï¼Œä¼˜å…ˆé€‰æ‹©æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆ</p>
        </div>
        <div class="footer-links">
          <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with" target="_blank">MDN with æ–‡æ¡£</a>
          <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/eval" target="_blank">MDN eval æ–‡æ¡£</a>
          <a href="https://eslint.org/docs/rules/no-eval" target="_blank">ESLint è§„åˆ™</a>
          <a href="https://262.ecma-international.org/" target="_blank">ECMAScript è§„èŒƒ</a>
        </div>
      </div>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

// å“åº”å¼æ•°æ®
const activeWithExample = ref('basic')
const activeEvalExample = ref('basic')

// å¯¹æ¯”è¡¨æ ¼æ•°æ®
const comparisonData = ref([
  {
    feature: 'ä¸»è¦ä½œç”¨',
    with: { value: 'æ‰©å±•ä½œç”¨åŸŸé“¾', tag: 'ä½œç”¨åŸŸæ“ä½œ', tagType: 'info' },
    eval: { value: 'æ‰§è¡Œå­—ç¬¦ä¸²ä»£ç ', tag: 'ä»£ç æ‰§è¡Œ', tagType: 'info' }
  },
  {
    feature: 'ä¸¥æ ¼æ¨¡å¼',
    with: { value: 'ç¦æ­¢ä½¿ç”¨', tag: 'è¯­æ³•é”™è¯¯', tagType: 'error', warning: true },
    eval: { value: 'å—é™ä½¿ç”¨', tag: 'é™åˆ¶ä½œç”¨åŸŸ', tagType: 'warning', warning: true }
  },
  {
    feature: 'æ€§èƒ½å½±å“',
    with: { value: 'ä¸¥é‡', tag: 'ä¼˜åŒ–å›°éš¾', tagType: 'error', warning: true },
    eval: { value: 'ä¸¥é‡', tag: 'æ— ä¼˜åŒ–', tagType: 'error', warning: true }
  },
  {
    feature: 'å®‰å…¨æ€§',
    with: { value: 'ä¸­ç­‰é£é™©', tag: 'å¯èƒ½è¢«åˆ©ç”¨', tagType: 'warning', warning: true },
    eval: { value: 'æé«˜é£é™©', tag: 'ä»£ç æ³¨å…¥', tagType: 'error', warning: true }
  },
  {
    feature: 'å¯è¯»æ€§',
    with: { value: 'å·®', tag: 'æ··æ·†æ¥æº', tagType: 'warning', warning: true },
    eval: { value: 'æå·®', tag: 'éš¾ä»¥è¿½è¸ª', tagType: 'error', warning: true }
  },
  {
    feature: 'ä½¿ç”¨é¢‘ç‡',
    with: { value: 'æå°‘', tag: 'ä¸æ¨è', tagType: 'error', warning: true },
    eval: { value: 'è°¨æ…', tag: 'ç‰¹æ®Šæƒ…å†µ', tagType: 'warning', warning: true }
  }
])

// with è¯­å¥ç¤ºä¾‹
const withExamples = ref([
  {
    id: 'basic',
    title: 'åŸºç¡€ç”¨æ³•',
    code: `const obj = {
  a: 1,
  b: 2,
  c: 3
};

// ä¸ä½¿ç”¨ with
console.log(obj.a);
console.log(obj.b);
console.log(obj.c);

// ä½¿ç”¨ with
with (obj) {
  console.log(a); // 1
  console.log(b); // 2
  console.log(c); // 3
}`,
    description: 'with è¯­å¥å°† obj çš„å±æ€§æ·»åŠ åˆ°å½“å‰ä½œç”¨åŸŸé“¾ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å±æ€§è€Œæ— éœ€å‰ç¼€ã€‚'
  },
  {
    id: 'scope',
    title: 'ä½œç”¨åŸŸé“¾é—®é¢˜',
    code: `const x = 10;
const obj = { y: 20 };

with (obj) {
  console.log(y); // 20 - æ¥è‡ª obj
  console.log(x); // 10 - æ¥è‡ªå¤–éƒ¨ä½œç”¨åŸŸ
  z = 30; // åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ï¼Œéä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šåˆ›å»ºå…¨å±€å˜é‡
}`,
    description: 'with ä¼šæ”¹å˜æ ‡è¯†ç¬¦è§£æé¡ºåºï¼Œå¯èƒ½å¯¼è‡´æ„å¤–çš„å˜é‡è®¿é—®å’Œåˆ›å»ºã€‚'
  },
  {
    id: 'performance',
    title: 'æ€§èƒ½é—®é¢˜æ¼”ç¤º',
    code: `function withoutWith(obj) {
  return obj.a + obj.b + obj.c;
}

function withWith(obj) {
  with (obj) {
    return a + b + c;
  }
}

// withWith å‡½æ•°æ— æ³•è¢« JavaScript å¼•æ“ä¼˜åŒ–
// å› ä¸ºå¼•æ“æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®š aã€bã€c çš„æ¥æº`,
    description: 'with è¯­å¥é˜»æ­¢äº† JavaScript å¼•æ“çš„ä¼˜åŒ–ï¼Œå› ä¸ºä½œç”¨åŸŸåœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šã€‚'
  }
])

// eval å‡½æ•°ç¤ºä¾‹
const evalExamples = ref([
  {
    id: 'basic',
    title: 'åŸºç¡€ç”¨æ³•',
    code: `// æ‰§è¡Œç®€å•è¡¨è¾¾å¼
const result = eval('2 + 2');
console.log(result); // 4

// æ‰§è¡Œå‡½æ•°
eval('function sayHello() { console.log("Hello"); }');
sayHello(); // "Hello"

// è®¿é—®å’Œä¿®æ”¹å˜é‡
let x = 10;
eval('x = 20');
console.log(x); // 20`,
    description: 'eval å¯ä»¥æ‰§è¡Œä»»ä½•æœ‰æ•ˆçš„ JavaScript ä»£ç å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼ã€å‡½æ•°å£°æ˜å’Œå˜é‡æ“ä½œã€‚'
  },
  {
    id: 'security',
    title: 'å®‰å…¨é—®é¢˜æ¼”ç¤º',
    code: `// å±é™©çš„ eval ä½¿ç”¨
const userInput = "console.log('æ¶æ„ä»£ç æ‰§è¡Œ'); process.exit(0)";

// ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥ - æå…¶å±é™©!
eval(userInput);

// ç¨å¾®å®‰å…¨çš„ä½¿ç”¨æ–¹å¼ï¼ˆä»ç„¶ä¸æ¨èï¼‰
function safeEval(code) {
  // ä½¿ç”¨é—´æ¥è°ƒç”¨ï¼Œé™åˆ¶ä½œç”¨åŸŸ
  const indirectEval = eval;
  return indirectEval(code);
}

// ä½†ä»ç„¶å­˜åœ¨é£é™©ï¼Œåº”è¯¥å®Œå…¨é¿å…`,
    description: 'ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥æˆ–ä¸å¯ä¿¡æºçš„å­—ç¬¦ä¸²å¯èƒ½å¯¼è‡´ä»£ç æ³¨å…¥æ”»å‡»ã€‚'
  },
  {
    id: 'strict',
    title: 'ä¸¥æ ¼æ¨¡å¼ä¸‹çš„è¡Œä¸º',
    code: `'use strict';

// åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œeval æœ‰è‡ªå·±çš„ä½œç”¨åŸŸ
var x = 10;

function test() {
  var x = 20;
  eval('var x = 30; console.log(x);'); // 30
  console.log(x); // 20 - eval çš„å˜é‡ä¸ä¼šæ³„æ¼
}

test();
console.log(x); // 10

// å°è¯•ä½¿ç”¨ eval åˆ›å»ºå˜é‡ä¼šæŠ¥é”™
eval('y = 40;'); // ReferenceError: y is not defined`,
    description: 'ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œeval åˆ›å»ºçš„ä½œç”¨åŸŸä¸ä¼šå½±å“å¤–éƒ¨ä½œç”¨åŸŸï¼Œæä¾›äº†ä¸€å®šçš„å®‰å…¨æ€§æ”¹è¿›ã€‚'
  }
])

// with è¯­å¥ä¼˜ç¼ºç‚¹
const withPros = ref([
  'å‡å°‘é‡å¤çš„å¯¹è±¡å¼•ç”¨ï¼Œä½¿ä»£ç æ›´ç®€æ´',
  'åœ¨æŸäº›æ¨¡æ¿æˆ–DSLåœºæ™¯ä¸‹å¯ä»¥æä¾›æ›´è‡ªç„¶çš„è¯­æ³•',
  'å¯ä»¥æ¨¡æ‹Ÿå…¶ä»–è¯­è¨€çš„ä½œç”¨åŸŸç‰¹æ€§'
])

const withCons = ref([
  'ä¸¥é‡æ€§èƒ½é—®é¢˜ - é˜»æ­¢JavaScriptå¼•æ“ä¼˜åŒ–',
  'ä»£ç å¯è¯»æ€§å·® - éš¾ä»¥ç¡®å®šå˜é‡æ¥æº',
  'ä¸¥æ ¼æ¨¡å¼ä¸‹è¢«ç¦ç”¨ï¼Œå¯¼è‡´å…¼å®¹æ€§é—®é¢˜',
  'å¯èƒ½æ„å¤–åˆ›å»ºå…¨å±€å˜é‡',
  'è°ƒè¯•å›°éš¾ - å †æ ˆè·Ÿè¸ªä¸æ¸…æ™°',
  'å·²è¢«ç°ä»£JavaScriptå¼€å‘å¼ƒç”¨'
])

// eval å‡½æ•°ä¼˜ç¼ºç‚¹
const evalPros = ref([
  'åŠ¨æ€æ‰§è¡Œä»£ç ï¼Œæä¾›æå¤§çµæ´»æ€§',
  'å¯ä»¥ç”¨äºå®ç°REPLï¼ˆè¯»å–-æ±‚å€¼-è¾“å‡ºå¾ªç¯ï¼‰',
  'åœ¨æŸäº›å…ƒç¼–ç¨‹åœºæ™¯ä¸‹æœ‰ç”¨',
  'å¯ä»¥åŠ¨æ€ç”Ÿæˆå’Œæ‰§è¡Œå‡½æ•°'
])

const evalCons = ref([
  'ä¸¥é‡å®‰å…¨é£é™© - ä»£ç æ³¨å…¥æ”»å‡»',
  'æ€§èƒ½æå·® - æ— æ³•è¢«ç¼–è¯‘ä¼˜åŒ–',
  'ä»£ç éš¾ä»¥ç»´æŠ¤å’Œè°ƒè¯•',
  'å·¥å…·é“¾æ”¯æŒå·®ï¼ˆTypeScriptã€ESLintç­‰ï¼‰',
  'ä¸¥æ ¼æ¨¡å¼é™åˆ¶å…¶è¡Œä¸º',
  'å¤§å¤šæ•°æƒ…å†µä¸‹æœ‰æ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆ'
])

// with é€‚ç”¨åœºæ™¯
const withScenarios = ref([
  {
    id: 'template',
    title: 'æ¨¡æ¿å¼•æ“',
    description: 'åœ¨æŸäº›ç®€å•çš„æ¨¡æ¿ç³»ç»Ÿä¸­ï¼Œwith å¯ä»¥æä¾›æ›´ç®€æ´çš„å˜é‡è®¿é—®æ–¹å¼',
    icon: 'ğŸ“',
    tag: 'å†å²ç”¨é€”',
    tagType: 'historical',
    discouraged: true
  },
  {
    id: 'debugging',
    title: 'è°ƒè¯•å·¥å…·',
    description: 'åœ¨å¼€å‘å·¥å…·ä¸­ä¸´æ—¶æ£€æŸ¥å¯¹è±¡å±æ€§',
    icon: 'ğŸ›',
    tag: 'ç‰¹æ®Šæƒ…å†µ',
    tagType: 'special',
    discouraged: false
  },
  {
    id: 'dsl',
    title: 'é¢†åŸŸç‰¹å®šè¯­è¨€',
    description: 'å®ç°ç®€å•çš„DSLæ—¶æä¾›è‡ªç„¶çš„è¯­æ³•',
    icon: 'ğŸ”¤',
    tag: 'ä¸“å®¶åœºæ™¯',
    tagType: 'expert',
    discouraged: true
  },
  {
    id: 'legacy',
    title: 'é—ç•™ä»£ç ç»´æŠ¤',
    description: 'ç»´æŠ¤åŒ…å« with çš„è€ä»£ç åº“',
    icon: 'ğŸ›ï¸',
    tag: 'ä¸å¾—å·²',
    tagType: 'legacy',
    discouraged: false
  }
])

// å®‰å…¨æç¤º
const securityTips = ref([
  {
    id: 'input',
    title: 'æ°¸è¿œä¸è¦æ‰§è¡Œç”¨æˆ·è¾“å…¥',
    description: 'ç»å¯¹ä¸è¦å°†ç”¨æˆ·æä¾›çš„æ•°æ®ç›´æ¥ä¼ é€’ç»™ evalï¼Œè¿™ä¼šå¯¼è‡´ä¸¥é‡çš„ä»£ç æ³¨å…¥æ¼æ´ã€‚',
    icon: 'ğŸš«',
    level: 'critical',
    code: `// æå…¶å±é™©!
const userInput = getUserInput();
eval(userInput); // å¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«å®Œå…¨æ§åˆ¶`
  },
  {
    id: 'sandbox',
    title: 'ä½¿ç”¨æ²™ç®±ç¯å¢ƒ',
    description: 'å¦‚æœå¿…é¡»æ‰§è¡ŒåŠ¨æ€ä»£ç ï¼Œä½¿ç”¨ Web Workers æˆ– iframe æ²™ç®±æ¥éš”ç¦»æ‰§è¡Œç¯å¢ƒã€‚',
    icon: 'ğŸ–ï¸',
    level: 'advanced',
    code: `// åœ¨ Web Worker ä¸­æ‰§è¡Œ
const worker = new Worker('data:text/javascript,' +
  encodeURIComponent(code));`
  },
  {
    id: 'validation',
    title: 'ä¸¥æ ¼çš„è¾“å…¥éªŒè¯',
    description: 'å¯¹è¦æ‰§è¡Œçš„ä»£ç è¿›è¡Œä¸¥æ ¼çš„è¯­æ³•éªŒè¯å’Œç™½åå•è¿‡æ»¤ã€‚',
    icon: 'ğŸ”’',
    level: 'intermediate',
    code: `function safeEval(code) {
  // åªå…è®¸ç®€å•çš„æ•°å­¦è¡¨è¾¾å¼
  if (!/^[0-9+\\-*/().\\s]+$/.test(code)) {
    throw new Error('Invalid code');
  }
  return eval(code);
}`
  },
  {
    id: 'alternatives',
    title: 'ä¼˜å…ˆä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ',
    description: 'åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒFunction æ„é€ å‡½æ•°æˆ– JSON.parse æ˜¯æ›´å®‰å…¨çš„é€‰æ‹©ã€‚',
    icon: 'ğŸ”„',
    level: 'recommended',
    code: `// ä½¿ç”¨ Function è€Œä¸æ˜¯ eval
const add = new Function('a', 'b', 'return a + b');
add(1, 2); // 3`
  }
])

// æ›¿ä»£æ–¹æ¡ˆ
const alternatives = ref([
  {
    id: 'function',
    title: 'Function æ„é€ å‡½æ•°',
    type: 'eval æ›¿ä»£',
    description: 'åˆ›å»ºæ–°å‡½æ•°è€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œä»£ç ï¼Œæä¾›æ›´å¥½çš„éš”ç¦»æ€§',
    example: `// è€Œä¸æ˜¯ eval('function add(a, b) { return a + b }')
const add = new Function('a', 'b', 'return a + b;');
console.log(add(1, 2)); // 3`,
    benefits: ['ä½œç”¨åŸŸéš”ç¦»', 'ç¨å¥½çš„æ€§èƒ½', 'æ›´æ¸…æ™°çš„è¯­ä¹‰']
  },
  {
    id: 'json',
    title: 'JSON.parse',
    type: 'eval æ›¿ä»£',
    description: 'ç”¨äºè§£æJSONæ•°æ®ï¼Œæ¯” eval æ›´å®‰å…¨ä¸”æ€§èƒ½æ›´å¥½',
    example: `// è€Œä¸æ˜¯ eval('(' + jsonString + ')')
const data = JSON.parse('{"name": "John", "age": 30}');
console.log(data.name); // "John"`,
    benefits: ['å®Œå…¨å®‰å…¨', 'é«˜æ€§èƒ½', 'æ ‡å‡†æ–¹æ³•']
  },
  {
    id: 'destructuring',
    title: 'è§£æ„èµ‹å€¼',
    type: 'with æ›¿ä»£',
    description: 'ä½¿ç”¨å¯¹è±¡è§£æ„æ¥ç®€åŒ–å¯¹è±¡å±æ€§çš„è®¿é—®',
    example: `// è€Œä¸æ˜¯ with(obj) { console.log(a, b, c) }
const { a, b, c } = obj;
console.log(a, b, c);`,
    benefits: ['è¯­æ³•æ¸…æ™°', 'å¯ä¼˜åŒ–', 'æ— å‰¯ä½œç”¨']
  },
  {
    id: 'proxy',
    title: 'Proxy å¯¹è±¡',
    type: 'with æ›¿ä»£',
    description: 'åˆ›å»ºä»£ç†å¯¹è±¡æ¥æ§åˆ¶å±æ€§è®¿é—®è¡Œä¸º',
    example: `const obj = { a: 1, b: 2 };
const handler = {
  get(target, prop) {
    console.log(\`è®¿é—®å±æ€§: \${prop}\`);
    return target[prop];
  }
};
const proxy = new Proxy(obj, handler);
console.log(proxy.a); // è®°å½•è®¿é—®å¹¶è¿”å› 1`,
    benefits: ['å®Œå…¨æ§åˆ¶', 'æ— å‰¯ä½œç”¨', 'ç°ä»£API']
  }
])

// æœ€ä½³å®è·µ
const bestPractices = ref([
  {
    id: 'avoid',
    title: 'å°½é‡é¿å…ä½¿ç”¨',
    description: 'åœ¨99%çš„æƒ…å†µä¸‹ï¼Œéƒ½æœ‰æ›´å¥½ã€æ›´å®‰å…¨ã€æ€§èƒ½æ›´é«˜çš„æ›¿ä»£æ–¹æ¡ˆã€‚åªæœ‰åœ¨å®Œå…¨ç†è§£é£é™©ä¸”æ²¡æœ‰å…¶ä»–é€‰æ‹©æ—¶æ‰è€ƒè™‘ä½¿ç”¨ã€‚',
    icon: 'ğŸš«'
  },
  {
    id: 'strict',
    title: 'å¯ç”¨ä¸¥æ ¼æ¨¡å¼',
    description: 'ä¸¥æ ¼æ¨¡å¼å¯¹ eval å’Œ with æœ‰é¢å¤–é™åˆ¶ï¼Œå¯ä»¥å‡å°‘ä¸€äº›å®‰å…¨éšæ‚£ã€‚',
    icon: 'ğŸ“'
  },
  {
    id: 'lint',
    title: 'ä½¿ç”¨ä»£ç æ£€æŸ¥å·¥å…·',
    description: 'é…ç½® ESLint çš„ no-eval å’Œ no-with è§„åˆ™ï¼Œåœ¨ä»£ç å®¡æŸ¥ä¸­æ•è·è¿™äº›å±é™©ç”¨æ³•ã€‚',
    icon: 'ğŸ”'
  },
  {
    id: 'review',
    title: 'ä»£ç å®¡æŸ¥',
    description: 'åœ¨å›¢é˜Ÿä¸­å»ºç«‹ä»£ç å®¡æŸ¥æµç¨‹ï¼Œç‰¹åˆ«å…³æ³¨ä»»ä½•åŠ¨æ€ä»£ç æ‰§è¡Œçš„ä½¿ç”¨ã€‚',
    icon: 'ğŸ‘¥'
  },
  {
    id: 'education',
    title: 'å›¢é˜Ÿæ•™è‚²',
    description: 'ç¡®ä¿å›¢é˜Ÿæˆå‘˜ç†è§£è¿™äº›ç‰¹æ€§çš„é£é™©å’Œæ›¿ä»£æ–¹æ¡ˆã€‚',
    icon: 'ğŸ“š'
  },
  {
    id: 'refactor',
    title: 'é‡æ„é—ç•™ä»£ç ',
    description: 'æœ‰è®¡åˆ’åœ°é‡æ„åŒ…å« with æˆ–å±é™© eval ç”¨æ³•çš„é—ç•™ä»£ç ã€‚',
    icon: 'ğŸ”§'
  }
])
</script>

<style lang="less" scoped>
.js-with-eval {
  min-height: 100vh;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  font-family: 'SF Pro Text', 'Segoe UI', system-ui, -apple-system, sans-serif;
  color: #2d3748;
  line-height: 1.6;
}

.page-header {
  background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
  color: white;
  padding: 3rem 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="rgba(255,255,255,0.1)"><polygon points="0,0 1000,50 1000,100 0,100"/></svg>') no-repeat;
    background-size: cover;
  }

  .header-content {
    position: relative;
    z-index: 2;
    max-width: 800px;
    margin: 0 auto;
  }

  h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #fff 0%, #f1f5f9 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .subtitle {
    font-size: 1.2rem;
    font-weight: 400;
    margin-bottom: 2rem;
    opacity: 0.9;
  }

  .header-stats {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-top: 2rem;

    .stat {
      text-align: center;

      .stat-number {
        display: block;
        font-size: 2rem;
        margin-bottom: 0.25rem;
      }

      .stat-label {
        font-size: 0.9rem;
        opacity: 0.8;
        font-weight: 500;
      }
    }
  }
}

.content {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.warning-banner {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  border: 2px solid #f59e0b;
  border-radius: 12px;
  margin-bottom: 3rem;
  padding: 1.5rem;

  .warning-content {
    display: flex;
    align-items: flex-start;
    gap: 1rem;

    .warning-icon {
      font-size: 2rem;
      flex-shrink: 0;
    }

    .warning-text {
      flex: 1;

      h3 {
        color: #92400e;
        margin-bottom: 0.5rem;
        font-size: 1.2rem;
      }

      p {
        color: #92400e;
        margin: 0;
        line-height: 1.5;

        code {
          background: rgba(139, 69, 19, 0.1);
          color: #92400e;
          padding: 0.2rem 0.4rem;
          border-radius: 4px;
          font-weight: 600;
        }
      }
    }
  }
}

section {
  margin-bottom: 3rem;
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  border: 1px solid #e5e7eb;
}

.section-title {
  font-size: 1.8rem;
  font-weight: 700;
  text-align: center;
  margin-bottom: 2rem;
  color: #374151;
  position: relative;

  &::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 50px;
    height: 3px;
    background: linear-gradient(135deg, #6b7280, #4b5563);
    border-radius: 2px;
  }
}

// å¯¹æ¯”è¡¨æ ¼æ ·å¼
.comparison-section {
  .comparison-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .table-header {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    background: #4b5563;
    color: white;
    font-weight: 600;

    .header-cell {
      padding: 1rem;
      text-align: center;
      font-size: 1.1rem;

      &:first-child {
        text-align: left;
      }
    }
  }

  .table-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    border-bottom: 1px solid #e5e7eb;

    &:last-child {
      border-bottom: none;
    }

    .row-cell {
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;

      &.feature-cell {
        font-weight: 600;
        color: #374151;
        background: #f9fafb;
      }

      &.highlight-warning {
        background: #fef2f2;
      }

      .cell-content {
        flex: 1;
      }

      .cell-tag {
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        margin-left: 0.5rem;

        &.info {
          background: #dbeafe;
          color: #1e40af;
        }

        &.warning {
          background: #fef3c7;
          color: #92400e;
        }

        &.error {
          background: #fee2e2;
          color: #dc2626;
        }
      }
    }
  }
}

// å†…å®¹ç½‘æ ¼å¸ƒå±€
.content-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;

  @media (max-width: 968px) {
    grid-template-columns: 1fr;
  }
}

.with-section, .eval-section {
  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #e5e7eb;

    h2 {
      font-size: 1.5rem;
      color: #374151;
      margin: 0;
    }

    .danger-level {
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 700;
      color: white;

      &.level-high {
        background: #dc2626;
      }

      &.level-critical {
        background: #7f1d1d;
      }
    }
  }
}

.definition-card, .example-card, .usage-card, .security-card {
  margin-bottom: 2rem;

  h3 {
    font-size: 1.2rem;
    color: #374151;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #e5e7eb;
  }

  p {
    color: #6b7280;
    line-height: 1.6;
    margin-bottom: 1rem;
  }
}

.example-card {
  .example-tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }

  .example-tab {
    padding: 0.5rem 1rem;
    background: #f3f4f6;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 0.9rem;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    transition: all 0.2s ease;

    &:hover {
      background: #e5e7eb;
    }

    &.active {
      background: #4b5563;
      color: white;
      border-color: #4b5563;
    }
  }

  .example-description {
    font-size: 0.9rem;
    color: #6b7280;
    margin-top: 1rem;
    line-height: 1.5;
  }
}

.code-block {
  background: #1f2937;
  border-radius: 8px;
  overflow: hidden;
  margin: 1rem 0;

  pre {
    margin: 0;
    padding: 1.5rem;
    overflow-x: auto;
  }

  code {
    color: #e5e7eb;
    font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
  }
}

.pros-cons-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 2rem;

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }

  .pros-card, .cons-card {
    background: #f9fafb;
    border-radius: 8px;
    padding: 1.5rem;
    border-left: 4px solid;

    h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
  }

  .pros-card {
    border-left-color: #10b981;

    h3 {
      color: #065f46;
    }
  }

  .cons-card {
    border-left-color: #ef4444;

    h3 {
      color: #7f1d1d;
    }
  }

  ul {
    list-style: none;
    padding: 0;
    margin: 0;

    li {
      padding: 0.5rem 0;
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;

      .check-icon, .warning-icon {
        flex-shrink: 0;
        margin-top: 0.1rem;
      }
    }
  }
}

.usage-card {
  .scenarios {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .scenario-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 8px;
    border-left: 4px solid #d1d5db;
    transition: all 0.2s ease;

    &.discouraged {
      background: #fef2f2;
      border-left-color: #fca5a5;
    }

    .scenario-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .scenario-content {
      flex: 1;

      h4 {
        margin: 0 0 0.5rem 0;
        color: #374151;
        font-size: 1rem;
      }

      p {
        margin: 0;
        color: #6b7280;
        font-size: 0.9rem;
        line-height: 1.5;
      }
    }

    .scenario-tag {
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      flex-shrink: 0;

      &.historical {
        background: #f3f4f6;
        color: #6b7280;
      }

      &.special {
        background: #dbeafe;
        color: #1e40af;
      }

      &.expert {
        background: #fef3c7;
        color: #92400e;
      }

      &.legacy {
        background: #e5e7eb;
        color: #374151;
      }
    }
  }
}

.security-card {
  .security-tips {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .security-tip {
    padding: 1.5rem;
    border-radius: 8px;
    border-left: 4px solid;

    &.critical {
      background: #fef2f2;
      border-left-color: #dc2626;
    }

    &.advanced {
      background: #eff6ff;
      border-left-color: #2563eb;
    }

    &.intermediate {
      background: #f0fdf4;
      border-left-color: #16a34a;
    }

    &.recommended {
      background: #fffbeb;
      border-left-color: #d97706;
    }

    .tip-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;

      .tip-icon {
        font-size: 1.2rem;
      }

      h4 {
        margin: 0;
        color: #374151;
        font-size: 1rem;
      }
    }

    p {
      margin: 0 0 1rem 0;
      color: #6b7280;
      line-height: 1.5;
    }

    .tip-code {
      background: #1f2937;
      border-radius: 6px;
      overflow: hidden;

      pre {
        margin: 0;
        padding: 1rem;
      }

      code {
        color: #e5e7eb;
        font-family: 'Fira Code', monospace;
        font-size: 0.8rem;
      }
    }
  }
}

.alternatives-section {
  .alternatives-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .alternative-card {
    background: #f9fafb;
    border-radius: 8px;
    padding: 1.5rem;
    border: 1px solid #e5e7eb;
    transition: all 0.2s ease;

    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .alt-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;

      h3 {
        margin: 0;
        color: #374151;
        font-size: 1.1rem;
      }

      .alt-type {
        background: #e5e7eb;
        color: #6b7280;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
      }
    }

    .alt-description {
      color: #6b7280;
      margin-bottom: 1rem;
      line-height: 1.5;
    }

    .alt-example {
      h4 {
        margin: 0 0 0.5rem 0;
        color: #374151;
        font-size: 0.9rem;
      }
    }

    .alt-benefits {
      margin-top: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;

      .benefit-tag {
        background: #dbeafe;
        color: #1e40af;
        padding: 0.25rem 0.5rem;
        border-radius: 8px;
        font-size: 0.75rem;
        font-weight: 500;
      }
    }
  }
}

.best-practices-section {
  .practices-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .practice-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1.5rem;
    background: #f9fafb;
    border-radius: 8px;
    border-left: 4px solid #4b5563;

    .practice-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .practice-content {
      flex: 1;

      h3 {
        margin: 0 0 0.5rem 0;
        color: #374151;
        font-size: 1rem;
      }

      p {
        margin: 0;
        color: #6b7280;
        line-height: 1.5;
        font-size: 0.9rem;
      }
    }
  }
}

.page-footer {
  background: #374151;
  color: white;
  padding: 3rem 2rem;
  margin-top: 4rem;

  .footer-content {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;

    @media (max-width: 768px) {
      grid-template-columns: 1fr;
      text-align: center;
    }
  }

  .footer-info {
    h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: #fff;
    }

    p {
      color: #d1d5db;
      line-height: 1.6;
      margin: 0;
    }
  }

  .footer-links {
    display: flex;
    gap: 2rem;
    justify-content: flex-end;

    @media (max-width: 768px) {
      justify-content: center;
    }

    a {
      color: #d1d5db;
      text-decoration: none;
      transition: color 0.3s ease;
      font-weight: 500;

      &:hover {
        color: #fff;
      }
    }
  }
}

// å“åº”å¼è®¾è®¡
@media (max-width: 768px) {
  .page-header h1 {
    font-size: 2.2rem;
  }

  .content {
    padding: 1rem;
  }

  section {
    padding: 1.5rem;
  }

  .header-stats {
    gap: 1.5rem !important;

    .stat-number {
      font-size: 1.5rem !important;
    }
  }

  .comparison-table {
    .table-header, .table-row {
      grid-template-columns: 1fr;

      .header-cell, .row-cell {
        padding: 0.75rem;
      }
    }
  }
}
</style>
