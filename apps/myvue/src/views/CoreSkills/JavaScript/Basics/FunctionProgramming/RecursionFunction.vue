<template>
  <div class="recursion-container">
    <header class="header">
      <h1 class="title">JavaScript å‡½æ•°é€’å½’</h1>
      <p class="subtitle">æ·±å…¥ç†è§£é€’å½’çš„æ¦‚å¿µä¸åº”ç”¨</p>
    </header>

    <div class="content-section">
      <h2 class="section-title">ğŸ“š é€’å½’åŸºæœ¬æ¦‚å¿µ</h2>
      <div class="concept-card">
        <p>é€’å½’æ˜¯æŒ‡<strong>å‡½æ•°ç›´æ¥æˆ–é—´æ¥è°ƒç”¨è‡ªèº«</strong>çš„ç¼–ç¨‹æŠ€å·§ã€‚ä¸€ä¸ªé€’å½’å‡½æ•°é€šå¸¸åŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p>
        <div class="recursion-parts">
          <div class="part">
            <div class="part-icon">â¹ï¸</div>
            <h3>åŸºçº¿æ¡ä»¶ (Base Case)</h3>
            <p>é€’å½’ç»ˆæ­¢çš„æ¡ä»¶ï¼Œé˜²æ­¢æ— é™é€’å½’</p>
          </div>
          <div class="part">
            <div class="part-icon">ğŸ”</div>
            <h3>é€’å½’æ¡ä»¶ (Recursive Case)</h3>
            <p>å‡½æ•°è°ƒç”¨è‡ªèº«çš„æ¡ä»¶ï¼Œå‘åŸºçº¿æ¡ä»¶æ¨è¿›</p>
          </div>
        </div>
        <div class="simple-example">
          <h4>ç®€å•ç¤ºä¾‹ï¼šè®¡ç®—é˜¶ä¹˜</h4>
          <pre><code>function factorial(n) {
  if (n <= 1) return 1; // åŸºçº¿æ¡ä»¶
  return n * factorial(n - 1); // é€’å½’æ¡ä»¶
}</code></pre>
        </div>
      </div>
    </div>

    <div class="content-section">
      <h2 class="section-title">ğŸ’¡ é€’å½’çš„ä½œç”¨ä¸ä»·å€¼</h2>
      <div class="value-grid">
        <div class="value-card">
          <div class="value-icon">âœ¨</div>
          <h3>ç®€åŒ–ä»£ç </h3>
          <p>ç”¨ç®€æ´çš„ä»£ç è¡¨è¾¾å¤æ‚çš„ç®—æ³•é€»è¾‘</p>
        </div>
        <div class="value-card">
          <div class="value-icon">ğŸŒ³</div>
          <h3>å¤„ç†åµŒå¥—ç»“æ„</h3>
          <p>å¤©ç„¶é€‚åˆå¤„ç†æ ‘å½¢ã€åµŒå¥—ç­‰é€’å½’æ•°æ®ç»“æ„</p>
        </div>
        <div class="value-card">
          <div class="value-icon">ğŸ§©</div>
          <h3>åˆ†æ²»ç­–ç•¥</h3>
          <p>å°†å¤§é—®é¢˜åˆ†è§£ä¸ºç›¸åŒçš„å°é—®é¢˜è§£å†³</p>
        </div>
        <div class="value-card">
          <div class="value-icon">â™¾ï¸</div>
          <h3>æ•°å­¦å»ºæ¨¡</h3>
          <p>ç›´æ¥å®ç°æ•°å­¦ä¸­çš„é€’å½’å®šä¹‰å’Œå…¬å¼</p>
        </div>
      </div>
    </div>

    <div class="content-section">
      <h2 class="section-title">ğŸ› ï¸ é€’å½’çš„ä½¿ç”¨æ–¹æ³•</h2>
      <div class="usage-steps">
        <div class="step">
          <div class="step-number">1</div>
          <div class="step-content">
            <h3>å®šä¹‰åŸºçº¿æ¡ä»¶</h3>
            <p>ç¡®å®šé€’å½’ä½•æ—¶åº”è¯¥åœæ­¢ï¼Œé¿å…æ— é™é€’å½’</p>
            <pre><code>if (n === 0) return 1;</code></pre>
          </div>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <div class="step-content">
            <h3>å®šä¹‰é€’å½’æ¡ä»¶</h3>
            <p>å°†é—®é¢˜åˆ†è§£ä¸ºæ›´å°çš„ç›¸åŒé—®é¢˜</p>
            <pre><code>return n * factorial(n - 1);</code></pre>
          </div>
        </div>
        <div class="step">
          <div class="step-number">3</div>
          <div class="step-content">
            <h3>ç¡®ä¿å‘åŸºçº¿æ¨è¿›</h3>
            <p>æ¯æ¬¡é€’å½’è°ƒç”¨éƒ½æ›´æ¥è¿‘åŸºçº¿æ¡ä»¶</p>
            <pre><code>// n-1 ç¡®ä¿æœ€ç»ˆä¼šè¾¾åˆ° n === 0</code></pre>
          </div>
        </div>
        <div class="step">
          <div class="step-number">4</div>
          <div class="step-content">
            <h3>å¤„ç†è¿”å›å€¼</h3>
            <p>ç»„åˆæˆ–ä¼ é€’é€’å½’è°ƒç”¨çš„ç»“æœ</p>
            <pre><code>return current + recursiveCall(rest);</code></pre>
          </div>
        </div>
      </div>
    </div>

    <div class="content-section">
      <h2 class="section-title">ğŸŒ é€’å½’çš„å¸¸è§åº”ç”¨åœºæ™¯</h2>
      <div class="scenario-grid">
        <div class="scenario-card">
          <h3>æ•°æ®ç»“æ„å¤„ç†</h3>
          <ul>
            <li>æ ‘å½¢ç»“æ„çš„éå†ï¼ˆDOMæ ‘ã€æ–‡ä»¶ç³»ç»Ÿï¼‰</li>
            <li>é“¾è¡¨æ“ä½œ</li>
            <li>å›¾ç®—æ³•ï¼ˆæ·±åº¦ä¼˜å…ˆæœç´¢ï¼‰</li>
          </ul>
          <pre><code>function traverse(node) {
  // å¤„ç†å½“å‰èŠ‚ç‚¹
  node.children.forEach(child => {
    traverse(child); // é€’å½’å¤„ç†å­èŠ‚ç‚¹
  });
}</code></pre>
        </div>
        <div class="scenario-card">
          <h3>æ•°å­¦è®¡ç®—</h3>
          <ul>
            <li>é˜¶ä¹˜ã€æ–æ³¢é‚£å¥‘æ•°åˆ—</li>
            <li>ç»„åˆæ•°å­¦é—®é¢˜</li>
            <li>åˆ†å½¢å›¾å½¢ç”Ÿæˆ</li>
          </ul>
          <pre><code>function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}</code></pre>
        </div>
        <div class="scenario-card">
          <h3>ç®—æ³•å®ç°</h3>
          <ul>
            <li>åˆ†æ²»ç®—æ³•ï¼ˆå¿«é€Ÿæ’åºã€å½’å¹¶æ’åºï¼‰</li>
            <li>å›æº¯ç®—æ³•ï¼ˆå…«çš‡åã€æ•°ç‹¬ï¼‰</li>
            <li>åŠ¨æ€è§„åˆ’é—®é¢˜</li>
          </ul>
          <pre><code>function quickSort(arr) {
  if (arr.length <= 1) return arr;
  const pivot = arr[0];
  const left = [], right = [];
  // åˆ†åŒºé€»è¾‘...
  return [...quickSort(left), pivot, ...quickSort(right)];
}</code></pre>
        </div>
        <div class="scenario-card">
          <h3>ä¸šåŠ¡é€»è¾‘</h3>
          <ul>
            <li>å¤šçº§èœå•æ¸²æŸ“</li>
            <li>æ— é™è¯„è®ºåµŒå¥—</li>
            <li>æƒé™è·¯ç”±ç”Ÿæˆ</li>
          </ul>
          <pre><code>function renderMenu(items) {
  return items.map(item => (
    &lt;div key={item.id}>
      {item.name}
      {item.children && renderMenu(item.children)}
    &lt;/div>
  ));
}</code></pre>
        </div>
      </div>
    </div>

    <div class="content-section">
      <h2 class="section-title">âš–ï¸ é€’å½’çš„ä¼˜ç¼ºç‚¹</h2>
      <div class="pros-cons">
        <div class="pros">
          <h3>ä¼˜ç‚¹</h3>
          <ul>
            <li><strong>ä»£ç ç®€æ´</strong> - ç”¨å°‘é‡ä»£ç è¡¨è¾¾å¤æ‚é€»è¾‘</li>
            <li><strong>å¯è¯»æ€§å¼º</strong> - ç›´æ¥åæ˜ é—®é¢˜çš„é€’å½’æ€§è´¨</li>
            <li><strong>åˆ†æ²»ç­–ç•¥</strong> - è‡ªç„¶åˆ†è§£å¤æ‚é—®é¢˜</li>
            <li><strong>å‡½æ•°å¼å‹å¥½</strong> - æ— å‰¯ä½œç”¨ï¼Œçº¯å‡½æ•°å®ç°</li>
          </ul>
        </div>
        <div class="cons">
          <h3>ç¼ºç‚¹</h3>
          <ul>
            <li><strong>æ€§èƒ½å¼€é”€</strong> - å‡½æ•°è°ƒç”¨æ ˆæ¶ˆè€—å†…å­˜</li>
            <li><strong>æ ˆæº¢å‡ºé£é™©</strong> - æ·±åº¦é€’å½’å¯èƒ½å¯¼è‡´è°ƒç”¨æ ˆæº¢å‡º</li>
            <li><strong>è°ƒè¯•å›°éš¾</strong> - å¤šå±‚è°ƒç”¨æ ˆéš¾ä»¥è·Ÿè¸ª</li>
            <li><strong>å¯èƒ½é‡å¤è®¡ç®—</strong> - å¦‚æ–æ³¢é‚£å¥‘çš„æœ´ç´ é€’å½’å®ç°</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="content-section">
      <h2 class="section-title">ğŸ›¡ï¸ é€’å½’ä¼˜åŒ–æŠ€å·§</h2>
      <div class="optimization-grid">
        <div class="optimization-card">
          <h3>å°¾è°ƒç”¨ä¼˜åŒ–</h3>
          <p>ç¡®ä¿é€’å½’è°ƒç”¨æ˜¯å‡½æ•°çš„æœ€åæ“ä½œ</p>
          <pre><code>// éå°¾é€’å½’
function factorial(n) {
  if (n <= 1) return 1;
  return n * factorial(n - 1); // æœ€åæ“ä½œæ˜¯ä¹˜æ³•
}

// å°¾é€’å½’ä¼˜åŒ–ç‰ˆ
function factorial(n, acc = 1) {
  if (n <= 1) return acc;
  return factorial(n - 1, n * acc); // æœ€åæ“ä½œæ˜¯é€’å½’è°ƒç”¨
}</code></pre>
        </div>
        <div class="optimization-card">
          <h3>è®°å¿†åŒ– (Memoization)</h3>
          <p>ç¼“å­˜å·²è®¡ç®—ç»“æœé¿å…é‡å¤è®¡ç®—</p>
          <pre><code>const memo = {};
function fibonacci(n) {
  if (n in memo) return memo[n];
  if (n <= 1) return n;
  memo[n] = fibonacci(n - 1) + fibonacci(n - 2);
  return memo[n];
}</code></pre>
        </div>
        <div class="optimization-card">
          <h3>è¿­ä»£æ›¿ä»£</h3>
          <p>ç”¨å¾ªç¯é‡å†™é€’å½’ç®—æ³•</p>
          <pre><code>// é€’å½’ç‰ˆ
function sum(n) {
  if (n === 0) return 0;
  return n + sum(n - 1);
}

// è¿­ä»£ç‰ˆ
function sum(n) {
  let total = 0;
  for (let i = 1; i <= n; i++) {
    total += i;
  }
  return total;
}</code></pre>
        </div>
        <div class="optimization-card">
          <h3>å°¾é€’å½’æ¶ˆé™¤</h3>
          <p>ä½¿ç”¨"è¹¦åºŠ"å‡½æ•°é¿å…æ ˆæº¢å‡º</p>
          <pre><code>function trampoline(fn) {
  while (typeof fn === 'function') {
    fn = fn();
  }
  return fn;
}

function factorial(n, acc = 1) {
  if (n <= 1) return acc;
  return () => factorial(n - 1, n * acc);
}

// ä½¿ç”¨
trampoline(factorial(100000));</code></pre>
        </div>
      </div>
    </div>

    <footer class="footer">
      <p>é€’å½’æ˜¯å¼ºå¤§çš„ç¼–ç¨‹å·¥å…·ï¼Œåˆç†ä½¿ç”¨å¯ä»¥å†™å‡ºä¼˜é›…é«˜æ•ˆçš„ä»£ç </p>
    </footer>
  </div>
</template>

<script setup lang="ts">
// è¿™é‡Œå¯ä»¥æ·»åŠ ç»„ä»¶é€»è¾‘ï¼Œå¦‚æœæœ‰çš„è¯
</script>

<style lang="less" scoped>

.recursion-container {
  max-width: 1000px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  color: #2c3e50;
  background-color: #fff;
  line-height: 1.6;
}

.header {
  text-align: center;
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 1px solid #eaecef;

  .title {
    font-size: 2.2rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #2c3e50;
    background: linear-gradient(90deg, #42b983, #3498db);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .subtitle {
    font-size: 1.1rem;
    color: #7f8c8d;
    font-weight: 400;
  }
}

.content-section {
  margin-bottom: 2.5rem;

  .section-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 1.2rem;
    color: #2c3e50;
    border-left: 4px solid #42b983;
    padding-left: 0.8rem;
  }
}

.concept-card {
  background-color: #f8f9fa;
  padding: 1.5rem;
  border-radius: 8px;
  margin-bottom: 1.5rem;

  p {
    margin: 0.5rem 0;

    strong {
      color: #e74c3c;
    }
  }
}

.recursion-parts {
  display: flex;
  gap: 1.5rem;
  margin: 1.5rem 0;

  .part {
    flex: 1;
    background-color: #fff;
    border-radius: 8px;
    padding: 1.2rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    border: 1px solid #eaecef;
    text-align: center;

    .part-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    h3 {
      margin: 0.5rem 0;
      color: #3498db;
    }

    p {
      color: #7f8c8d;
      font-size: 0.9rem;
    }
  }
}

.simple-example {
  margin-top: 1.5rem;

  h4 {
    margin: 0 0 0.8rem;
    color: #2c3e50;
    font-size: 1.1rem;
  }

  pre {
    background-color: #282c34;
    padding: 1rem;
    border-radius: 6px;
    overflow-x: auto;

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      color: #abb2bf;
      font-size: 0.9rem;
    }
  }
}

.value-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.2rem;
  margin: 1.5rem 0;
}

.value-card {
  background-color: #fff;
  border-radius: 8px;
  padding: 1.2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border: 1px solid #eaecef;
  text-align: center;
  transition: transform 0.2s;

  &:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .value-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  h3 {
    margin: 0.5rem 0;
    color: #2c3e50;
    font-size: 1.1rem;
  }

  p {
    color: #7f8c8d;
    font-size: 0.9rem;
    margin: 0;
  }
}

.usage-steps {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.2rem;
  margin: 1.5rem 0;
}

.step {
  background-color: #fff;
  border-radius: 8px;
  padding: 1.2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border: 1px solid #eaecef;

  .step-number {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    background-color: #42b983;
    color: white;
    border-radius: 50%;
    font-weight: 600;
    margin-bottom: 0.8rem;
  }

  h3 {
    margin: 0 0 0.5rem;
    color: #2c3e50;
    font-size: 1.1rem;
  }

  p {
    color: #7f8c8d;
    font-size: 0.9rem;
    margin: 0 0 0.8rem;
  }

  pre {
    background-color: #f8f9fa;
    padding: 0.8rem;
    border-radius: 4px;
    overflow-x: auto;

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.8rem;
      color: #333;
    }
  }
}

.scenario-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.2rem;
  margin: 1.5rem 0;
}

.scenario-card {
  background-color: #fff;
  border-radius: 8px;
  padding: 1.2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border: 1px solid #eaecef;

  h3 {
    margin: 0 0 0.8rem;
    color: #3498db;
    font-size: 1.1rem;
  }

  ul {
    padding-left: 1.2rem;
    margin: 0 0 1rem;

    li {
      margin-bottom: 0.3rem;
      font-size: 0.9rem;
    }
  }

  pre {
    background-color: #f8f9fa;
    padding: 0.8rem;
    border-radius: 4px;
    overflow-x: auto;

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.8rem;
      color: #333;
    }
  }
}

.pros-cons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin: 1.5rem 0;

  .pros, .cons {
    background-color: #fff;
    border-radius: 8px;
    padding: 1.2rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    border: 1px solid #eaecef;

    h3 {
      margin: 0 0 0.8rem;
      color: #2c3e50;
      font-size: 1.2rem;
      border-bottom: 2px solid;
      padding-bottom: 0.5rem;
    }

    ul {
      padding-left: 1.2rem;
      margin: 0;

      li {
        margin-bottom: 0.5rem;
        font-size: 0.9rem;

        strong {
          color: #e74c3c;
        }
      }
    }
  }

  .pros h3 {
    border-color: #42b983;
  }

  .cons h3 {
    border-color: #e74c3c;
  }
}

.optimization-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.2rem;
  margin: 1.5rem 0;
}

.optimization-card {
  background-color: #fff;
  border-radius: 8px;
  padding: 1.2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border: 1px solid #eaecef;

  h3 {
    margin: 0 0 0.8rem;
    color: #2c3e50;
    font-size: 1.1rem;
  }

  p {
    color: #7f8c8d;
    font-size: 0.9rem;
    margin: 0 0 0.8rem;
  }

  pre {
    background-color: #f8f9fa;
    padding: 0.8rem;
    border-radius: 4px;
    overflow-x: auto;

    code {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 0.8rem;
      color: #333;
    }
  }
}

.footer {
  text-align: center;
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid #eaecef;
  color: #7f8c8d;
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .recursion-container {
    padding: 1rem;
  }

  .value-grid, .usage-steps, .scenario-grid, .optimization-grid {
    grid-template-columns: 1fr;
  }

  .pros-cons {
    grid-template-columns: 1fr;
  }

  .header .title {
    font-size: 1.8rem;
  }
}
</style>
