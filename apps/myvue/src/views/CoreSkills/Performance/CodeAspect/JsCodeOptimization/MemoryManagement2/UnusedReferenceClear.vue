<template>
  <div class="cleanup-container">
    <header class="header">
      <h1>JavaScript èµ„æºæ¸…ç†æŒ‡å—</h1>
      <p>é¿å…å†…å­˜æ³„æ¼ï¼Œæå‡åº”ç”¨æ€§èƒ½</p>
    </header>

    <div class="stats-bar">
      <div class="stat-card">
        <div class="stat-value">70%</div>
        <div class="stat-label">å†…å­˜æ³„æ¼ç”±æœªæ¸…ç†èµ„æºå¼•èµ·</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">12+</div>
        <div class="stat-label">éœ€è¦æ¸…ç†çš„èµ„æºç±»å‹</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">40%</div>
        <div class="stat-label">æ€§èƒ½é—®é¢˜å¯ç”±æ­¤è§£å†³</div>
      </div>
    </div>

    <div class="content-section">
      <div class="section-header">
        <div class="icon">âš ï¸</div>
        <h2>ä¸ºä»€ä¹ˆéœ€è¦æ¸…ç†èµ„æºï¼Ÿ</h2>
      </div>

      <div class="leak-demonstration">
        <div class="leak-causes">
          <h3>æœªæ¸…ç†èµ„æºçš„åæœ</h3>
          <ul>
            <li><span class="badge high">å†…å­˜æ³„æ¼</span> åº”ç”¨å†…å­˜ä½¿ç”¨æŒç»­å¢é•¿</li>
            <li><span class="badge medium">æ€§èƒ½ä¸‹é™</span> åƒåœ¾å›æ”¶é¢‘ç¹è¿è¡Œ</li>
            <li><span class="badge high">å“åº”å˜æ…¢</span> ç•Œé¢å¡é¡¿ï¼Œäº¤äº’å»¶è¿Ÿ</li>
            <li><span class="badge critical">åº”ç”¨å´©æºƒ</span> å†…å­˜è€—å°½å¯¼è‡´é¡µé¢å´©æºƒ</li>
            <li><span class="badge medium">ç”µæ± æ¶ˆè€—</span> ç§»åŠ¨è®¾å¤‡ç”µæ± å¿«é€Ÿè€—å°½</li>
          </ul>
        </div>

        <div class="leak-visual">
          <div class="memory-chart">
            <div class="chart">
              <div class="line leak-line"></div>
              <div class="line normal-line"></div>
            </div>
            <div class="chart-labels">
              <div class="label">å†…å­˜ä½¿ç”¨</div>
              <div class="legend">
                <span class="leak-legend"></span> æœªæ¸…ç†èµ„æº
                <span class="normal-legend"></span> æ­£å¸¸åº”ç”¨
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="resource-section">
      <div class="section-header">
        <div class="icon">ğŸ§¹</div>
        <h2>éœ€è¦æ¸…ç†çš„èµ„æºç±»å‹</h2>
      </div>

      <div class="resource-grid">
        <div
          v-for="(resource, index) in resources"
          :key="index"
          class="resource-card"
          :class="resource.type"
        >
          <div class="resource-header">
            <div class="resource-icon">{{ resource.icon }}</div>
            <h3>{{ resource.title }}</h3>
          </div>
          <div class="resource-content">
            <p>{{ resource.description }}</p>

            <div class="cleanup-methods">
              <h4>æ¸…ç†æ–¹æ³•ï¼š</h4>
              <ul>
                <li v-for="(method, methodIndex) in resource.methods" :key="methodIndex">
                  {{ method }}
                </li>
              </ul>
            </div>

            <div class="code-example">
              <pre><code>{{ resource.codeExample }}</code></pre>
            </div>

            <div class="best-practice">
              <h4>æœ€ä½³å®è·µï¼š</h4>
              <p>{{ resource.bestPractice }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="framework-section">
      <div class="section-header">
        <div class="icon">âš›ï¸</div>
        <h2>æ¡†æ¶ä¸­çš„èµ„æºæ¸…ç†</h2>
      </div>

      <div class="framework-tabs">
        <div
          v-for="(framework, index) in frameworks"
          :key="index"
          class="tab"
          :class="{ active: activeTab === index }"
          @click="activeTab = index"
        >
          {{ framework.name }}
        </div>
      </div>

      <div class="framework-content">
        <div v-for="(framework, index) in frameworks" :key="index" v-show="activeTab === index">
          <h3>{{ framework.name }} æ¸…ç†æ¨¡å¼</h3>
          <p>{{ framework.description }}</p>

          <div class="framework-code">
            <pre><code>{{ framework.codeExample }}</code></pre>
          </div>

          <div class="framework-practices">
            <h4>æœ€ä½³å®è·µï¼š</h4>
            <ul>
              <li v-for="(practice, pIndex) in framework.practices" :key="pIndex">
                {{ practice }}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="tool-section">
      <div class="section-header">
        <div class="icon">ğŸ”</div>
        <h2>æ£€æµ‹å·¥å…·ä¸æŠ€æœ¯</h2>
      </div>

      <div class="tools-grid">
        <div class="tool-card">
          <div class="tool-icon">ğŸ§ª</div>
          <h3>Chrome DevTools</h3>
          <ul>
            <li>å†…å­˜å¿«ç…§å¯¹æ¯”</li>
            <li>åˆ†é…æ—¶é—´çº¿åˆ†æ</li>
            <li>å †å¿«ç…§æ£€æŸ¥</li>
          </ul>
        </div>
        <div class="tool-card">
          <div class="tool-icon">ğŸ“Š</div>
          <h3>æ€§èƒ½ç›‘æ§</h3>
          <ul>
            <li>Performance Observer API</li>
            <li>å†…å­˜ä½¿ç”¨ç›‘æ§</li>
            <li>åƒåœ¾å›æ”¶è·Ÿè¸ª</li>
          </ul>
        </div>
        <div class="tool-card">
          <div class="tool-icon">âš™ï¸</div>
          <h3>ä»£ç æ£€æŸ¥å·¥å…·</h3>
          <ul>
            <li>ESLint å†…å­˜æ³„æ¼è§„åˆ™</li>
            <li>é™æ€ä»£ç åˆ†æ</li>
            <li>è‡ªåŠ¨åŒ–æµ‹è¯•æ£€æµ‹</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="checklist-section">
      <div class="section-header">
        <div class="icon">âœ…</div>
        <h2>èµ„æºæ¸…ç†æ¸…å•</h2>
      </div>

      <div class="checklist">
        <div v-for="(item, index) in checklist" :key="index" class="checklist-item">
          <input type="checkbox" :id="'check-' + index" />
          <label :for="'check-' + index">{{ item }}</label>
        </div>
      </div>
    </div>

    <footer class="footer">
      <p>JavaScript èµ„æºæ¸…ç†æœ€ä½³å®è·µ | æå‡åº”ç”¨æ€§èƒ½ä¸ç¨³å®šæ€§</p>
      <p> å‰ç«¯æ€§èƒ½ä¼˜åŒ–æŒ‡å—</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const activeTab = ref(0)

const resources = ref([
  {
    type: 'event',
    icon: 'ğŸ§',
    title: 'äº‹ä»¶ç›‘å¬å™¨',
    description: 'DOM å…ƒç´ ä¸Šçš„äº‹ä»¶ç›‘å¬å™¨åœ¨å…ƒç´ ç§»é™¤åä»å¯èƒ½ä¿ç•™å¼•ç”¨',
    methods: [
      'åœ¨å…ƒç´ ç§»é™¤å‰ä½¿ç”¨ removeEventListener()',
      'ä½¿ç”¨äº‹ä»¶å§”æ‰˜å‡å°‘ç›‘å¬å™¨æ•°é‡',
      'ä½¿ç”¨ AbortController æ‰¹é‡ç®¡ç†ç›‘å¬å™¨',
    ],
    codeExample: `// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
const button = document.getElementById('btn');
const handler = () => console.log('Clicked!');
button.addEventListener('click', handler);

// æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
button.removeEventListener('click', handler);

// ä½¿ç”¨ AbortController
const controller = new AbortController();
button.addEventListener('click', handler, {
  signal: controller.signal
});
// æ¸…ç†æ‰€æœ‰å…³è”ç›‘å¬å™¨
controller.abort();`,
    bestPractice: 'åœ¨ç»„ä»¶å¸è½½/å…ƒç´ ç§»é™¤æ—¶æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨',
  },
  {
    type: 'timer',
    icon: 'â±ï¸',
    title: 'å®šæ—¶å™¨',
    description: 'setTimeout å’Œ setInterval ä¼šæŒç»­è¿è¡Œç›´åˆ°è¢«æ¸…é™¤',
    methods: [
      'ä½¿ç”¨ clearTimeout() å’Œ clearInterval()',
      'åœ¨ç»„ä»¶å¸è½½æ—¶æ¸…ç†æ‰€æœ‰å®šæ—¶å™¨',
      'å°è£…è‡ªåŠ¨æ¸…ç†çš„å®šæ—¶å™¨é’©å­',
    ],
    codeExample: `// è®¾ç½®å®šæ—¶å™¨
const timerId = setInterval(() => {
  console.log('Running...');
}, 1000);

// æ¸…ç†å®šæ—¶å™¨
clearInterval(timerId);

// React ç¤ºä¾‹
useEffect(() => {
  const timerId = setInterval(/*...*/);

  return () => clearInterval(timerId); // æ¸…ç†å‡½æ•°
}, []);`,
    bestPractice: 'ä¸ºæ¯ä¸ªå®šæ—¶å™¨ä¿å­˜å¼•ç”¨å¹¶åœ¨ä¸å†éœ€è¦æ—¶æ¸…ç†',
  },
  {
    type: 'animation',
    icon: 'ğŸ¬',
    title: 'RequestAnimationFrame',
    description: 'åŠ¨ç”»å¾ªç¯ä¼šæŒç»­è¿è¡Œç›´åˆ°å–æ¶ˆ',
    methods: ['ä½¿ç”¨ cancelAnimationFrame()', 'åœ¨ç»„ä»¶å¸è½½æ—¶å–æ¶ˆåŠ¨ç”»å¾ªç¯', 'åœ¨åŠ¨ç”»ä¸å¯è§æ—¶æš‚åœ'],
    codeExample: `let animationId;

function animate() {
  // åŠ¨ç”»é€»è¾‘
  animationId = requestAnimationFrame(animate);
}

// å¯åŠ¨åŠ¨ç”»
animate();

// å–æ¶ˆåŠ¨ç”»
cancelAnimationFrame(animationId);`,
    bestPractice: 'åœ¨ç»„ä»¶å¸è½½æˆ–é¡µé¢éšè—æ—¶å–æ¶ˆæ‰€æœ‰åŠ¨ç”»å¸§',
  },
  {
    type: 'observer',
    icon: 'ğŸ‘€',
    title: 'IntersectionObserver',
    description: 'è§‚å¯Ÿå™¨ä¼šæŒç»­è§‚å¯Ÿå…ƒç´ ç›´åˆ°æ–­å¼€è¿æ¥',
    methods: [
      'ä½¿ç”¨ disconnect() æ–¹æ³•',
      'åœ¨ç»„ä»¶å¸è½½æ—¶æ–­å¼€è¿æ¥',
      'ä½¿ç”¨ unobserve() åœæ­¢è§‚å¯Ÿç‰¹å®šå…ƒç´ ',
    ],
    codeExample: `const observer = new IntersectionObserver(entries => {
  // å¤„ç†äº¤é›†å˜åŒ–
});

observer.observe(element);

// æ¸…ç†è§‚å¯Ÿå™¨
observer.disconnect();
// æˆ–åœæ­¢è§‚å¯Ÿç‰¹å®šå…ƒç´ 
observer.unobserve(element);`,
    bestPractice: 'åœ¨è§‚å¯Ÿçš„å…ƒç´ è¢«ç§»é™¤æ—¶æ–­å¼€è§‚å¯Ÿå™¨è¿æ¥',
  },
  {
    type: 'observer',
    icon: 'ğŸ”„',
    title: 'MutationObserver',
    description: 'ç›‘è§† DOM å˜åŒ–çš„è§‚å¯Ÿå™¨éœ€è¦æ‰‹åŠ¨æ–­å¼€',
    methods: ['ä½¿ç”¨ disconnect() æ–¹æ³•', 'åœ¨ç»„ä»¶å¸è½½æ—¶æ–­å¼€è¿æ¥', 'åªåœ¨å¿…è¦æ—¶è§‚å¯Ÿ'],
    codeExample: `const observer = new MutationObserver(mutations => {
  // å¤„ç†DOMå˜åŒ–
});

observer.observe(target, { attributes: true });

// æ¸…ç†è§‚å¯Ÿå™¨
observer.disconnect();`,
    bestPractice: 'é¿å…é•¿æ—¶é—´è¿è¡Œ MutationObserverï¼Œåœ¨ä¸éœ€è¦æ—¶æ–­å¼€',
  },
  {
    type: 'observer',
    icon: 'ğŸ“',
    title: 'ResizeObserver',
    description: 'ç›‘è§†å…ƒç´ å°ºå¯¸å˜åŒ–çš„è§‚å¯Ÿå™¨',
    methods: [
      'ä½¿ç”¨ disconnect() æ–¹æ³•',
      'åœ¨ç»„ä»¶å¸è½½æ—¶æ–­å¼€è¿æ¥',
      'ä½¿ç”¨ unobserve() åœæ­¢è§‚å¯Ÿç‰¹å®šå…ƒç´ ',
    ],
    codeExample: `const resizeObserver = new ResizeObserver(entries => {
  // å¤„ç†å°ºå¯¸å˜åŒ–
});

resizeObserver.observe(element);

// æ¸…ç†è§‚å¯Ÿå™¨
resizeObserver.disconnect();`,
    bestPractice: 'åœ¨å…ƒç´ ç§»é™¤æˆ–ç»„ä»¶å¸è½½æ—¶æ–­å¼€è§‚å¯Ÿå™¨',
  },
  {
    type: 'connection',
    icon: 'ğŸ“¡',
    title: 'WebSocket è¿æ¥',
    description: 'WebSocket è¿æ¥ä¼šæŒç»­å ç”¨èµ„æºç›´åˆ°å…³é—­',
    methods: ['ä½¿ç”¨ close() æ–¹æ³•', 'åœ¨é¡µé¢å¸è½½å‰å…³é—­è¿æ¥', 'å®ç°é‡è¿æœºåˆ¶è€Œéåˆ›å»ºæ–°è¿æ¥'],
    codeExample: `const socket = new WebSocket('wss://example.com');

// å¤„ç†æ¶ˆæ¯
socket.addEventListener('message', event => {
  console.log('Message:', event.data);
});

// å…³é—­è¿æ¥
socket.close();

// æ·»åŠ å…³é—­äº‹ä»¶
window.addEventListener('beforeunload', () => {
  if (socket.readyState === WebSocket.OPEN) {
    socket.close();
  }
});`,
    bestPractice: 'åœ¨é¡µé¢å¸è½½æˆ–ç»„ä»¶é”€æ¯æ—¶å…³é—­ WebSocket è¿æ¥',
  },
  {
    type: 'closure',
    icon: 'ğŸ“¦',
    title: 'é—­åŒ…å¼•ç”¨',
    description: 'é—­åŒ…å¯èƒ½æ— æ„ä¸­ä¿ç•™å¯¹å¤§å¯¹è±¡çš„å¼•ç”¨',
    methods: [
      'é¿å…åœ¨é—­åŒ…ä¸­å¼•ç”¨å¤§å¯¹è±¡',
      'åœ¨ä¸å†éœ€è¦æ—¶æ‰‹åŠ¨è§£é™¤å¼•ç”¨ (obj = null)',
      'ä½¿ç”¨æ¨¡å—æ¨¡å¼é™åˆ¶ä½œç”¨åŸŸ',
    ],
    codeExample: `function createClosure() {
  const largeData = new Array(1000000).fill('data');
  let count = 0;

  // é—­åŒ…å¼•ç”¨ largeData
  return function() {
    console.log(count++);
    // å³ä½¿ä¸å†éœ€è¦ largeDataï¼Œå®ƒä»ç„¶è¢«ä¿ç•™
  };
}

// è§£å†³æ–¹æ¡ˆ
function optimizedClosure() {
  let count = 0;
  const largeData = new Array(1000000).fill('data');

  // ä½¿ç”¨æ•°æ®åé‡Šæ”¾
  processData(largeData);
  largeData = null; // é‡Šæ”¾å¼•ç”¨

  return function() {
    console.log(count++);
  };
}`,
    bestPractice: 'è°¨æ…å¤„ç†é—­åŒ…ä¸­çš„å˜é‡å¼•ç”¨ï¼ŒåŠæ—¶é‡Šæ”¾ä¸å†éœ€è¦çš„å¤§å¯¹è±¡',
  },
  {
    type: 'dom',
    icon: 'ğŸ·ï¸',
    title: 'DOM å…ƒç´ å¼•ç”¨',
    description: 'å¯¹å·²ç§»é™¤ DOM å…ƒç´ çš„å¼•ç”¨ä¼šé˜»æ­¢å…¶è¢«åƒåœ¾å›æ”¶',
    methods: [
      'åœ¨ç§»é™¤å…ƒç´ åè§£é™¤å¼•ç”¨ (elementRef = null)',
      'ä½¿ç”¨ WeakMap/WeakSet å­˜å‚¨ DOM å¼•ç”¨',
      'é¿å…åœ¨å…¨å±€å¯¹è±¡ä¸­å­˜å‚¨ DOM å…ƒç´ ',
    ],
    codeExample: `// å­˜å‚¨DOMå¼•ç”¨
const domRefs = {
  button: document.getElementById('btn'),
  container: document.getElementById('container')
};

// ç§»é™¤å®¹å™¨å…ƒç´ 
document.body.removeChild(domRefs.container);

// å³ä½¿ä»DOMç§»é™¤ï¼ŒJSä»æŒæœ‰å¼•ç”¨
// è§£å†³æ–¹æ¡ˆï¼šè§£é™¤å¼•ç”¨
domRefs.container = null;`,
    bestPractice: 'åœ¨å…ƒç´ ä» DOM ç§»é™¤åï¼ŒåŠæ—¶æ¸…é™¤å¯¹å…¶çš„ JavaScript å¼•ç”¨',
  },
  {
    type: 'media',
    icon: 'ğŸ¥',
    title: 'åª’ä½“èµ„æº',
    description: 'è§†é¢‘ã€éŸ³é¢‘å…ƒç´ ä¼šæŒç»­å ç”¨å†…å­˜ç›´åˆ°é‡Šæ”¾',
    methods: ['è®¾ç½® src ä¸ºç©ºå­—ç¬¦ä¸²é‡Šæ”¾èµ„æº', 'è°ƒç”¨ load() æ–¹æ³•é‡ç½®', 'ç§»é™¤å…ƒç´ å‰æš‚åœå¹¶æ–­å¼€æº'],
    codeExample: `const video = document.getElementById('myVideo');

// æ¸…ç†è§†é¢‘èµ„æº
video.pause();
video.src = '';
video.load();

// ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
video.removeEventListener('timeupdate', handler);`,
    bestPractice: 'åœ¨åª’ä½“å…ƒç´ ä¸å†éœ€è¦æ—¶ï¼Œå½»åº•é‡Šæ”¾å…¶èµ„æº',
  },
  {
    type: 'library',
    icon: 'ğŸ“š',
    title: 'ç¬¬ä¸‰æ–¹åº“å®ä¾‹',
    description: 'å›¾è¡¨ã€åœ°å›¾ç­‰åº“åˆ›å»ºçš„å®ä¾‹éœ€è¦æ‰‹åŠ¨é”€æ¯',
    methods: ['æŸ¥é˜…æ–‡æ¡£äº†è§£é”€æ¯æ–¹æ³•', 'åœ¨ç»„ä»¶å¸è½½æ—¶è°ƒç”¨é”€æ¯æ–¹æ³•', 'ä½¿ç”¨åº“æä¾›çš„æ¸…ç†é’©å­'],
    codeExample: `// åˆ›å»ºå›¾è¡¨å®ä¾‹
const chart = new Chart(ctx, config);

// æ¸…ç†å›¾è¡¨
chart.destroy();

// Vue ç¤ºä¾‹
onBeforeUnmount(() => {
  if (chart) {
    chart.destroy();
  }
});`,
    bestPractice: 'å¯¹æ¯ä¸ªç¬¬ä¸‰æ–¹åº“å®ä¾‹ï¼Œåœ¨ä¸å†éœ€è¦æ—¶è°ƒç”¨å…¶é”€æ¯æ–¹æ³•',
  },
  {
    type: 'worker',
    icon: 'ğŸ‘·',
    title: 'Web Workers',
    description: 'Worker çº¿ç¨‹ä¼šæŒç»­è¿è¡Œç›´åˆ°ç»ˆæ­¢',
    methods: ['ä½¿ç”¨ worker.terminate()', 'åœ¨ç»„ä»¶å¸è½½æ—¶ç»ˆæ­¢ Worker', 'ä½¿ç”¨ Worker æ± ç®¡ç†'],
    codeExample: `const worker = new Worker('worker.js');

// å‘Workerå‘é€æ¶ˆæ¯
worker.postMessage(data);

// ç»ˆæ­¢Worker
worker.terminate();

// React ç¤ºä¾‹
useEffect(() => {
  const worker = new Worker('worker.js');

  return () => worker.terminate(); // æ¸…ç†å‡½æ•°
}, []);`,
    bestPractice: 'åœ¨ Worker ä¸å†éœ€è¦æ—¶åŠæ—¶ç»ˆæ­¢ï¼Œé¿å…èµ„æºæµªè´¹',
  },
])

const frameworks = ref([
  {
    name: 'Vue 3',
    description: 'ä½¿ç”¨ Composition API çš„æ¸…ç†æœºåˆ¶',
    codeExample: `import { onMounted, onBeforeUnmount } from 'vue';

export default {
  setup() {
    let timerId;
    const button = ref(null);

    const clickHandler = () => {
      console.log('Button clicked');
    };

    onMounted(() => {
      // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
      button.value.addEventListener('click', clickHandler);

      // è®¾ç½®å®šæ—¶å™¨
      timerId = setInterval(() => {
        console.log('Timer running');
      }, 1000);
    });

    onBeforeUnmount(() => {
      // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
      button.value.removeEventListener('click', clickHandler);

      // æ¸…ç†å®šæ—¶å™¨
      clearInterval(timerId);
    });

    return { button };
  }
}`,
    practices: [
      'ä½¿ç”¨ onBeforeUnmount ç”Ÿå‘½å‘¨æœŸé’©å­',
      'ä½¿ç”¨ ref å­˜å‚¨éœ€è¦æ¸…ç†çš„èµ„æºå¼•ç”¨',
      'å¯¹äºè‡ªå®šä¹‰ç»„åˆå‡½æ•°ï¼Œè¿”å›æ¸…ç†å‡½æ•°',
      'ä½¿ç”¨ watchEffect çš„æ¸…ç†å›è°ƒ',
      'åœ¨è·¯ç”±å®ˆå«ä¸­æ¸…ç†å…¨å±€èµ„æº',
    ],
  },
  {
    name: 'React',
    description: 'ä½¿ç”¨ useEffect çš„æ¸…ç†å‡½æ•°æœºåˆ¶',
    codeExample: `import React, { useEffect, useRef } from 'react';

function MyComponent() {
  const buttonRef = useRef(null);

  useEffect(() => {
    const button = buttonRef.current;
    const clickHandler = () => {
      console.log('Button clicked');
    };

    // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
    button.addEventListener('click', clickHandler);

    const timerId = setInterval(() => {
      console.log('Timer running');
    }, 1000);

    // æ¸…ç†å‡½æ•°
    return () => {
      // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
      button.removeEventListener('click', clickHandler);

      // æ¸…ç†å®šæ—¶å™¨
      clearInterval(timerId);
    };
  }, []);

  return <button ref={buttonRef}>Click Me</button>;
}`,
    practices: [
      'å§‹ç»ˆä» useEffect è¿”å›æ¸…ç†å‡½æ•°',
      'ä½¿ç”¨ useRef å­˜å‚¨ DOM å¼•ç”¨',
      'ä½¿ç”¨è‡ªå®šä¹‰ Hook å°è£…èµ„æºæ¸…ç†',
      'ä½¿ç”¨ AbortController å–æ¶ˆ fetch è¯·æ±‚',
      'åœ¨å¸è½½å‰æ¸…ç†æ‰€æœ‰è®¢é˜…å’Œç›‘å¬å™¨',
    ],
  },
  {
    name: 'Angular',
    description: 'ä½¿ç”¨ ngOnDestroy ç”Ÿå‘½å‘¨æœŸé’©å­',
    codeExample: `import { Component, OnDestroy, ElementRef } from '@angular/core';

@Component({
  selector: 'app-my-component',
  template: '<button #myButton>Click Me</button>'
})
export class MyComponent implements OnDestroy {
  private timerId: any;
  private clickHandler: () => void;

  constructor(private elementRef: ElementRef) {
    this.clickHandler = () => {
      console.log('Button clicked');
    };

    const button = this.elementRef.nativeElement.querySelector('button');
    button.addEventListener('click', this.clickHandler);

    this.timerId = setInterval(() => {
      console.log('Timer running');
    }, 1000);
  }

  ngOnDestroy() {
    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    const button = this.elementRef.nativeElement.querySelector('button');
    button.removeEventListener('click', this.clickHandler);

    // æ¸…ç†å®šæ—¶å™¨
    clearInterval(this.timerId);
  }
}`,
    practices: [
      'å®ç° ngOnDestroy æ¥å£',
      'ä½¿ç”¨ RxJS takeUntil æ“ä½œç¬¦è‡ªåŠ¨å–æ¶ˆè®¢é˜…',
      'ä½¿ç”¨ @HostListener ç®¡ç†äº‹ä»¶ç›‘å¬å™¨',
      'åœ¨æœåŠ¡ä¸­æä¾›èµ„æºæ¸…ç†æ–¹æ³•',
      'ä½¿ç”¨ Angular çš„ Renderer2 å®‰å…¨æ“ä½œ DOM',
    ],
  },
])

const checklist = ref([
  'æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨å·²ç§»é™¤',
  'æ‰€æœ‰å®šæ—¶å™¨å·²æ¸…é™¤',
  'æ‰€æœ‰åŠ¨ç”»å¸§å·²å–æ¶ˆ',
  'æ‰€æœ‰è§‚å¯Ÿå™¨å·²æ–­å¼€è¿æ¥',
  'æ‰€æœ‰ WebSocket è¿æ¥å·²å…³é—­',
  'æ‰€æœ‰ Worker çº¿ç¨‹å·²ç»ˆæ­¢',
  'æ‰€æœ‰ç¬¬ä¸‰æ–¹åº“å®ä¾‹å·²é”€æ¯',
  'æ‰€æœ‰åª’ä½“èµ„æºå·²é‡Šæ”¾',
  'æ‰€æœ‰é—­åŒ…ä¸­çš„å¤§å¯¹è±¡å¼•ç”¨å·²é‡Šæ”¾',
  'æ‰€æœ‰åˆ†ç¦»çš„ DOM å¼•ç”¨å·²æ¸…é™¤',
  'æ‰€æœ‰å…¨å±€èµ„æºå·²æ¸…ç†',
  'æ‰€æœ‰è®¢é˜…å’Œç›‘å¬å™¨å·²å–æ¶ˆ',
])
</script>

<style lang="less" scoped>
@primary-color: #3498db;
@secondary-color: #2ecc71;
@warning-color: #e74c3c;
@text-color: #2c3e50;
@light-bg: #f8f9fa;
@card-bg: #ffffff;
@border-color: #e0e0e0;
@success-color: #27ae60;
@header-gradient: linear-gradient(135deg, @primary-color, #8e44ad);

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.cleanup-container {
  font-family: 'Segoe UI', 'Roboto', sans-serif;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  color: @text-color;
  background-color: @light-bg;
  line-height: 1.6;
}

.header {
  text-align: center;
  margin-bottom: 30px;
  padding: 50px 20px;
  background: @header-gradient;
  color: white;
  border-radius: 15px;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);

  h1 {
    font-size: 2.8rem;
    margin-bottom: 15px;
    font-weight: 700;
  }

  p {
    font-size: 1.4rem;
    opacity: 0.9;
    font-weight: 300;
  }
}

.stats-bar {
  display: flex;
  justify-content: space-around;
  margin: 30px 0;
  gap: 20px;

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: center;
  }
}

.stat-card {
  background: white;
  border-radius: 12px;
  padding: 25px 15px;
  text-align: center;
  flex: 1;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
  transition: transform 0.3s ease;

  &:hover {
    transform: translateY(-5px);
  }
}

.stat-value {
  font-size: 2.5rem;
  font-weight: 700;
  color: @primary-color;
  margin-bottom: 8px;
}

.stat-label {
  font-size: 1.1rem;
  color: #7f8c8d;
}

.content-section,
.resource-section,
.framework-section,
.tool-section,
.checklist-section {
  background: @card-bg;
  border-radius: 15px;
  padding: 30px;
  margin-bottom: 30px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
}

.section-header {
  display: flex;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 2px solid @border-color;

  .icon {
    font-size: 2rem;
    margin-right: 15px;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  h2 {
    font-size: 1.9rem;
    color: @text-color;
  }
}

.leak-demonstration {
  display: flex;
  gap: 30px;

  @media (max-width: 900px) {
    flex-direction: column;
  }
}

.leak-causes {
  flex: 1;

  h3 {
    font-size: 1.5rem;
    margin-bottom: 20px;
    color: @text-color;
  }

  ul {
    list-style: none;
    padding: 0;

    li {
      padding: 15px;
      border-bottom: 1px solid @border-color;
      display: flex;
      align-items: center;
      font-size: 1.1rem;

      &:last-child {
        border-bottom: none;
      }
    }
  }
}

.badge {
  display: inline-block;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  margin-right: 15px;
  min-width: 80px;
  text-align: center;

  &.high {
    background: lighten(@warning-color, 40%);
    color: darken(@warning-color, 20%);
  }

  &.medium {
    background: lighten(#f39c12, 40%);
    color: darken(#f39c12, 20%);
  }

  &.critical {
    background: lighten(@warning-color, 30%);
    color: white;
  }
}

.leak-visual {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

.memory-chart {
  width: 100%;
  max-width: 500px;

  .chart {
    height: 250px;
    position: relative;
    border-bottom: 2px solid @text-color;
    border-left: 2px solid @text-color;
    margin-bottom: 15px;
  }

  .line {
    position: absolute;
    left: 0;
    bottom: 0;
    height: 3px;
    width: 100%;

    &.leak-line {
      background: @warning-color;
      animation: leakAnimation 8s infinite linear;
    }

    &.normal-line {
      background: @primary-color;
      animation: normalAnimation 8s infinite linear;
      opacity: 0.7;
    }
  }

  .chart-labels {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .legend {
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 10px;

    span {
      display: inline-block;
      width: 20px;
      height: 3px;

      &.leak-legend {
        background: @warning-color;
      }

      &.normal-legend {
        background: @primary-color;
      }
    }
  }
}

@keyframes leakAnimation {
  0% {
    height: 0;
  }
  25% {
    height: 60%;
  }
  50% {
    height: 70%;
  }
  75% {
    height: 90%;
  }
  100% {
    height: 100%;
  }
}

@keyframes normalAnimation {
  0% {
    height: 0;
  }
  25% {
    height: 50%;
  }
  50% {
    height: 30%;
  }
  75% {
    height: 60%;
  }
  100% {
    height: 40%;
  }
}

.resource-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
  gap: 25px;

  @media (max-width: 1100px) {
    grid-template-columns: 1fr;
  }
}

.resource-card {
  background: white;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
  transition: transform 0.3s ease;
  border-top: 4px solid @primary-color;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
  }

  &.event {
    border-top-color: #e74c3c;
  }
  &.timer {
    border-top-color: #f39c12;
  }
  &.animation {
    border-top-color: #9b59b6;
  }
  &.observer {
    border-top-color: #1abc9c;
  }
  &.connection {
    border-top-color: #3498db;
  }
  &.closure {
    border-top-color: #2ecc71;
  }
  &.dom {
    border-top-color: #34495e;
  }
  &.media {
    border-top-color: #e67e22;
  }
  &.library {
    border-top-color: #16a085;
  }
  &.worker {
    border-top-color: #8e44ad;
  }
}

.resource-header {
  display: flex;
  align-items: center;
  padding: 20px;
  background: rgba(52, 152, 219, 0.05);

  .resource-icon {
    font-size: 2rem;
    margin-right: 15px;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  h3 {
    font-size: 1.5rem;
    color: @text-color;
  }
}

.resource-content {
  padding: 20px;

  p {
    margin-bottom: 15px;
    line-height: 1.7;
    font-size: 1.1rem;
  }
}

.cleanup-methods {
  margin: 20px 0;

  h4 {
    font-size: 1.2rem;
    margin-bottom: 10px;
    color: @text-color;
  }

  ul {
    list-style: none;
    padding: 0;

    li {
      padding: 8px 0;
      padding-left: 25px;
      position: relative;
      line-height: 1.6;

      &::before {
        content: 'â€¢';
        position: absolute;
        left: 10px;
        top: 8px;
        color: @primary-color;
        font-weight: 700;
      }
    }
  }
}

.code-example {
  background: #2d2d2d;
  border-radius: 8px;
  padding: 18px;
  margin: 15px 0;
  overflow-x: auto;

  pre {
    margin: 0;

    code {
      color: #f8f8f2;
      font-family: 'Fira Code', monospace;
      font-size: 0.95rem;
      line-height: 1.5;
    }
  }
}

.best-practice {
  background: rgba(39, 174, 96, 0.08);
  border-radius: 8px;
  padding: 15px;
  margin-top: 15px;

  h4 {
    font-size: 1.2rem;
    margin-bottom: 8px;
    color: darken(@success-color, 10%);
  }

  p {
    margin: 0;
    font-weight: 500;
  }
}

.framework-tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 25px;
  border-bottom: 2px solid @border-color;
}

.tab {
  padding: 12px 25px;
  cursor: pointer;
  border-radius: 8px 8px 0 0;
  background: #f1f1f1;
  transition: all 0.3s ease;
  font-weight: 500;

  &:hover {
    background: #e0e0e0;
  }

  &.active {
    background: @primary-color;
    color: white;
  }
}

.framework-content {
  padding: 20px;

  h3 {
    font-size: 1.5rem;
    margin-bottom: 15px;
    color: @text-color;
  }

  p {
    margin-bottom: 20px;
    line-height: 1.7;
    font-size: 1.1rem;
  }
}

.framework-code {
  background: #2d2d2d;
  border-radius: 8px;
  padding: 18px;
  margin: 20px 0;
  overflow-x: auto;

  pre {
    margin: 0;

    code {
      color: #f8f8f2;
      font-family: 'Fira Code', monospace;
      font-size: 0.95rem;
      line-height: 1.5;
    }
  }
}

.framework-practices {
  margin-top: 25px;

  h4 {
    font-size: 1.2rem;
    margin-bottom: 10px;
    color: @text-color;
  }

  ul {
    list-style: none;
    padding: 0;

    li {
      padding: 10px 0;
      padding-left: 30px;
      position: relative;
      line-height: 1.6;
      border-bottom: 1px dashed @border-color;

      &::before {
        content: 'âœ“';
        position: absolute;
        left: 10px;
        top: 10px;
        color: @success-color;
        font-weight: 700;
      }

      &:last-child {
        border-bottom: none;
      }
    }
  }
}

.tools-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 25px;
  margin-top: 30px;
}

.tool-card {
  background: white;
  border-radius: 12px;
  padding: 25px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
  text-align: center;
  transition: all 0.3s ease;
  border-top: 4px solid @primary-color;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
  }

  .tool-icon {
    font-size: 2.5rem;
    margin-bottom: 15px;
  }

  h3 {
    font-size: 1.4rem;
    margin-bottom: 15px;
    color: @primary-color;
  }

  ul {
    list-style: none;
    padding: 0;
    text-align: left;

    li {
      padding: 10px 0;
      border-bottom: 1px dashed @border-color;
      padding-left: 30px;
      position: relative;

      &::before {
        content: 'â†’';
        position: absolute;
        left: 10px;
        top: 10px;
        color: @primary-color;
      }

      &:last-child {
        border-bottom: none;
      }
    }
  }
}

.checklist {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.checklist-item {
  display: flex;
  align-items: center;
  padding: 15px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease;

  &:hover {
    transform: translateX(5px);
    box-shadow: 0 5px 12px rgba(0, 0, 0, 0.08);
  }

  input[type='checkbox'] {
    margin-right: 15px;
    width: 20px;
    height: 20px;
    accent-color: @success-color;
  }

  label {
    font-size: 1.1rem;
    cursor: pointer;
  }
}

.footer {
  text-align: center;
  margin-top: 50px;
  padding: 30px;
  color: #7f8c8d;
  font-size: 1rem;
  border-top: 1px solid @border-color;

  p:first-child {
    margin-bottom: 8px;
    font-weight: 500;
  }
}

@media (max-width: 768px) {
  .header {
    padding: 30px 15px;

    h1 {
      font-size: 2.2rem;
    }

    p {
      font-size: 1.1rem;
    }
  }

  .resource-grid {
    grid-template-columns: 1fr;
  }
}
</style>
