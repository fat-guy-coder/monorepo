<template>
  <div class="webgpu-guide">
    <header>
      <h1>WebGPUï¼šä¸‹ä¸€ä»£Webå›¾å½¢æŠ€æœ¯</h1>
      <p>è§£é”é«˜æ€§èƒ½å›¾å½¢è®¡ç®—çš„æ–°æ ‡å‡†</p>
      <div class="stats">
        <div class="stat-card">
          <div class="stat-value">10-100x</div>
          <div class="stat-label">æ€§èƒ½æå‡</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">2023</div>
          <div class="stat-label">ä¸»æµæµè§ˆå™¨æ”¯æŒ</div>
        </div>
      </div>
    </header>

    <div class="content-wrapper">
      <!-- æ¦‚è¿°éƒ¨åˆ† -->
      <div class="section">
        <h2>ğŸ“Œ WebGPU æ¦‚è¿°</h2>
        <div class="overview-grid">
          <div class="overview-card">
            <h3>ä»€ä¹ˆæ˜¯WebGPUï¼Ÿ</h3>
            <p>WebGPUæ˜¯ä¸‹ä¸€ä»£Webå›¾å½¢APIï¼Œæä¾›å¯¹GPUç¡¬ä»¶çš„åº•å±‚è®¿é—®ï¼Œæ—¨åœ¨æ›¿ä»£WebGLã€‚å®ƒæä¾›äº†æ›´ç°ä»£çš„GPUåŠŸèƒ½è®¿é—®æ–¹å¼ï¼Œæ”¯æŒè®¡ç®—ç€è‰²å™¨å’Œå›¾å½¢æ¸²æŸ“ã€‚</p>
          </div>
          <div class="overview-card">
            <h3>ä¸ºä»€ä¹ˆéœ€è¦WebGPUï¼Ÿ</h3>
            <ul>
              <li>WebGLåŸºäºOpenGL ES 2.0ï¼Œå·²æ— æ³•æ»¡è¶³ç°ä»£GPUéœ€æ±‚</li>
              <li>æä¾›æ›´é«˜æ•ˆçš„CPU/GPUå¹¶è¡Œå¤„ç†èƒ½åŠ›</li>
              <li>æ”¯æŒç°ä»£GPUç‰¹æ€§ï¼ˆå¦‚è®¡ç®—ç€è‰²å™¨ï¼‰</li>
              <li>å‡å°‘é©±åŠ¨å¼€é”€ï¼Œæé«˜æ€§èƒ½</li>
            </ul>
          </div>
          <div class="overview-card">
            <h3>æ ¸å¿ƒä¼˜åŠ¿</h3>
            <div class="advantages">
              <div class="advantage">é«˜æ€§èƒ½</div>
              <div class="advantage">å¤šçº¿ç¨‹æ”¯æŒ</div>
              <div class="advantage">ç±»å‹å®‰å…¨</div>
              <div class="advantage">è·¨å¹³å°</div>
              <div class="advantage">ç°ä»£GPUç‰¹æ€§</div>
              <div class="advantage">è®¡ç®—èƒ½åŠ›</div>
            </div>
          </div>
        </div>
      </div>

      <!-- æ ¸å¿ƒæ¦‚å¿µ -->
      <div class="section">
        <h2>ğŸ§  WebGPU æ ¸å¿ƒæ¦‚å¿µ</h2>
        <div class="concepts-grid">
          <div class="concept-card">
            <h3>é€‚é…å™¨ (Adapter)</h3>
            <p>ä»£è¡¨ç‰©ç†GPUè®¾å¤‡åŠå…¶èƒ½åŠ›ï¼Œç”¨äºè·å–GPUè®¾å¤‡å®ä¾‹ã€‚</p>
            <pre class="code-block">const adapter = await navigator.gpu.requestAdapter();</pre>
          </div>
          <div class="concept-card">
            <h3>è®¾å¤‡ (Device)</h3>
            <p>é€»è¾‘GPUè®¾å¤‡å®ä¾‹ï¼Œç”¨äºåˆ›å»ºèµ„æºå’Œå¤„ç†å‘½ä»¤ã€‚</p>
            <pre class="code-block">const device = await adapter.requestDevice();</pre>
          </div>
          <div class="concept-card">
            <h3>å‘½ä»¤ç¼–ç å™¨ (CommandEncoder)</h3>
            <p>è®°å½•GPUå‘½ä»¤åºåˆ—ï¼Œæœ€ç»ˆæäº¤åˆ°å‘½ä»¤é˜Ÿåˆ—æ‰§è¡Œã€‚</p>
            <pre class="code-block">const encoder = device.createCommandEncoder();</pre>
          </div>
          <div class="concept-card">
            <h3>ç®¡çº¿ (Pipeline)</h3>
            <p>å®šä¹‰GPUå¦‚ä½•æ‰§è¡Œå·¥ä½œï¼ŒåŒ…æ‹¬æ¸²æŸ“ç®¡çº¿å’Œè®¡ç®—ç®¡çº¿ã€‚</p>
            <pre class="code-block">const pipeline = device.createComputePipeline({...});</pre>
          </div>
          <div class="concept-card">
            <h3>ç€è‰²å™¨ (Shader)</h3>
            <p>åœ¨GPUä¸Šè¿è¡Œçš„ç¨‹åºï¼Œä½¿ç”¨WGSLè¯­è¨€ç¼–å†™ã€‚</p>
            <pre class="code-block">@compute @workgroup_size(64)
fn main() { /* ... */ }</pre>
          </div>
          <div class="concept-card">
            <h3>ç»‘å®šç»„ (BindGroup)</h3>
            <p>å°†èµ„æºï¼ˆç¼“å†²åŒºã€çº¹ç†ï¼‰ç»‘å®šåˆ°ç€è‰²å™¨ã€‚</p>
            <pre class="code-block">const bindGroup = device.createBindGroup({...});</pre>
          </div>
        </div>
      </div>

      <!-- ä½¿ç”¨ç¤ºä¾‹ -->
      <div class="section">
        <h2>ğŸ’» WebGPU åŸºç¡€ä½¿ç”¨</h2>
        <div class="usage-steps">
          <div class="step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>åˆå§‹åŒ–WebGPU</h3>
              <pre class="code-block">async function initWebGPU() {
  // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
  if (!navigator.gpu) throw "WebGPU not supported";

  // è·å–é€‚é…å™¨å’Œè®¾å¤‡
  const adapter = await navigator.gpu.requestAdapter();
  const device = await adapter.requestDevice();

  // è·å–Canvasä¸Šä¸‹æ–‡
  const canvas = document.getElementById('canvas');
  const context = canvas.getContext('webgpu');

  // é…ç½®Canvasæ ¼å¼
  const format = navigator.gpu.getPreferredCanvasFormat();
  context.configure({ device, format });

  return { device, context, format };
}</pre>
            </div>
          </div>

          <div class="step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>åˆ›å»ºè®¡ç®—ç€è‰²å™¨</h3>
              <pre class="code-block">const shaderCode = `
@group(0) @binding(0) var&lt;storage, read_write&gt; data: array&lt;f32&gt;;

@compute @workgroup_size(64)
fn main(@builtin(global_invocation_id) id: vec3&lt;u32&gt;) {
  let index = id.x;
  data[index] = data[index] * 2.0;
}`;</pre>
            </div>
          </div>

          <div class="step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>è®¾ç½®è®¡ç®—ç®¡çº¿</h3>
              <pre class="code-block">async function setupComputePipeline(device) {
  // åˆ›å»ºç€è‰²å™¨æ¨¡å—
  const shaderModule = device.createShaderModule({
    code: shaderCode
  });

  // åˆ›å»ºè®¡ç®—ç®¡çº¿
  const computePipeline = device.createComputePipeline({
    layout: 'auto',
    compute: {
      module: shaderModule,
      entryPoint: 'main'
    }
  });

  // åˆ›å»ºæ•°æ®ç¼“å†²åŒº
  const bufferSize = 1024 * Float32Array.BYTES_PER_ELEMENT;
  const outputBuffer = device.createBuffer({
    size: bufferSize,
    usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC
  });

  // åˆ›å»ºç»‘å®šç»„
  const bindGroup = device.createBindGroup({
    layout: computePipeline.getBindGroupLayout(0),
    entries: [{
      binding: 0,
      resource: { buffer: outputBuffer }
    }]
  });

  return { computePipeline, outputBuffer, bindGroup };
}</pre>
            </div>
          </div>

          <div class="step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h3>æ‰§è¡Œè®¡ç®—ä»»åŠ¡</h3>
              <pre class="code-block">async function runCompute(device, pipeline, bindGroup) {
  // åˆ›å»ºå‘½ä»¤ç¼–ç å™¨
  const encoder = device.createCommandEncoder();

  // å¼€å§‹è®¡ç®—é€šé“
  const pass = encoder.beginComputePass();
  pass.setPipeline(pipeline);
  pass.setBindGroup(0, bindGroup);
  pass.dispatchWorkgroups(16); // 1024å…ƒç´  / 64å·¥ä½œç»„å¤§å°
  pass.end();

  // æäº¤å‘½ä»¤
  const commandBuffer = encoder.finish();
  device.queue.submit([commandBuffer]);
}</pre>
            </div>
          </div>
        </div>
      </div>

      <!-- ä½¿ç”¨åœºæ™¯ -->
      <div class="section">
        <h2>ğŸš€ WebGPU ä½¿ç”¨åœºæ™¯</h2>
        <div class="scenarios-grid">
          <div class="scenario-card">
            <h3>é«˜æ€§èƒ½å›¾å½¢æ¸²æŸ“</h3>
            <ul>
              <li>å¤æ‚3Dåœºæ™¯æ¸²æŸ“</li>
              <li>å®æ—¶å…‰çº¿è¿½è¸ª</li>
              <li>ç‰©ç†æ¨¡æ‹Ÿå¯è§†åŒ–</li>
              <li>é«˜å¸§ç‡æ¸¸æˆ</li>
            </ul>
          </div>
          <div class="scenario-card">
            <h3>GPUè®¡ç®—</h3>
            <ul>
              <li>å¤§è§„æ¨¡æ•°æ®å¤„ç†</li>
              <li>ç§‘å­¦è®¡ç®—æ¨¡æ‹Ÿ</li>
              <li>æœºå™¨å­¦ä¹ æ¨ç†</li>
              <li>å¯†ç å­¦è¿ç®—</li>
            </ul>
          </div>
          <div class="scenario-card">
            <h3>åª’ä½“å¤„ç†</h3>
            <ul>
              <li>å®æ—¶è§†é¢‘ç‰¹æ•ˆ</li>
              <li>å›¾åƒ/è§†é¢‘ç¼–ç </li>
              <li>å®æ—¶è§†é¢‘åˆ†æ</li>
              <li>AR/VRå¤„ç†</li>
            </ul>
          </div>
          <div class="scenario-card">
            <h3>ä¸“ä¸šåº”ç”¨</h3>
            <ul>
              <li>CAD/CAEåº”ç”¨</li>
              <li>æ•°æ®å¯è§†åŒ–</li>
              <li>åŒ»å­¦æˆåƒ</li>
              <li>åœ°ç†ä¿¡æ¯ç³»ç»Ÿ</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ä¸WebGLå¯¹æ¯” -->
      <div class="section">
        <h2>ğŸ†š WebGPU vs WebGL</h2>
        <div class="comparison-table">
          <table>
            <thead>
              <tr>
                <th>ç‰¹æ€§</th>
                <th>WebGPU</th>
                <th>WebGL</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>APIè®¾è®¡</td>
                <td>ç°ä»£ã€æ˜¾å¼ã€ä½çº§æ§åˆ¶</td>
                <td>ä¼ ç»Ÿã€éšå¼ã€é«˜çº§æŠ½è±¡</td>
              </tr>
              <tr>
                <td>æ€§èƒ½</td>
                <td>æ¥è¿‘åŸç”Ÿï¼Œä½å¼€é”€</td>
                <td>è¾ƒé«˜å¼€é”€</td>
              </tr>
              <tr>
                <td>å¤šçº¿ç¨‹</td>
                <td>åŸç”Ÿæ”¯æŒ</td>
                <td>æœ‰é™æ”¯æŒ</td>
              </tr>
              <tr>
                <td>è®¡ç®—ç€è‰²å™¨</td>
                <td>åŸç”Ÿæ”¯æŒ</td>
                <td>æ— åŸç”Ÿæ”¯æŒ</td>
              </tr>
              <tr>
                <td>ç€è‰²è¯­è¨€</td>
                <td>WGSLï¼ˆç±»å‹å®‰å…¨ï¼‰</td>
                <td>GLSL</td>
              </tr>
              <tr>
                <td>å†…å­˜ç®¡ç†</td>
                <td>æ˜¾å¼æ§åˆ¶</td>
                <td>éšå¼ç®¡ç†</td>
              </tr>
              <tr>
                <td>æµè§ˆå™¨æ”¯æŒ</td>
                <td>Chrome 113+, Edge 113+, Firefox Nightly</td>
                <td>å¹¿æ³›æ”¯æŒ</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- å­¦ä¹ èµ„æº -->
      <div class="section">
        <h2>ğŸ“š WebGPU å­¦ä¹ èµ„æº</h2>
        <div class="resources-grid">
          <div class="resource-card">
            <h3>å®˜æ–¹æ–‡æ¡£</h3>
            <ul>
              <li>WebGPU W3Cè§„èŒƒ</li>
              <li>MDN WebGPUæ–‡æ¡£</li>
              <li>Chrome WebGPUæ–‡æ¡£</li>
            </ul>
          </div>
          <div class="resource-card">
            <h3>æ•™ç¨‹ä¸ç¤ºä¾‹</h3>
            <ul>
              <li>WebGPU Fundamentals</li>
              <li>Google WebGPU Samples</li>
              <li>WebGPU.rocks</li>
            </ul>
          </div>
          <div class="resource-card">
            <h3>å¼€å‘å·¥å…·</h3>
            <ul>
              <li>WebGPU DevTools (Chrome)</li>
              <li>WGSLè¯­è¨€æ”¯æŒ (VSCode)</li>
              <li>WebGPU Inspector</li>
            </ul>
          </div>
          <div class="resource-card">
            <h3>æ¡†æ¶ä¸åº“</h3>
            <ul>
              <li>Three.js (WebGPUæ”¯æŒ)</li>
              <li>Babylon.js (WebGPUåç«¯)</li>
              <li>wgpu (Rustå®ç°)</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>WebGPUæŠ€æœ¯æŒ‡å— Â© 2023 | ä½¿ç”¨Vue3 + TypeScriptå®ç°</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
// æœ¬ç»„ä»¶ä¸ºçº¯å±•ç¤ºå‹ç»„ä»¶ï¼Œæ— éœ€å“åº”å¼æ•°æ®
</script>

<style lang="less" scoped>


.webgpu-guide {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  color: #2c3e50;
  background-color: #f8fafc;
  min-height: 100vh;
  line-height: 1.6;

  header {
    text-align: center;
    margin-bottom: 30px;
    padding: 30px 20px;
    background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%);
    border-radius: 12px;
    color: white;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);

    h1 {
      font-size: 2.4rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    p {
      font-size: 1.2rem;
      opacity: 0.9;
      max-width: 700px;
      margin: 0 auto 25px;
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 20px;

      .stat-card {
        background: rgba(255, 255, 255, 0.15);
        border-radius: 10px;
        padding: 15px 25px;
        min-width: 120px;

        .stat-value {
          font-size: 2.2rem;
          font-weight: 700;
          margin-bottom: 5px;
        }

        .stat-label {
          font-size: 0.95rem;
          opacity: 0.85;
        }
      }
    }
  }

  .content-wrapper {
    background: white;
    border-radius: 12px;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    padding: 30px;
  }

  .section {
    margin-bottom: 40px;

    h2 {
      font-size: 1.8rem;
      color: #4361ee;
      margin-bottom: 25px;
      padding-bottom: 12px;
      border-bottom: 2px solid #eef2ff;
      position: relative;

      &::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 80px;
        height: 3px;
        background: #4361ee;
        border-radius: 3px;
      }
    }
  }

  .overview-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 20px;

    .overview-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid #e2e8f0;

      h3 {
        font-size: 1.3rem;
        color: #3a0ca3;
        margin-top: 0;
        margin-bottom: 15px;
      }

      p,
      ul {
        font-size: 0.95rem;
        color: #475569;
        margin: 0;
        line-height: 1.6;
      }

      ul {
        padding-left: 20px;

        li {
          margin-bottom: 8px;
          position: relative;

          &::before {
            content: 'â€¢';
            color: #4361ee;
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
          }
        }
      }

      .advantages {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;

        .advantage {
          background: #eef2ff;
          color: #4361ee;
          padding: 6px 12px;
          border-radius: 20px;
          font-size: 0.85rem;
          font-weight: 500;
        }
      }
    }
  }

  .concepts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;

    .concept-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid #e2e8f0;
      transition: transform 0.2s ease;

      &:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
      }

      h3 {
        font-size: 1.2rem;
        color: #3a0ca3;
        margin-top: 0;
        margin-bottom: 15px;
      }

      p {
        font-size: 0.95rem;
        color: #475569;
        margin-bottom: 15px;
        line-height: 1.5;
      }
    }
  }

  .usage-steps {
    display: flex;
    flex-direction: column;
    gap: 25px;

    .step {
      display: flex;
      gap: 20px;

      .step-number {
        background: #4361ee;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        font-weight: bold;
        flex-shrink: 0;
        margin-top: 5px;
      }

      .step-content {
        flex-grow: 1;

        h3 {
          font-size: 1.3rem;
          color: #3a0ca3;
          margin-top: 0;
          margin-bottom: 15px;
        }
      }
    }
  }

  .scenarios-grid,
  .resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;

    .scenario-card,
    .resource-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      border: 1px solid #e2e8f0;
      border-top: 3px solid #4361ee;

      h3 {
        font-size: 1.2rem;
        color: #3a0ca3;
        margin-top: 0;
        margin-bottom: 15px;
      }

      ul {
        padding-left: 20px;
        margin: 0;

        li {
          margin-bottom: 10px;
          position: relative;
          font-size: 0.95rem;
          color: #475569;

          &::before {
            content: 'â€¢';
            color: #4361ee;
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
          }
        }
      }
    }
  }

  .comparison-table {
    overflow-x: auto;

    table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      border-radius: 10px;
      overflow: hidden;

      th,
      td {
        padding: 16px 20px;
        text-align: left;
        border-bottom: 1px solid #eee;
        font-size: 0.95rem;
      }

      thead {
        background: linear-gradient(to right, #4361ee, #3a0ca3);
        color: white;

        th {
          font-weight: 600;
        }
      }

      tbody {
        tr {
          &:nth-child(even) {
            background-color: #f9f9f9;
          }

          &:hover {
            background-color: #f0f4ff;
          }
        }
      }
    }
  }

  .code-block {
    background: #2d2d2d;
    color: #f8f8f2;
    padding: 15px;
    border-radius: 8px;
    font-family: 'Fira Code', monospace;
    font-size: 0.9rem;
    overflow-x: auto;
    line-height: 1.5;
    margin: 15px 0;
  }

  footer {
    text-align: center;
    margin-top: 40px;
    padding: 20px;
    color: #64748b;
    font-size: 0.9rem;
    border-top: 1px solid #e2e8f0;
  }

  @media (max-width: 768px) {
    header {
      h1 {
        font-size: 1.8rem;
      }

      p {
        font-size: 1rem;
      }

      .stats {
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }
    }

    .step {
      flex-direction: column;
      gap: 10px;

      .step-number {
        margin-top: 0;
      }
    }
  }
}
</style>
