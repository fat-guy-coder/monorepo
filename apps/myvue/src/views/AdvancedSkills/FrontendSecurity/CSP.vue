<template>
  <div class="csp-container">
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <header class="header">
      <h1 class="title">å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)</h1>
      <p class="subtitle">æ„å»ºå¼ºå¤§çš„å‰ç«¯å®‰å…¨é˜²çº¿</p>
    </header>

    <!-- å®‰å…¨æ‘˜è¦ -->
    <div class="security-summary">
      <div class="security-item">
        <div class="icon">ğŸ›¡ï¸</div>
        <div class="content">
          <h3>XSSæ”»å‡»é˜²å¾¡ç‡</h3>
          <div class="progress-bar">
            <div class="progress" style="width: 95%"></div>
            <span>95%</span>
          </div>
        </div>
      </div>
      <div class="security-item">
        <div class="icon">ğŸ”’</div>
        <div class="content">
          <h3>ç‚¹å‡»åŠ«æŒé˜²å¾¡ç‡</h3>
          <div class="progress-bar">
            <div class="progress" style="width: 100%"></div>
            <span>100%</span>
          </div>
        </div>
      </div>
      <div class="security-item">
        <div class="icon">ğŸš«</div>
        <div class="content">
          <h3>æ•°æ®æ³„éœ²é˜²æŠ¤</h3>
          <div class="progress-bar">
            <div class="progress" style="width: 85%"></div>
            <span>85%</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="content-grid">
      <!-- ä»€ä¹ˆæ˜¯CSP -->
      <div class="card what-is-csp">
        <div class="card-header">
          <div class="card-icon">â“</div>
          <h2>ä»€ä¹ˆæ˜¯å†…å®¹å®‰å…¨ç­–ç•¥(CSP)?</h2>
        </div>
        <div class="card-body">
          <p>CSPæ˜¯ä¸€ç§å®‰å…¨å±‚ï¼Œé€šè¿‡æŒ‡å®šå…è®¸åŠ è½½èµ„æºçš„æ¥æºï¼Œå¸®åŠ©æ£€æµ‹å’Œç¼“è§£æŸäº›ç±»å‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬(XSS)å’Œæ•°æ®æ³¨å…¥æ”»å‡»ã€‚</p>

          <div class="analogy">
            <div class="analogy-icon">ğŸ°</div>
            <div class="analogy-content">
              <h3>ç±»æ¯”ï¼šWebåº”ç”¨çš„"é—¨ç¦ç³»ç»Ÿ"</h3>
              <p>å°±åƒå¤§æ¥¼çš„é—¨ç¦ç³»ç»Ÿåªå…è®¸æˆæƒäººå‘˜è¿›å…¥ï¼ŒCSPåªå…è®¸æ¥è‡ªå¯ä¿¡æ¥æºçš„èµ„æºåŠ è½½å’Œæ‰§è¡Œã€‚</p>
            </div>
          </div>

          <div class="key-points">
            <div class="point">
              <div class="point-icon">âœ…</div>
              <p>é™åˆ¶èµ„æºåŠ è½½æ¥æºï¼ˆè„šæœ¬ã€æ ·å¼ã€å›¾ç‰‡ç­‰ï¼‰</p>
            </div>
            <div class="point">
              <div class="point-icon">âœ…</div>
              <p>é˜»æ­¢å†…è”è„šæœ¬æ‰§è¡Œ</p>
            </div>
            <div class="point">
              <div class="point-icon">âœ…</div>
              <p>æŠ¥å‘Šè¿è§„è¡Œä¸º</p>
            </div>
          </div>
        </div>
      </div>

      <!-- CSPå¦‚ä½•å·¥ä½œ -->
      <div class="card csp-workflow">
        <div class="card-header">
          <div class="card-icon">âš™ï¸</div>
          <h2>CSPå¦‚ä½•å·¥ä½œï¼Ÿ</h2>
        </div>
        <div class="card-body">
          <div class="workflow-steps">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h3>å®šä¹‰ç­–ç•¥</h3>
                <p>é€šè¿‡HTTPå¤´æˆ–metaæ ‡ç­¾å®šä¹‰å†…å®¹å®‰å…¨ç­–ç•¥</p>
                <div class="code-example">
                  <pre><code>Content-Security-Policy:
  default-src 'self';
  script-src 'self' https://trusted.cdn.com;
  style-src 'self' 'unsafe-inline';
  img-src *;
  report-uri /csp-report</code></pre>
                </div>
              </div>
            </div>

            <div class="step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h3>æµè§ˆå™¨æ‰§è¡Œç­–ç•¥</h3>
                <p>æµè§ˆå™¨è§£æç­–ç•¥å¹¶åªåŠ è½½å…è®¸çš„èµ„æº</p>
              </div>
            </div>

            <div class="step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h3>æ‹¦æˆªè¿è§„èµ„æº</h3>
                <p>é˜»æ­¢åŠ è½½æˆ–æ‰§è¡Œä¸ç¬¦åˆç­–ç•¥çš„èµ„æº</p>
              </div>
            </div>

            <div class="step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h3>ç”Ÿæˆè¿è§„æŠ¥å‘Š</h3>
                <p>å°†è¿è§„è¡Œä¸ºå‘é€åˆ°æŒ‡å®šæŠ¥å‘Šç«¯ç‚¹</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ä¸»è¦é…ç½®æŒ‡ä»¤ -->
      <div class="card csp-directives">
        <div class="card-header">
          <div class="card-icon">ğŸ”§</div>
          <h2>CSPä¸»è¦é…ç½®æŒ‡ä»¤</h2>
        </div>
        <div class="card-body">
          <div class="directive-tabs">
            <button v-for="tab in tabs" :key="tab.id" :class="{ active: activeTab === tab.id }"
              @click="activeTab = tab.id">
              {{ tab.label }}
            </button>
          </div>

          <div class="directive-content">
            <div v-if="activeTab === 'fetch'" class="directive-group">
              <div class="directive-item">
                <h3>default-src</h3>
                <p>å…¶ä»–èµ„æºç±»å‹çš„é»˜è®¤ç­–ç•¥</p>
                <div class="values">
                  <div class="value">
                    <code>'self'</code>
                    <span>åªå…è®¸åŒæºèµ„æº</span>
                  </div>
                  <div class="value">
                    <code>'none'</code>
                    <span>ç¦æ­¢åŠ è½½ä»»ä½•èµ„æº</span>
                  </div>
                  <div class="value">
                    <code>https:</code>
                    <span>å…è®¸æ‰€æœ‰HTTPSèµ„æº</span>
                  </div>
                </div>
              </div>

              <div class="directive-item">
                <h3>script-src</h3>
                <p>æ§åˆ¶JavaScriptçš„æ‰§è¡Œæ¥æº</p>
                <div class="values">
                  <div class="value">
                    <code>'unsafe-inline'</code>
                    <span>å…è®¸å†…è”è„šæœ¬ï¼ˆä¸æ¨èï¼‰</span>
                  </div>
                  <div class="value">
                    <code>'unsafe-eval'</code>
                    <span>å…è®¸eval()å‡½æ•°ï¼ˆä¸æ¨èï¼‰</span>
                  </div>
                  <div class="value">
                    <code>'nonce-{value}'</code>
                    <span>å…è®¸ç‰¹å®šnonceçš„å†…è”è„šæœ¬</span>
                  </div>
                </div>
              </div>

              <div class="directive-item">
                <h3>style-src</h3>
                <p>æ§åˆ¶æ ·å¼è¡¨çš„åŠ è½½æ¥æº</p>
                <div class="values">
                  <div class="value">
                    <code>'self'</code>
                    <span>åªå…è®¸åŒæºæ ·å¼</span>
                  </div>
                  <div class="value">
                    <code>'unsafe-inline'</code>
                    <span>å…è®¸å†…è”æ ·å¼</span>
                  </div>
                  <div class="value">
                    <code>'sha256-...'</code>
                    <span>å…è®¸ç‰¹å®šå“ˆå¸Œçš„å†…è”æ ·å¼</span>
                  </div>
                </div>
              </div>
            </div>

            <div v-if="activeTab === 'document'" class="directive-group">
              <div class="directive-item">
                <h3>base-uri</h3>
                <p>é™åˆ¶&lt;base&gt;å…ƒç´ çš„URL</p>
                <div class="code-example">
                  <pre><code>base-uri 'self'; // åªå…è®¸åŒæºbase URL</code></pre>
                </div>
              </div>

              <div class="directive-item">
                <h3>form-action</h3>
                <p>é™åˆ¶è¡¨å•å¯ä»¥æäº¤çš„URL</p>
                <div class="code-example">
                  <pre><code>form-action 'self' https://api.example.com;</code></pre>
                </div>
              </div>

              <div class="directive-item">
                <h3>frame-ancestors</h3>
                <p>é™åˆ¶é¡µé¢æ˜¯å¦å¯ä»¥è¢«åµŒå…¥ï¼ˆframe, iframeç­‰ï¼‰</p>
                <div class="values">
                  <div class="value">
                    <code>'none'</code>
                    <span>ç¦æ­¢ä»»ä½•åµŒå…¥</span>
                  </div>
                  <div class="value">
                    <code>'self'</code>
                    <span>åªå…è®¸åŒæºé¡µé¢åµŒå…¥</span>
                  </div>
                </div>
              </div>
            </div>

            <div v-if="activeTab === 'reporting'" class="directive-group">
              <div class="directive-item">
                <h3>report-uri</h3>
                <p>æŒ‡å®šè¿è§„æŠ¥å‘Šå‘é€çš„URLï¼ˆCSP2ï¼‰</p>
                <div class="code-example">
                  <pre><code>report-uri /csp-violation-report-endpoint;</code></pre>
                </div>
              </div>

              <div class="directive-item">
                <h3>report-to</h3>
                <p>æŒ‡å®šè¿è§„æŠ¥å‘Šå‘é€çš„ç«¯ç‚¹ï¼ˆCSP3ï¼‰</p>
                <div class="code-example">
                  <pre><code>report-to csp-endpoint;</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CSPåœ¨ç½‘ç»œå®‰å…¨ä¸­çš„ä½œç”¨ -->
      <div class="card csp-security">
        <div class="card-header">
          <div class="card-icon">ğŸ›¡ï¸</div>
          <h2>CSPåœ¨ç½‘ç»œå®‰å…¨ä¸­çš„ä½œç”¨</h2>
        </div>
        <div class="card-body">
          <div class="security-grid">
            <div class="security-item">
              <div class="icon red">XSS</div>
              <h3>é˜²å¾¡è·¨ç«™è„šæœ¬æ”»å‡»</h3>
              <ul>
                <li>é˜»æ­¢æœªç»æˆæƒçš„å¤–éƒ¨è„šæœ¬æ‰§è¡Œ</li>
                <li>é™åˆ¶å†…è”è„šæœ¬æ‰§è¡Œ</li>
                <li>é˜²æ­¢æ¶æ„äº‹ä»¶å¤„ç†ç¨‹åºæ³¨å…¥</li>
                <li>é˜»æ­¢javascript: URLæ‰§è¡Œ</li>
              </ul>
            </div>

            <div class="security-item">
              <div class="icon blue">ğŸ”</div>
              <h3>é˜²å¾¡ç‚¹å‡»åŠ«æŒ</h3>
              <ul>
                <li>ä½¿ç”¨frame-ancestorsæŒ‡ä»¤</li>
                <li>æ›¿ä»£X-Frame-Optionså¤´éƒ¨</li>
                <li>ç²¾ç¡®æ§åˆ¶é¡µé¢åµŒå…¥æƒé™</li>
                <li>æ”¯æŒæ›´çµæ´»çš„æ¥æºæ§åˆ¶</li>
              </ul>
            </div>

            <div class="security-item">
              <div class="icon green">ğŸ“¦</div>
              <h3>é™åˆ¶èµ„æºåŠ è½½</h3>
              <ul>
                <li>é˜²æ­¢æ¶æ„èµ„æºåŠ è½½</li>
                <li>é˜»æ­¢æ•°æ®æ³„éœ²åˆ°å¤–éƒ¨åŸŸ</li>
                <li>æ§åˆ¶æ’ä»¶å†…å®¹æ‰§è¡Œ</li>
                <li>é˜²æ­¢æ··åˆå†…å®¹é—®é¢˜</li>
              </ul>
            </div>

            <div class="security-item">
              <div class="icon purple">ğŸ“</div>
              <h3>è¿è§„æŠ¥å‘Šä¸åˆ†æ</h3>
              <ul>
                <li>æ£€æµ‹æ½œåœ¨æ”»å‡»å°è¯•</li>
                <li>ç›‘æ§ç­–ç•¥æœ‰æ•ˆæ€§</li>
                <li>è¯†åˆ«é”™è¯¯é…ç½®</li>
                <li>å¸®åŠ©ä¼˜åŒ–å®‰å…¨ç­–ç•¥</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- CSPé…ç½®ç¤ºä¾‹ -->
      <div class="card csp-examples">
        <div class="card-header">
          <div class="card-icon">ğŸ“‹</div>
          <h2>CSPé…ç½®ç¤ºä¾‹</h2>
        </div>
        <div class="card-body">
          <div class="example-tabs">
            <button v-for="example in examples" :key="example.id" :class="{ active: activeExample === example.id }"
              @click="activeExample = example.id">
              {{ example.label }}
            </button>
          </div>

          <div class="example-content">
            <div v-if="activeExample === 'strict'">
              <h3>ä¸¥æ ¼ç­–ç•¥ (æ¨è)</h3>
              <div class="code-example">
                <pre><code>Content-Security-Policy:
  default-src 'none';
  script-src 'self' 'nonce-{{ randomNonce }}';
  style-src 'self' 'sha256-{{ styleHash }}';
  img-src 'self' data:;
  font-src 'self';
  connect-src 'self';
  form-action 'self';
  frame-ancestors 'none';
  base-uri 'self';
  report-uri /csp-report;
  upgrade-insecure-requests;</code></pre>
              </div>
              <div class="features">
                <div class="feature">
                  <div class="icon">âœ…</div>
                  <p>å®Œå…¨ç¦æ­¢å†…è”è„šæœ¬</p>
                </div>
                <div class="feature">
                  <div class="icon">âœ…</div>
                  <p>ä½¿ç”¨nonceæˆ–hashæ‰§è¡Œå¿…è¦å†…è”è„šæœ¬</p>
                </div>
                <div class="feature">
                  <div class="icon">âœ…</div>
                  <p>ç¦æ­¢æ¡†æ¶åµŒå…¥</p>
                </div>
              </div>
            </div>

            <div v-if="activeExample === 'vue'">
              <h3>Vueåº”ç”¨ç­–ç•¥</h3>
              <div class="code-example">
                <pre><code>Content-Security-Policy:
  default-src 'self';
  script-src 'self' 'unsafe-eval' 'nonce-{{ randomNonce }}';
  style-src 'self' 'unsafe-inline';
  img-src 'self' data:;
  connect-src 'self' https://api.example.com;
  font-src 'self';
  frame-ancestors 'none';
  report-to csp-endpoint;</code></pre>
              </div>
              <div class="notes">
                <h4>Vueåº”ç”¨æ³¨æ„äº‹é¡¹ï¼š</h4>
                <ul>
                  <li>Vueéœ€è¦<code>'unsafe-eval'</code>ç”¨äºè¿è¡Œæ—¶æ¨¡æ¿ç¼–è¯‘</li>
                  <li>ä½¿ç”¨Vue CLIæ„å»ºæ—¶å¯é¿å…<code>'unsafe-eval'</code></li>
                  <li>å†…è”æ ·å¼éœ€è¦<code>'unsafe-inline'</code>æˆ–ä½¿ç”¨å“ˆå¸Œ</li>
                  <li>æ¨èä½¿ç”¨nonceå¤„ç†å†…è”è„šæœ¬</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æœ€ä½³å®è·µ -->
    <div class="best-practices">
      <h2>CSPå®æ–½æœ€ä½³å®è·µ</h2>
      <div class="practices-grid">
        <div class="practice-item">
          <div class="number">1</div>
          <p>ä»<code>Content-Security-Policy-Report-Only</code>å¼€å§‹</p>
        </div>
        <div class="practice-item">
          <div class="number">2</div>
          <p>ä½¿ç”¨<code>default-src 'none'</code>ä½œä¸ºèµ·ç‚¹</p>
        </div>
        <div class="practice-item">
          <div class="number">3</div>
          <p>é¿å…ä½¿ç”¨<code>'unsafe-inline'</code>å’Œ<code>'unsafe-eval'</code></p>
        </div>
        <div class="practice-item">
          <div class="number">4</div>
          <p>ä¸ºæ¯ä¸ªé¡µé¢ç”Ÿæˆå”¯ä¸€çš„nonceå€¼</p>
        </div>
        <div class="practice-item">
          <div class="number">5</div>
          <p>å®ç°æŠ¥å‘Šç«¯ç‚¹å¹¶å®šæœŸåˆ†ææŠ¥å‘Š</p>
        </div>
        <div class="practice-item">
          <div class="number">6</div>
          <p>ä½¿ç”¨<code>frame-ancestors</code>é˜²å¾¡ç‚¹å‡»åŠ«æŒ</p>
        </div>
      </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="footer">
      <p>Â© 2023 Webå®‰å…¨æŒ‡å— | å†…å®¹å®‰å…¨ç­–ç•¥æ˜¯ç°ä»£åŒ–Webåº”ç”¨çš„åŸºæœ¬å®‰å…¨è¦æ±‚</p>
      <p>è®°ä½ï¼šCSPä¸æ˜¯ä¸‡èƒ½çš„ï¼Œåº”ä½œä¸ºæ·±åº¦é˜²å¾¡ç­–ç•¥çš„ä¸€éƒ¨åˆ†</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// é…ç½®æ ‡ç­¾é¡µ
const tabs = [
  { id: 'fetch', label: 'èµ„æºåŠ è½½æŒ‡ä»¤' },
  { id: 'document', label: 'æ–‡æ¡£æŒ‡ä»¤' },
  { id: 'reporting', label: 'æŠ¥å‘ŠæŒ‡ä»¤' }
];
const activeTab = ref('fetch');

// ç¤ºä¾‹æ ‡ç­¾é¡µ
const examples = [
  { id: 'strict', label: 'ä¸¥æ ¼ç­–ç•¥' },
  { id: 'vue', label: 'Vueåº”ç”¨ç­–ç•¥' }
];
const activeExample = ref('strict');

// ç”Ÿæˆéšæœºnonceå€¼ï¼ˆæ¨¡æ‹Ÿï¼‰
const randomNonce = 'R8B7k2Jx9FgT3dQw5ZpL4YhN6MvE1cS';
const styleHash = '3dQw5ZpL4YhN6MvE1cSR8B7k2Jx9FgT';
</script>

<style lang="less" scoped>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');

:root {
  --primary: #3498db;
  --primary-dark: #2980b9;
  --secondary: #2ecc71;
  --accent: #9b59b6;
  --danger: #e74c3c;
  --warning: #f39c12;
  --dark: #2c3e50;
  --light: #ecf0f1;
  --gray: #95a5a6;
  --light-gray: #bdc3c7;
  --border-radius: 10px;
  --box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  --transition: all 0.3s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.csp-container {
  font-family: 'Noto Sans SC', sans-serif;
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem 1.5rem;
  background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
  color: var(--dark);
  line-height: 1.6;
  min-height: 100vh;
}

.header {
  text-align: center;
  margin-bottom: 2rem;
  padding: 2rem;
  background: white;
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);


  .title {
    font-size: 2.5rem;
    color: #000;
    margin-bottom: 0.5rem;
    font-weight: 700;
    background: linear-gradient(45deg, var(--primary), var(--accent));
    -webkit-background-clip: text;
    background-clip: text;
  }

  .subtitle {
    font-size: 1.4rem;
    color: var(--gray);
    font-weight: 400;
  }
}

.security-summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;

  .security-item {
    display: flex;
    background: white;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 1.5rem;
    align-items: center;

    .icon {
      font-size: 2.5rem;
      margin-right: 1.5rem;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #e3f2fd;
      border-radius: 50%;
    }

    .content {
      flex: 1;

      h3 {
        margin-bottom: 0.8rem;
        font-size: 1.2rem;
        color: var(--dark);
      }
    }
  }
}

.progress-bar {
  height: 10px;
  background: #e0e0e0;
  border-radius: 5px;
  position: relative;
  overflow: hidden;

  .progress {
    height: 100%;
    background: linear-gradient(to right, var(--primary), var(--secondary));
    border-radius: 5px;
  }

  span {
    position: absolute;
    right: 0;
    top: -25px;
    font-weight: bold;
    color: var(--primary);
  }
}

.content-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-bottom: 3rem;
}

.card {
  background: white;
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  overflow: hidden;
  transition: var(--transition);

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  }

  &-header {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    background: linear-gradient(to right, var(--primary), var(--primary-dark));
    color: white;

    .card-icon {
      font-size: 2rem;
      margin-right: 1rem;
      background: rgba(255, 255, 255, 0.2);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    h2 {
      font-size: 1.6rem;
      font-weight: 500;
    }
  }

  &-body {
    padding: 1.5rem;

    p {
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
  }
}

.what-is-csp {
  .analogy {
    display: flex;
    margin: 1.5rem 0;
    padding: 1rem;
    background: #e3f2fd;
    border-radius: var(--border-radius);

    .analogy-icon {
      font-size: 2.5rem;
      margin-right: 1rem;
    }

    .analogy-content {
      h3 {
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
        color: var(--dark);
      }
    }
  }

  .key-points {
    .point {
      display: flex;
      margin-bottom: 1rem;
      padding: 0.8rem;
      background: #f8f9fa;
      border-radius: 8px;

      .point-icon {
        font-size: 1.5rem;
        margin-right: 1rem;
        color: var(--secondary);
      }

      p {
        margin: 0;
        flex: 1;
      }
    }
  }
}

.csp-workflow {
  .workflow-steps {
    .step {
      display: flex;
      margin-bottom: 1.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px dashed #eee;

      &:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }

      .step-number {
        width: 32px;
        height: 32px;
        background: var(--primary);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 1rem;
        flex-shrink: 0;
      }

      .step-content {
        h3 {
          font-size: 1.2rem;
          margin-bottom: 0.5rem;
          color: var(--dark);
        }

        p {
          margin-bottom: 0.8rem;
          font-size: 1rem;
        }
      }
    }
  }
}

.csp-directives {
  grid-column: span 2;

  .directive-tabs {
    display: flex;
    border-bottom: 1px solid #eee;
    margin-bottom: 1.5rem;

    button {
      padding: 0.8rem 1.5rem;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      color: var(--gray);
      position: relative;

      &.active {
        color: var(--primary);

        &::after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          width: 100%;
          height: 3px;
          background: var(--primary);
        }
      }
    }
  }

  .directive-content {
    .directive-group {
      .directive-item {
        margin-bottom: 1.5rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #f0f0f0;

        &:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }

        h3 {
          font-size: 1.3rem;
          margin-bottom: 0.5rem;
          color: var(--primary);
        }

        p {
          margin-bottom: 1rem;
          color: var(--gray);
        }

        .values {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;

          .value {
            background: #f5f7fa;
            padding: 0.8rem;
            border-radius: 6px;
            border-left: 3px solid var(--primary);

            code {
              display: block;
              font-weight: bold;
              margin-bottom: 0.3rem;
              color: var(--dark);
            }

            span {
              font-size: 0.9rem;
              color: var(--gray);
            }
          }
        }
      }
    }
  }
}

.csp-security {
  grid-column: span 2;

  .security-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;

    .security-item {
      background: #f8f9fa;
      border-radius: var(--border-radius);
      padding: 1.5rem;
      transition: var(--transition);
      border-top: 4px solid var(--primary);

      &:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 1rem;

        &.red {
          background: #ffebee;
          color: #e53935;
        }

        &.blue {
          background: #e3f2fd;
          color: #1e88e5;
        }

        &.green {
          background: #e8f5e9;
          color: #43a047;
        }

        &.purple {
          background: #f3e5f5;
          color: #8e24aa;
        }
      }

      h3 {
        font-size: 1.2rem;
        margin-bottom: 1rem;
        color: var(--dark);
      }

      ul {
        list-style: none;

        li {
          padding: 0.5rem 0;
          position: relative;
          padding-left: 1.5rem;

          &::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: var(--primary);
            font-size: 1.2rem;
          }
        }
      }
    }
  }
}

.csp-examples {
  grid-column: span 2;

  .example-tabs {
    display: flex;
    border-bottom: 1px solid #eee;
    margin-bottom: 1.5rem;

    button {
      padding: 0.8rem 1.5rem;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      color: var(--gray);
      position: relative;

      &.active {
        color: var(--primary);

        &::after {
          content: '';
          position: absolute;
          bottom: -1px;
          left: 0;
          width: 100%;
          height: 3px;
          background: var(--primary);
        }
      }
    }
  }

  .example-content {
    h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--dark);
    }

    .features {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;

      .feature {
        display: flex;
        align-items: center;
        background: #e8f5e9;
        padding: 0.5rem 1rem;
        border-radius: 20px;

        .icon {
          margin-right: 0.5rem;
          color: var(--secondary);
        }
      }
    }

    .notes {
      background: #fff8e1;
      border-radius: var(--border-radius);
      padding: 1.5rem;
      margin-top: 1.5rem;

      h4 {
        margin-bottom: 0.8rem;
        color: var(--dark);
      }

      ul {
        list-style: none;

        li {
          padding: 0.5rem 0;
          position: relative;
          padding-left: 1.5rem;

          &::before {
            content: 'â€¢';
            position: absolute;
            left: 0;
            color: var(--warning);
            font-size: 1.2rem;
          }
        }
      }
    }
  }
}

.code-example {
  background: #2c3e50;
  color: #f8f8f2;
  border-radius: 8px;
  padding: 1rem;
  margin: 1rem 0;
  overflow-x: auto;
  font-family: 'Source Code Pro', monospace;
  font-size: 0.95rem;
  line-height: 1.5;

  pre {
    margin: 0;
  }

  code {
    font-family: inherit;
  }
}

.best-practices {
  background: white;
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  padding: 2rem;
  margin-bottom: 2rem;

  h2 {
    text-align: center;
    margin-bottom: 1.5rem;
    font-size: 1.8rem;
    color: var(--dark);
    position: relative;

    &::after {
      content: '';
      display: block;
      width: 80px;
      height: 4px;
      background: var(--primary);
      margin: 0.8rem auto;
      border-radius: 2px;
    }
  }

  .practices-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
  }

  .practice-item {
    background: #f0f7ff;
    border-radius: var(--border-radius);
    padding: 1.5rem;
    display: flex;
    align-items: center;

    .number {
      width: 36px;
      height: 36px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin-right: 1rem;
      flex-shrink: 0;
    }

    p {
      margin: 0;
      font-size: 1.1rem;

      code {
        background: #e3f2fd;
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-family: monospace;
      }
    }
  }
}

.footer {
  text-align: center;
  padding: 2rem 0;
  color: var(--gray);
  font-size: 0.9rem;

  p {
    margin-bottom: 0.3rem;

    &:last-child {
      font-style: italic;
      color: var(--dark);
    }
  }
}

@media (max-width: 900px) {

  .csp-directives,
  .csp-security,
  .csp-examples {
    grid-column: 1;
  }

  .content-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 600px) {
  .header {
    padding: 1.5rem;

    .title {
      font-size: 2rem;
    }

    .subtitle {
      font-size: 1.2rem;
    }
  }

  .security-summary {
    grid-template-columns: 1fr;
  }
}
</style>