<template>
  <div class="xss-container">
    <header class="header">
      <h1>è·¨ç«™è„šæœ¬æ”»å‡»(XSS)åŸºæœ¬ä»‹ç»</h1>
      <div class="subtitle">Webå®‰å…¨çš„é¦–è¦å¨èƒä¸é˜²å¾¡ç­–ç•¥</div>
    </header>

    <div class="alert-banner">
      <div class="alert-content">
        <div class="alert-icon">âš ï¸</div>
        <div>
          <strong>å®‰å…¨è­¦å‘Šï¼š</strong> XSSæ”»å‡»é•¿æœŸä½åˆ—OWASP Top 10å®‰å…¨é£é™©ï¼Œå æ‰€æœ‰Webåº”ç”¨æ¼æ´çš„65%ä»¥ä¸Š
        </div>
      </div>
    </div>

    <div class="section">
      <h2 class="section-title">
        <div class="title-icon">ğŸ”</div>
        <span>XSSæ”»å‡»åŸç†</span>
      </h2>
      <div class="content">
        <div class="definition-box">
          <strong>è·¨ç«™è„šæœ¬æ”»å‡»(XSS)</strong> æ˜¯ä¸€ç§å°†æ¶æ„è„šæœ¬æ³¨å…¥åˆ°å¯ä¿¡ç½‘ç«™ä¸­çš„æ”»å‡»æ–¹å¼ã€‚å½“ç”¨æˆ·è®¿é—®è¢«æ³¨å…¥æ¶æ„è„šæœ¬çš„é¡µé¢æ—¶ï¼Œè¿™äº›è„šæœ¬ä¼šåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚
        </div>

        <div class="attack-flow">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>æ”»å‡»è€…æ„é€ æ¶æ„è„šæœ¬</h3>
              <p>åŒ…å«çªƒå–cookieã€ä¼šè¯åŠ«æŒã€é’“é±¼ç­‰åŠŸèƒ½çš„æ¶æ„JavaScriptä»£ç </p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>æ³¨å…¥åˆ°ç›®æ ‡ç½‘ç«™</h3>
              <p>é€šè¿‡è¾“å…¥è¡¨å•ã€URLå‚æ•°ã€è¯„è®ºåŒºåŸŸç­‰æ³¨å…¥ç‚¹</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>ç”¨æˆ·è®¿é—®è¢«æ„ŸæŸ“çš„é¡µé¢</h3>
              <p>æ¶æ„è„šæœ¬éšæ­£å¸¸é¡µé¢åŠ è½½æ‰§è¡Œ</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h3>æ•æ„Ÿæ•°æ®æ³„éœ²</h3>
              <p>ç”¨æˆ·ä¼šè¯ã€ä¸ªäººä¿¡æ¯ã€å‡­è¯ç­‰è¢«å‘é€åˆ°æ”»å‡»è€…æœåŠ¡å™¨</p>
            </div>
          </div>
        </div>

        <div class="illustration">
          <div class="browser">
            <div class="browser-header">
              <div class="browser-dots">
                <div class="dot red"></div>
                <div class="dot yellow"></div>
                <div class="dot green"></div>
              </div>
              <div class="browser-url">https://yourbank.com/account?search=<span
                  class="malicious">&lt;script&gt;stealCookies()&lt;/script&gt;</span></div>
            </div>
            <div class="browser-content">
              <div class="user-content">æ¬¢è¿å›æ¥ï¼Œç”¨æˆ·å</div>
              <div class="malicious-script">
                <div class="script-box">
                  &lt;script&gt;
                  <div class="malicious-line">sendToAttacker(document.cookie);</div>
                  &lt;/script&gt;
                </div>
                <div class="data-flow">
                  <div class="data-dot"></div>
                  <div class="data-line"></div>
                  <div class="attacker-server">æ”»å‡»è€…æœåŠ¡å™¨</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section attack-types">
      <h2 class="section-title">
        <div class="title-icon">âš ï¸</div>
        <span>XSSæ”»å‡»ç±»å‹</span>
      </h2>
      <div class="content">
        <div class="type-cards">
          <div class="type-card reflective">
            <h3>åå°„å‹XSS</h3>
            <div class="type-icon">â†ªï¸</div>
            <ul>
              <li>æ¶æ„è„šæœ¬æ¥è‡ªå½“å‰HTTPè¯·æ±‚</li>
              <li>é€šå¸¸é€šè¿‡URLå‚æ•°æ³¨å…¥</li>
              <li>éœ€è¦è¯±éª—ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥</li>
            </ul>
            <div class="example">
              <code>https://site.com?search=&lt;script&gt;alert(1)&lt;/script&gt;</code>
            </div>
          </div>

          <div class="type-card stored">
            <h3>å­˜å‚¨å‹XSS</h3>
            <div class="type-icon">ğŸ’¾</div>
            <ul>
              <li>æ¶æ„è„šæœ¬æ°¸ä¹…å­˜å‚¨åœ¨æœåŠ¡å™¨</li>
              <li>å½±å“æ‰€æœ‰è®¿é—®å—å½±å“é¡µé¢çš„ç”¨æˆ·</li>
              <li>å¸¸è§äºè¯„è®ºã€è®ºå›å¸–å­ç­‰</li>
            </ul>
            <div class="example">
              <code>è¯„è®ºåŒºæ³¨å…¥: &lt;script&gt;malicious()&lt;/script&gt;</code>
            </div>
          </div>

          <div class="type-card dom">
            <h3>åŸºäºDOMçš„XSS</h3>
            <div class="type-icon">ğŸŒ</div>
            <ul>
              <li>å®Œå…¨åœ¨å®¢æˆ·ç«¯å‘ç”Ÿçš„æ¼æ´</li>
              <li>ä¿®æ”¹DOMç¯å¢ƒåœ¨å‰ç«¯æ‰§è¡Œæ¶æ„ä»£ç </li>
              <li>ä¸æ¶‰åŠæœåŠ¡å™¨ç«¯å¤„ç†</li>
            </ul>
            <div class="example">
              <code>location.hashå¯¼è‡´è„šæœ¬æ‰§è¡Œ</code>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="section reflective-xss-demo">
      <h2 class="section-title">
        <div class="title-icon">ğŸ¯</div>
        <span>åå°„å‹XSSæ¼”ç¤º</span>
      </h2>
      <div class="content">
        <div class="demo-container">
          <div class="demo-description">
            <h3>åå°„å‹XSSæ”»å‡»æµç¨‹</h3>
            <p>åå°„å‹XSSæ˜¯æœ€å¸¸è§çš„XSSæ”»å‡»ç±»å‹ä¹‹ä¸€ã€‚æ”»å‡»è€…é€šå¸¸é€šè¿‡æ„é€ ç‰¹æ®Šçš„URL,è¯±å¯¼ç”¨æˆ·ç‚¹å‡»,ä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚</p>
          </div>

          <div class="attack-flow-diagram">
            <div class="flow-step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h4>æ„é€ æ¶æ„é“¾æ¥</h4>
                <code>http://example.com/search?q=&lt;script&gt;alert('å·²è¢«æ”»å‡»')&lt;/script&gt;</code>
              </div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h4>ç”¨æˆ·ç‚¹å‡»é“¾æ¥</h4>
                <p>æ”»å‡»è€…é€šè¿‡ç¤¾äº¤å·¥ç¨‹ç­‰æ‰‹æ®µè¯±å¯¼ç”¨æˆ·ç‚¹å‡»</p>
              </div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h4>æœåŠ¡å™¨å“åº”</h4>
                <p>æœåŠ¡å™¨å°†å‚æ•°æœªç»å¤„ç†ç›´æ¥è¿”å›é¡µé¢</p>
              </div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h4>æ‰§è¡Œæ¶æ„ä»£ç </h4>
                <p>æµè§ˆå™¨è§£æå¹¶æ‰§è¡Œæ³¨å…¥çš„è„šæœ¬</p>
              </div>
            </div>
          </div>

          <div class="prevention-tips">
            <h3>é˜²æŠ¤å»ºè®®</h3>
            <ul>
              <li>å¯¹URLå‚æ•°è¿›è¡Œä¸¥æ ¼è¿‡æ»¤å’Œè½¬ä¹‰</li>
              <li>å®æ–½è¾“å…¥éªŒè¯å’Œè§„èŒƒåŒ–</li>
              <li>ä½¿ç”¨CSPé™åˆ¶è„šæœ¬æ‰§è¡Œ</li>
              <li>é¿å…ç›´æ¥åœ¨é¡µé¢ä¸­åå°„ç”¨æˆ·è¾“å…¥</li>
            </ul>
          </div>
        </div>
      </div>
    </div>


    <div class="section reflective-xss-demo">
      <h2 class="section-title">
        <div class="title-icon">ğŸ’¾</div>
        <span>å­˜å‚¨å‹XSSæ”»å‡»æ¼”ç¤º</span>
      </h2>
      <div class="demo-container">
        <div class="demo-description">
          <h3>ä»€ä¹ˆæ˜¯å­˜å‚¨å‹XSS?</h3>
          <p>å­˜å‚¨å‹XSSæ˜¯æœ€å±é™©çš„XSSæ”»å‡»ç±»å‹ä¹‹ä¸€ã€‚æ”»å‡»è€…å°†æ¶æ„è„šæœ¬æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆåŒ…å«æ­¤æ¶æ„è„šæœ¬çš„é¡µé¢æ—¶ï¼Œè„šæœ¬ä¼šè¢«æ‰§è¡Œã€‚å¸¸è§çš„æ”»å‡»åœºæ™¯åŒ…æ‹¬è®ºå›å¸–å­ã€è¯„è®ºç³»ç»Ÿã€ä¸ªäººä¿¡æ¯ç­‰å…è®¸ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹ã€‚</p>
        </div>

        <div class="attack-flow-diagram">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>æäº¤æ¶æ„å†…å®¹</h4>
              <code>&lt;script&gt;stealCookie()&lt;/script&gt;</code>
              <p>æ”»å‡»è€…åœ¨è¯„è®ºæ¡†ä¸­æäº¤åŒ…å«æ¶æ„ä»£ç çš„å†…å®¹</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>æœåŠ¡å™¨å­˜å‚¨</h4>
              <p>æ¶æ„ä»£ç è¢«ä¿å­˜åˆ°æ•°æ®åº“ä¸­</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>ç”¨æˆ·è®¿é—®</h4>
              <p>å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«æ¶æ„ä»£ç çš„é¡µé¢</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h4>ä»£ç æ‰§è¡Œ</h4>
              <p>æ¶æ„è„šæœ¬åœ¨å—å®³è€…æµè§ˆå™¨ä¸­æ‰§è¡Œ</p>
            </div>
          </div>
        </div>

        <div class="prevention-tips">
          <h3>é˜²æŠ¤å»ºè®®</h3>
          <ul>
            <li>åœ¨å­˜å‚¨æ•°æ®å‰è¿›è¡Œä¸¥æ ¼çš„è¾“å…¥è¿‡æ»¤</li>
            <li>è¾“å‡ºæ—¶è¿›è¡ŒHTMLå®ä½“ç¼–ç </li>
            <li>ä½¿ç”¨å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ—¶é‡‡ç”¨ç™½åå•è¿‡æ»¤</li>
            <li>å®šæœŸæ‰«ææ•°æ®åº“ä¸­çš„å¯ç–‘å†…å®¹</li>
          </ul>
        </div>
      </div>
    </div>


    <div class="section dom-xss">
      <h2 class="section-title">
        <div class="title-icon">ğŸ”</div>
        <span>åŸºäºDOMçš„XSSæ”»å‡»</span>
      </h2>
      <div class="content">
        <div class="demo-description">
          <h3>ä»€ä¹ˆæ˜¯DOMå‹XSS?</h3>
          <p>DOMå‹XSSæ˜¯ä¸€ç§ç‰¹æ®Šçš„è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ”»å‡»ä»£ç ä¸éœ€è¦æœåŠ¡å™¨ç«¯çš„å‚ä¸ï¼Œè€Œæ˜¯é€šè¿‡æµè§ˆå™¨ç«¯çš„DOMæ“ä½œè§¦å‘ã€‚æ”»å‡»è€…é€šå¸¸é€šè¿‡ä¿®æ”¹é¡µé¢URLä¸­çš„å‚æ•°æˆ–å…¶ä»–å®¢æˆ·ç«¯æ•°æ®æ¥å®ç°æ”»å‡»ã€‚</p>
        </div>

        <div class="attack-flow-diagram">
          <div class="flow-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h4>æ„é€ æ¶æ„URL</h4>
              <code>http://example.com?name=&lt;script&gt;alert(1)&lt;/script&gt;</code>
              <p>æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„URLå‚æ•°</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h4>ç”¨æˆ·è®¿é—®</h4>
              <p>å—å®³è€…ç‚¹å‡»æ¶æ„é“¾æ¥è®¿é—®é¡µé¢</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h4>DOMæ“ä½œ</h4>
              <p>JavaScriptä»£ç è¯»å–URLå‚æ•°å¹¶æ›´æ–°DOM</p>
            </div>
          </div>
          <div class="flow-arrow">â†’</div>
          <div class="flow-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h4>æ”»å‡»æ‰§è¡Œ</h4>
              <p>æ¶æ„ä»£ç é€šè¿‡DOMæ“ä½œè¢«æ‰§è¡Œ</p>
            </div>
          </div>
        </div>

        <div class="prevention-tips">
          <h3>é˜²æŠ¤å»ºè®®</h3>
          <ul>
            <li>ä½¿ç”¨å®‰å…¨çš„DOM APIå’Œæ“ä½œæ–¹æ³•</li>
            <li>å¯¹URLå‚æ•°å’ŒDOMæ•°æ®è¿›è¡Œä¸¥æ ¼è¿‡æ»¤</li>
            <li>é¿å…ä½¿ç”¨eval()ç­‰å±é™©å‡½æ•°</li>
            <li>ä½¿ç”¨textContentæ›¿ä»£innerHTML</li>
          </ul>
        </div>
      </div>
    </div>


    <div class="section protection">
      <h2 class="section-title">
        <div class="title-icon">ğŸ›¡ï¸</div>
        <span>XSSé˜²æŠ¤ç­–ç•¥</span>
      </h2>
      <div class="content">
        <div class="defense-grid">
          <div class="defense-card">
            <div class="defense-icon">âœ‚ï¸</div>
            <h3>è¾“å…¥éªŒè¯ä¸è¿‡æ»¤</h3>
            <ul>
              <li>ä½¿ç”¨ç™½åå•è¿‡æ»¤è¾“å…¥å†…å®¹</li>
              <li>ç§»é™¤ç‰¹æ®Šå­—ç¬¦å’Œè„šæœ¬æ ‡ç­¾</li>
              <li>éªŒè¯æ•°æ®ç±»å‹å’Œæ ¼å¼</li>
            </ul>
          </div>

          <div class="defense-card">
            <div class="defense-icon">ğŸ”’</div>
            <h3>è¾“å‡ºç¼–ç </h3>
            <ul>
              <li>HTMLå®ä½“ç¼–ç : &amp;lt; &amp;gt; &amp;amp;</li>
              <li>JavaScriptç¼–ç </li>
              <li>URLç¼–ç </li>
            </ul>
            <div class="code-example">
              <pre><code>// Vueä¸­è‡ªåŠ¨ç¼–ç 
&lt;div&gt; userInput &lt;/div&gt;

// æ‰‹åŠ¨ç¼–ç å‡½æ•°
function encodeHTML(str) {
  return str.replace(/[&<>"']/g,
    match => `&amp;${map[match]};`);
}</code></pre>
            </div>
          </div>

          <div class="defense-card">
            <div class="defense-icon">ğŸ“œ</div>
            <h3>å†…å®¹å®‰å…¨ç­–ç•¥(CSP)</h3>
            <ul>
              <li>é™åˆ¶è„šæœ¬æ¥æº</li>
              <li>ç¦æ­¢å†…è”è„šæœ¬</li>
              <li>æŠ¥å‘Šç­–ç•¥è¿è§„</li>
            </ul>
            <div class="code-example">
              <pre><code>// HTTPå“åº”å¤´
Content-Security-Policy:
  default-src 'self';
  script-src 'self' https://trusted.cdn;
  style-src 'self' 'unsafe-inline';
  img-src * data:;</code></pre>
            </div>
          </div>

          <div class="defense-card">
            <div class="defense-icon">ğŸª</div>
            <h3>HttpOnly Cookies</h3>
            <ul>
              <li>é˜»æ­¢JavaScriptè®¿é—®æ•æ„Ÿcookie</li>
              <li>ä¼šè¯cookieå¿…é¡»è®¾ç½®HttpOnly</li>
              <li>é™ä½ä¼šè¯åŠ«æŒé£é™©</li>
            </ul>
            <div class="code-example">
              <pre><code>// è®¾ç½®HttpOnly Cookie
Set-Cookie: sessionId=abc123;
  HttpOnly; Secure; SameSite=Strict</code></pre>
            </div>
          </div>

          <div class="defense-card">
            <div class="defense-icon">ğŸ›¡ï¸</div>
            <h3>å®‰å…¨æ¡†æ¶</h3>
            <ul>
              <li>ä½¿ç”¨ç°ä»£å‰ç«¯æ¡†æ¶(Vue/React/Angular)</li>
              <li>åˆ©ç”¨å†…ç½®çš„XSSé˜²æŠ¤æœºåˆ¶</li>
              <li>é¿å…ä½¿ç”¨v-html/dangerouslySetInnerHTML</li>
            </ul>
          </div>

          <div class="defense-card">
            <div class="defense-icon">ğŸ”</div>
            <h3>å®‰å…¨æ‰«æä¸æµ‹è¯•</h3>
            <ul>
              <li>è‡ªåŠ¨åŒ–æ¼æ´æ‰«æå·¥å…·</li>
              <li>æ‰‹åŠ¨æ¸—é€æµ‹è¯•</li>
              <li>ä»£ç å®¡è®¡</li>
            </ul>
          </div>
        </div>

        <div class="comparison">
          <div class="vulnerable">
            <h3>å­˜åœ¨æ¼æ´çš„ä»£ç </h3>
            <pre><code>// å±é™©ï¼šç›´æ¥è¾“å‡ºæœªç¼–ç çš„ç”¨æˆ·è¾“å…¥
document.getElementById('output').innerHTML =
  userInput;</code></pre>
            <div class="risk-level">é«˜é£é™©</div>
          </div>
          <div class="safe">
            <h3>ä¿®å¤åçš„å®‰å…¨ä»£ç </h3>
            <pre><code>// å®‰å…¨ï¼šä½¿ç”¨textContentä»£æ›¿innerHTML
document.getElementById('output')
  .textContent = userInput;

// æˆ–ä½¿ç”¨ç¼–ç åº“
safeOutput.innerHTML =
  DOMPurify.sanitize(userInput);</code></pre>
            <div class="risk-level safe">å®‰å…¨</div>
          </div>
        </div>
      </div>
    </div>

    <div class="section best-practices">
      <h2 class="section-title">
        <div class="title-icon">âœ…</div>
        <span>XSSé˜²æŠ¤æœ€ä½³å®è·µ</span>
      </h2>
      <div class="content">
        <ul class="practices-list">
          <li><strong>æ·±åº¦é˜²å¾¡ï¼š</strong> ç»„åˆä½¿ç”¨å¤šç§é˜²æŠ¤æªæ–½</li>
          <li><strong>è‡ªåŠ¨è½¬ä¹‰ï¼š</strong> ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„è‡ªåŠ¨è½¬ä¹‰åŠŸèƒ½</li>
          <li><strong>å®‰å…¨åº“ï¼š</strong> ä½¿ç”¨DOMPurifyç­‰å‡€åŒ–åº“å¤„ç†HTMLå†…å®¹</li>
          <li><strong>é¿å…å±é™©APIï¼š</strong> ä¸ä½¿ç”¨eval()ã€document.write()ç­‰å±é™©å‡½æ•°</li>
          <li><strong>æŒç»­æ•™è‚²ï¼š</strong> å¯¹å¼€å‘å›¢é˜Ÿè¿›è¡Œå®‰å…¨ç¼–ç åŸ¹è®­</li>
          <li><strong>å®‰å…¨å“åº”å¤´ï¼š</strong> è®¾ç½®X-XSS-Protection, X-Content-Type-Optionsç­‰</li>
        </ul>
      </div>
    </div>

    <footer class="footer">
      <p>Â© 2023 Webå®‰å…¨ä¸­å¿ƒ | XSSé˜²æŠ¤æ˜¯æ¯ä¸ªå¼€å‘è€…çš„è´£ä»»</p>
    </footer>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// ç¤ºä¾‹æ•°æ®ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½ä»APIè·å–
const stats = ref({
  prevalence: "65%",
  topVulnerability: true,
  reportedCases: "150,000+"
});
</script>

<style lang="less" scoped>
@primary-color: #3498db;
@danger-color: #e74c3c;
@warning-color: #f39c12;
@success-color: #2ecc71;
@dark-color: #2c3e50;
@light-color: #ecf0f1;

.xss-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #333;
  background: #fff;
  box-shadow: 0 5px 25px rgba(0, 0, 0, 0.08);
  border-radius: 12px;
  line-height: 1.6;
}

.header {
  text-align: center;
  margin-bottom: 2rem;
  padding-bottom: 1.5rem;
  border-bottom: 3px solid @danger-color;

  h1 {
    font-size: 2.8rem;
    color: @dark-color;
    margin-bottom: 0.5rem;
    background: linear-gradient(45deg, @dark-color, @danger-color);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  .subtitle {
    font-size: 1.3rem;
    color: #7f8c8d;
    font-weight: 500;
  }
}

.alert-banner {
  background: linear-gradient(90deg, #ffeb3b, #ff9800);
  color: #333;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 2.5rem;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);

  .alert-content {
    display: flex;
    align-items: center;
    max-width: 1000px;
    margin: 0 auto;

    .alert-icon {
      font-size: 2rem;
      margin-right: 1rem;
    }

    div {
      font-size: 1.1rem;
      font-weight: 500;
    }
  }
}

.section {
  margin-bottom: 3.5rem;

  .section-title {
    display: flex;
    align-items: center;
    color: @dark-color;
    font-size: 2rem;
    margin-bottom: 1.8rem;
    padding-bottom: 0.8rem;
    border-bottom: 2px solid @light-color;

    .title-icon {
      font-size: 1.8rem;
      margin-right: 12px;
      width: 50px;
      height: 50px;
      background: #f1f8ff;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }

  .content {
    font-size: 1.1rem;
    color: #555;
  }
}

.definition-box {
  background: #f8f9fa;
  border-left: 4px solid @danger-color;
  padding: 1.2rem 1.5rem;
  border-radius: 0 8px 8px 0;
  margin-bottom: 2rem;
  font-size: 1.2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.attack-flow {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 2.5rem 0;

  .flow-step {
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    padding: 1.2rem;
    width: 22%;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    transition: transform 0.3s;

    &:hover {
      transform: translateY(-5px);
      border-color: @danger-color;
    }

    .step-number {
      width: 36px;
      height: 36px;
      background: @danger-color;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1rem;
      font-weight: bold;
      font-size: 1.2rem;
    }

    h3 {
      color: @danger-color;
      margin-bottom: 0.5rem;
      font-size: 1.25rem;
    }

    p {
      color: #7f8c8d;
      font-size: 0.95rem;
    }
  }

  .flow-arrow {
    font-size: 2rem;
    color: #bbb;
    margin: 0 -10px;
  }
}

.illustration {
  margin: 3rem 0;

  .browser {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    max-width: 800px;
    margin: 0 auto;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);

    .browser-header {
      background: #f1f1f1;
      padding: 10px 15px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #ddd;

      .browser-dots {
        display: flex;
        gap: 6px;
        margin-right: 15px;

        .dot {
          width: 12px;
          height: 12px;
          border-radius: 50%;

          &.red {
            background: #ff5f56;
          }

          &.yellow {
            background: #ffbd2e;
          }

          &.green {
            background: #27c93f;
          }
        }
      }

      .browser-url {
        flex: 1;
        background: white;
        padding: 5px 15px;
        border-radius: 15px;
        font-family: monospace;
        font-size: 0.9rem;
        overflow: hidden;
        text-overflow: ellipsis;

        .malicious {
          color: @danger-color;
          font-weight: bold;
        }
      }
    }

    .browser-content {
      padding: 1.5rem;
      background: white;
      min-height: 200px;
      position: relative;

      .user-content {
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
      }

      .malicious-script {
        background: #fff8f8;
        border: 1px solid #ffdddd;
        border-radius: 6px;
        padding: 1rem;
        font-family: monospace;
        color: @danger-color;
        position: relative;
        overflow: hidden;

        .malicious-line {
          color: #c0392b;
          font-weight: bold;
        }

        .data-flow {
          position: absolute;
          top: 50%;
          right: -100px;
          display: flex;
          align-items: center;

          .data-dot {
            width: 12px;
            height: 12px;
            background: @danger-color;
            border-radius: 50%;
            position: relative;
            z-index: 2;
          }

          .data-line {
            width: 100px;
            height: 2px;
            background: repeating-linear-gradient(to right,
                @danger-color,
                @danger-color 5px,
                transparent 5px,
                transparent 10px);
          }

          .attacker-server {
            background: #f1c40f;
            color: #333;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            white-space: nowrap;
          }
        }
      }
    }
  }
}

.type-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin-top: 1.5rem;

  .type-card {
    border-radius: 10px;
    padding: 1.5rem;
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s;

    &:hover {
      transform: translateY(-7px);
    }

    h3 {
      margin-top: 0;
      font-size: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid rgba(0, 0, 0, 0.1);
    }

    .type-icon {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 2rem;
      opacity: 0.2;
    }

    ul {
      padding-left: 1.5rem;
      margin: 1.5rem 0;

      li {
        margin-bottom: 0.8rem;
        position: relative;
        padding-left: 1rem;

        &::before {
          content: "â€¢";
          position: absolute;
          left: 0;
          color: @danger-color;
          font-weight: bold;
        }

      }
    }

    .example {
      background: rgba(0, 0, 0, 0.05);
      padding: 0.8rem;
      border-radius: 5px;
      font-family: monospace;
      font-size: 0.9rem;
      margin-top: 1rem;
    }
  }

  .reflective {
    background: linear-gradient(135deg, #ffeded, #fff4f4);
    border-top: 4px solid @danger-color;
  }

  .stored {
    background: linear-gradient(135deg, #fff4e6, #fff8f0);
    border-top: 4px solid @warning-color;
  }

  .dom {
    background: linear-gradient(135deg, #e6f4ff, #f0f8ff);
    border-top: 4px solid @primary-color;
  }
}

.defense-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 1.8rem;

  .defense-card {
    background: white;
    border-radius: 10px;
    padding: 1.8rem 1.5rem;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    transition: all 0.3s;
    border: 1px solid #eee;

    &:hover {
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      transform: translateY(-3px);
      border-color: @primary-color;
    }

    .defense-icon {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }

    h3 {
      color: @dark-color;
      font-size: 1.4rem;
      margin: 0.5rem 0 1.2rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px dashed #ddd;
    }

    ul {
      padding-left: 1.2rem;
      margin-bottom: 1.5rem;

      li {
        margin-bottom: 0.8rem;
        color: #555;
      }
    }

    .code-example {
      background: #2d2d2d;
      color: #f8f8f2;
      border-radius: 6px;
      padding: 1rem;
      font-family: 'Fira Code', monospace;
      font-size: 0.9rem;
      overflow-x: auto;

      pre {
        margin: 0;
      }

      code {
        line-height: 1.5;
      }
    }
  }
}

.comparison {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin-top: 3rem;

  .vulnerable,
  .safe {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);

    h3 {
      margin: 0;
      padding: 1.2rem;
      font-size: 1.3rem;
    }

    pre {
      margin: 0;
      padding: 1.5rem;
      font-size: 0.95rem;
      font-family: 'Fira Code', monospace;
      white-space: pre-wrap;
      background: #f8f9fa;
    }

    .risk-level {
      text-align: center;
      padding: 0.8rem;
      font-weight: bold;
      font-size: 1.1rem;
      text-transform: uppercase;
    }
  }

  .vulnerable {
    h3 {
      background: linear-gradient(45deg, #e74c3c, #c0392b);
      color: white;
    }

    pre {
      background: #fff5f5;
      color: #c0392b;
    }

    .risk-level {
      background: #e74c3c;
      color: white;
    }
  }

  .safe {
    h3 {
      background: linear-gradient(45deg, #2ecc71, #27ae60);
      color: white;
    }

    pre {
      background: #f0fff4;
      color: #27ae60;
    }

    .risk-level {
      background: #2ecc71;
      color: white;
    }
  }
}

.practices-list {
  background: linear-gradient(135deg, #f8f9fa, #e9ecef);
  border-radius: 10px;
  padding: 2rem;
  list-style-type: none;

  li {
    margin-bottom: 1.2rem;
    padding-left: 2rem;
    position: relative;
    font-size: 1.1rem;

    &::before {
      content: "âœ“";
      position: absolute;
      left: 0;
      top: 0;
      width: 24px;
      height: 24px;
      background: @success-color;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }

    strong {
      color: @dark-color;
    }
  }
}

.footer {
  text-align: center;
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid #ecf0f1;
  color: #7f8c8d;
  font-size: 0.95rem;
}

@media (max-width: 768px) {
  .xss-container {
    padding: 1rem;
  }

  .header h1 {
    font-size: 2rem;
  }

  .attack-flow {
    flex-direction: column;
    gap: 1.5rem;

    .flow-arrow {
      transform: rotate(90deg);
      margin: 0.5rem 0;
    }
  }

  .type-cards,
  .defense-grid,
  .comparison {
    grid-template-columns: 1fr;
  }
}

.reflective-xss-demo {
  margin: 2rem 0;
  padding: 2rem;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);

  .demo-container {
    padding: 1.5rem;
  }

  .demo-description {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: #f8f9fa;
    border-radius: 8px;

    h3 {
      color: #2c3e50;
      margin-bottom: 1rem;
    }

    p {
      color: #666;
      line-height: 1.6;
    }
  }

  .attack-flow-diagram {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 2rem 0;
    padding: 1.5rem;
    background: #f8f9fa;
    border-radius: 12px;
    flex-wrap: wrap;
    gap: 1rem;

    .flow-step {
      flex: 1;
      min-width: 200px;
      padding: 1rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);

      .step-number {
        width: 30px;
        height: 30px;
        background: #3498db;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
      }

      .step-content {
        h4 {
          color: #2c3e50;
          margin-bottom: 0.5rem;
        }

        code {
          display: block;
          padding: 0.5rem;
          background: #f1f3f5;
          border-radius: 4px;
          font-size: 0.9rem;
          color: #e74c3c;
          word-break: break-all;
        }

        p {
          color: #666;
          font-size: 0.9rem;
        }
      }
    }

    .flow-arrow {
      color: #3498db;
      font-size: 1.5rem;
      font-weight: bold;
    }
  }

  .prevention-tips {
    margin-top: 2rem;
    padding: 1.5rem;
    background: #e8f4fc;
    border-radius: 8px;

    h3 {
      color: #2c3e50;
      margin-bottom: 1rem;
    }

    ul {
      list-style-type: none;
      padding: 0;

      li {
        margin: 0.5rem 0;
        padding-left: 1.5rem;
        position: relative;
        color: #444;

        &:before {
          content: "â€¢";
          color: #3498db;
          font-weight: bold;
          position: absolute;
          left: 0;
        }
      }
    }
  }
}
</style>
