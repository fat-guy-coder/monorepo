<template>
  <div class="compression-container">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24">
            <path
              d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z" />
          </svg>
        </div>
        <div class="logo-text">compression-webpack-plugin</div>
      </div>
      <h1>Webpack èµ„æºå‹ç¼©æ’ä»¶</h1>
      <p class="subtitle">ä¼˜åŒ–å‰ç«¯èµ„æºä½“ç§¯ï¼Œæå‡åº”ç”¨åŠ è½½é€Ÿåº¦</p>
    </div>

    <div class="content">
      <!-- æ’ä»¶æ¦‚è¿° -->
      <div class="section">
        <div class="section-header">
          <div class="section-icon">ğŸ“¦</div>
          <h2>æ’ä»¶æ¦‚è¿°</h2>
        </div>
        <div class="section-content">
          <div class="overview">
            <div class="overview-card">
              <div class="card-icon">âš¡</div>
              <h3>ä½œç”¨</h3>
              <p>ä¸ºé™æ€èµ„æºï¼ˆJS/CSS/HTMLç­‰ï¼‰æä¾› Gzip/Brotli å‹ç¼©æ”¯æŒï¼Œå‡å°‘ä¼ è¾“ä½“ç§¯ï¼Œæå‡åº”ç”¨åŠ è½½é€Ÿåº¦ã€‚</p>
            </div>
            <div class="overview-card">
              <div class="card-icon">ğŸ”§</div>
              <h3>å·¥ä½œåŸç†</h3>
              <p>åœ¨ Webpack æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¯¹è¾“å‡ºæ–‡ä»¶è¿›è¡Œå‹ç¼©å¤„ç†ï¼Œç”Ÿæˆ .gz æˆ– .br æ–‡ä»¶ã€‚</p>
            </div>
            <div class="overview-card">
              <div class="card-icon">ğŸ“‰</div>
              <h3>å‹ç¼©æ•ˆæœ</h3>
              <p>é€šå¸¸å¯å°†æ–‡ä»¶ä½“ç§¯å‡å°‘ 60%-80%ï¼Œæ˜¾è‘—æå‡é¡µé¢åŠ è½½æ€§èƒ½ã€‚</p>
            </div>
          </div>

          <div class="stats">
            <div class="stat-card">
              <div class="stat-value">3.2M+</div>
              <div class="stat-label">å‘¨ä¸‹è½½é‡</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">4.7K</div>
              <div class="stat-label">GitHub Stars</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">98%</div>
              <div class="stat-label">ç°ä»£æµè§ˆå™¨æ”¯æŒç‡</div>
            </div>
          </div>

          <div class="integration">
            <h3>é€‚ç”¨åœºæ™¯</h3>
            <ul>
              <li>ç”Ÿäº§ç¯å¢ƒæ„å»ºä¼˜åŒ–</li>
              <li>SPAï¼ˆå•é¡µåº”ç”¨ï¼‰æ€§èƒ½ä¼˜åŒ–</li>
              <li>é™æ€èµ„æºæ‰˜ç®¡ï¼ˆCDNï¼‰ä¼˜åŒ–</li>
              <li>æå‡ Lighthouse æ€§èƒ½è¯„åˆ†</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- æ ¸å¿ƒé…ç½® -->
      <div class="section">
        <div class="section-header">
          <div class="section-icon">âš™ï¸</div>
          <h2>æ ¸å¿ƒé…ç½®é¡¹</h2>
        </div>
        <div class="section-content">
          <div class="config-grid">
            <div class="config-card">
              <div class="config-header">
                <div class="config-name">test</div>
                <div class="config-type">RegExp | Array&lt;RegExp&gt;
                </div>
                <div class="config-default">é»˜è®¤ï¼šundefined</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>æŒ‡å®šåŒ¹é…è§„åˆ™ï¼Œå†³å®šå“ªäº›æ–‡ä»¶éœ€è¦è¢«å‹ç¼©</p>
                <div class="code-block">
                  <pre>test: /\.(js|css|html|svg)$/</pre>
                </div>
              </div>
            </div>

            <div class="config-card">
              <div class="config-header">
                <div class="config-name">filename</div>
                <div class="config-type">String | Function</div>
                <div class="config-default">é»˜è®¤ï¼š'[path][base].gz'</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>è‡ªå®šä¹‰å‹ç¼©æ–‡ä»¶çš„å‘½åè§„åˆ™</p>
                <div class="code-block">
                  <pre>filename: '[path][base].gz'</pre>
                </div>
              </div>
            </div>

            <div class="config-card">
              <div class="config-header">
                <div class="config-name">algorithm</div>
                <div class="config-type">String | Function</div>
                <div class="config-default">é»˜è®¤ï¼š'gzip'</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>æŒ‡å®šå‹ç¼©ç®—æ³•ï¼Œæ”¯æŒ 'gzip' æˆ– 'brotliCompress'</p>
                <div class="code-block">
                  <pre>algorithm: 'gzip'</pre>
                </div>
              </div>
            </div>

            <div class="config-card">
              <div class="config-header">
                <div class="config-name">threshold</div>
                <div class="config-type">Number</div>
                <div class="config-default">é»˜è®¤ï¼š0</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>è®¾ç½®æ–‡ä»¶å¤§å°é˜ˆå€¼ï¼ˆå­—èŠ‚ï¼‰ï¼Œåªæœ‰å¤§äºæ­¤å€¼çš„æ–‡ä»¶æ‰ä¼šè¢«å‹ç¼©</p>
                <div class="code-block">
                  <pre>threshold: 10240 // 10KB</pre>
                </div>
              </div>
            </div>

            <div class="config-card">
              <div class="config-header">
                <div class="config-name">minRatio</div>
                <div class="config-type">Number</div>
                <div class="config-default">é»˜è®¤ï¼š0.8</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>å‹ç¼©æ¯”é˜ˆå€¼ï¼Œåªæœ‰å‹ç¼©æ¯”ä¼˜äºæ­¤å€¼çš„æ–‡ä»¶æ‰ä¼šè¢«è¾“å‡º</p>
                <div class="code-block">
                  <pre>minRatio: 0.8 // å‹ç¼©ç‡å¿…é¡»å°äº80%</pre>
                </div>
              </div>
            </div>

            <div class="config-card">
              <div class="config-header">
                <div class="config-name">deleteOriginalAssets</div>
                <div class="config-type">Boolean</div>
                <div class="config-default">é»˜è®¤ï¼šfalse</div>
              </div>
              <div class="config-content">
                <h3>ä½œç”¨</h3>
                <p>æ˜¯å¦åˆ é™¤åŸå§‹æ–‡ä»¶ï¼ˆä»…ä¿ç•™å‹ç¼©æ–‡ä»¶ï¼‰</p>
                <div class="code-block">
                  <pre>deleteOriginalAssets: false</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ç®—æ³•å‚æ•° -->
      <div class="section">
        <div class="section-header">
          <div class="section-icon">ğŸ”¬</div>
          <h2>å‹ç¼©ç®—æ³•å‚æ•°</h2>
        </div>
        <div class="section-content">
          <div class="algorithm-tabs">
            <div class="tab-buttons">
              <button :class="{ active: activeTab === 'gzip' }" @click="activeTab = 'gzip'">Gzip å‚æ•°</button>
              <button :class="{ active: activeTab === 'brotli' }" @click="activeTab = 'brotli'">Brotli å‚æ•°</button>
            </div>

            <div class="tab-content" v-if="activeTab === 'gzip'">
              <div class="param-card">
                <h3>Gzip å‹ç¼©å‚æ•°</h3>
                <p>é€šè¿‡ <code>compressionOptions</code> ä¼ é€’ç»™ zlib.gzipSync</p>

                <div class="param-grid">
                  <div class="param-item">
                    <div class="param-name">level</div>
                    <div class="param-type">Number</div>
                    <div class="param-default">é»˜è®¤ï¼š9</div>
                    <div class="param-desc">å‹ç¼©çº§åˆ« (0-9)ï¼Œ9ä¸ºæœ€é«˜å‹ç¼©ç‡</div>
                  </div>

                  <div class="param-item">
                    <div class="param-name">memLevel</div>
                    <div class="param-type">Number</div>
                    <div class="param-default">é»˜è®¤ï¼š8</div>
                    <div class="param-desc">å†…å­˜ä½¿ç”¨çº§åˆ« (1-9)ï¼Œå½±å“å‹ç¼©é€Ÿåº¦</div>
                  </div>

                  <div class="param-item">
                    <div class="param-name">strategy</div>
                    <div class="param-type">Number</div>
                    <div class="param-default">é»˜è®¤ï¼š0</div>
                    <div class="param-desc">å‹ç¼©ç­–ç•¥ï¼ˆé»˜è®¤ç­–ç•¥ä¸ºZ_DEFAULT_STRATEGYï¼‰</div>
                  </div>
                </div>

                <div class="code-block">
                  <pre>new CompressionPlugin({
  algorithm: 'gzip',
  compressionOptions: {
    level: 9,
    memLevel: 8
  }
})</pre>
                </div>
              </div>
            </div>

            <div class="tab-content" v-if="activeTab === 'brotli'">
              <div class="param-card">
                <h3>Brotli å‹ç¼©å‚æ•°</h3>
                <p>é€šè¿‡ <code>compressionOptions</code> ä¼ é€’ç»™ zlib.brotliCompressSync</p>

                <div class="param-grid">
                  <div class="param-item">
                    <div class="param-name">params</div>
                    <div class="param-type">Object</div>
                    <div class="param-default">é»˜è®¤ï¼š{}</div>
                    <div class="param-desc">Brotli é«˜çº§å‚æ•°é…ç½®</div>
                  </div>

                  <div class="param-item">
                    <div class="param-name">quality</div>
                    <div class="param-type">Number (0-11)</div>
                    <div class="param-default">é»˜è®¤ï¼š11</div>
                    <div class="param-desc">å‹ç¼©è´¨é‡ï¼Œå€¼è¶Šå¤§å‹ç¼©ç‡è¶Šé«˜</div>
                  </div>

                  <div class="param-item">
                    <div class="param-name">size_hint</div>
                    <div class="param-type">Number</div>
                    <div class="param-default">é»˜è®¤ï¼š0</div>
                    <div class="param-desc">é¢„æœŸè¾“å…¥å¤§å°ï¼Œå¸®åŠ©ä¼˜åŒ–å‹ç¼©</div>
                  </div>
                </div>

                <div class="code-block">
                  <pre>new CompressionPlugin({
  filename: '[path][base].br',
  algorithm: 'brotliCompress',
  compressionOptions: {
    params: {
      [zlib.constants.BROTLI_PARAM_QUALITY]: 11
    }
  }
})</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ä½¿ç”¨ç¤ºä¾‹ -->
      <div class="section">
        <div class="section-header">
          <div class="section-icon">ğŸ’»</div>
          <h2>å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h2>
        </div>
        <div class="section-content">
          <div class="example-card">
            <h3>åŸºç¡€é…ç½®</h3>
            <div class="code-block">
              <pre>// webpack.config.js
const CompressionPlugin = require('compression-webpack-plugin');

module.exports = {
  // ...å…¶ä»–é…ç½®
  plugins: [
    new CompressionPlugin({
      filename: '[path][base].gz',
      algorithm: 'gzip',
      test: /\.(js|css|html|svg)$/,
      threshold: 10240, // å¤§äº10KBçš„æ–‡ä»¶æ‰å‹ç¼©
      minRatio: 0.8, // å‹ç¼©ç‡å°äº0.8æ‰è¾“å‡º
    })
  ]
};</pre>
            </div>
          </div>

          <div class="example-card">
            <h3>é«˜çº§é…ç½®ï¼ˆGzip + Brotliï¼‰</h3>
            <div class="code-block">
              <pre>const CompressionPlugin = require('compression-webpack-plugin');
const zlib = require('zlib');

module.exports = {
  plugins: [
    // Gzip å‹ç¼©
    new CompressionPlugin({
      filename: '[path][base].gz',
      algorithm: 'gzip',
      test: /\.(js|css|html|svg)$/,
      threshold: 10240,
      minRatio: 0.8,
    }),
    // Brotli å‹ç¼©
    new CompressionPlugin({
      filename: '[path][base].br',
      algorithm: 'brotliCompress',
      test: /\.(js|css|html|svg)$/,
      compressionOptions: {
        params: {
          [zlib.constants.BROTLI_PARAM_QUALITY]: 11
        }
      },
      threshold: 10240,
      minRatio: 0.8,
    })
  ]
};</pre>
            </div>
          </div>

          <div class="tips">
            <h3>æœ€ä½³å®è·µå»ºè®®</h3>
            <ul>
              <li>ä»…åœ¨ç”Ÿäº§ç¯å¢ƒå¯ç”¨å‹ç¼©</li>
              <li>ä¼˜å…ˆä½¿ç”¨ Brotli å‹ç¼©ï¼ˆç°ä»£æµè§ˆå™¨æ”¯æŒï¼‰</li>
              <li>å‹ç¼©çº§åˆ«è®¾ç½®è¦æƒè¡¡æ—¶é—´å’Œå‹ç¼©ç‡</li>
              <li>é…ç½®æœåŠ¡å™¨ä¼˜å…ˆæä¾› Brotliï¼Œå›é€€åˆ° Gzip</li>
              <li>ä½¿ç”¨ CDN è‡ªåŠ¨å¤„ç†å‹ç¼©æ–‡ä»¶æœåŠ¡</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>compression-webpack-plugin v9.0.0 | MIT License</p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

const activeTab = ref('gzip');
</script>

<style lang="less" scoped>
@primary-color: #42b883;
@secondary-color: #35495e;
@accent-color: #ff7e67;
@light-bg: #f8f9fa;
@card-bg: #ffffff;
@border-color: #e0e0e0;
@text-color: #2c3e50;
@light-text: #7f8c8d;
@code-bg: #f5f5f5;
@code-border: #e0e0e0;
@success-color: #42b883;
@warning-color: #ffb300;

.compression-container {
  font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
  background-color: @light-bg;
  color: @text-color;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem 2rem;
  line-height: 1.6;
}

.header {
  text-align: center;
  padding: 2rem 1rem;
  margin-bottom: 1.5rem;

  .logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1.5rem;

    .logo-icon {
      width: 56px;
      height: 56px;
      background: linear-gradient(135deg, @primary-color, darken(@primary-color, 10%));
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;

      svg {
        width: 32px;
        height: 32px;
        fill: white;
      }
    }

    .logo-text {
      font-size: 1.8rem;
      font-weight: 700;
      color: @secondary-color;
    }
  }

  h1 {
    font-size: 2.2rem;
    margin-bottom: 0.5rem;
    color: @secondary-color;
  }

  .subtitle {
    font-size: 1.2rem;
    color: @light-text;
  }
}

.section {
  background: @card-bg;
  border-radius: 16px;
  margin-bottom: 1.8rem;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.04);
  overflow: hidden;

  .section-header {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 1.2rem 1.5rem;
    background: rgba(@primary-color, 0.05);
    border-bottom: 1px solid @border-color;

    .section-icon {
      font-size: 1.5rem;
      color: @primary-color;
    }

    h2 {
      margin: 0;
      font-size: 1.5rem;
      color: @text-color;
    }
  }

  .section-content {
    padding: 1.5rem;
  }
}

// æ¦‚è¿°éƒ¨åˆ†
.overview {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;

  .overview-card {
    background: rgba(@primary-color, 0.03);
    border: 1px solid fade(@primary-color, 15%);
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;

    .card-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: @primary-color;
    }

    h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      color: @secondary-color;
    }

    p {
      margin: 0;
      color: @light-text;
      line-height: 1.6;
    }
  }
}

.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;

  .stat-card {
    background: @card-bg;
    border-radius: 12px;
    padding: 1.2rem;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: @primary-color;
      margin-bottom: 0.3rem;
    }

    .stat-label {
      font-size: 0.95rem;
      color: @light-text;
    }
  }
}

.integration {
  background: rgba(@accent-color, 0.05);
  border-radius: 12px;
  padding: 1.5rem;
  border-left: 4px solid @accent-color;

  h3 {
    margin-top: 0;
    margin-bottom: 1rem;
    color: @accent-color;
  }

  ul {
    padding-left: 1.5rem;
    margin: 0;

    li {
      margin-bottom: 0.8rem;
      line-height: 1.5;
    }
  }
}

// é…ç½®éƒ¨åˆ†
.config-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 1.5rem;

  .config-card {
    border: 1px solid @border-color;
    border-radius: 12px;
    overflow: hidden;
    background: @card-bg;
    transition: transform 0.3s ease;

    &:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    }

    .config-header {
      background: rgba(@primary-color, 0.08);
      padding: 1rem;
      border-bottom: 1px solid @border-color;

      .config-name {
        font-size: 1.2rem;
        font-weight: 700;
        color: @primary-color;
        margin-bottom: 0.3rem;
      }

      .config-type {
        font-size: 0.9rem;
        color: @light-text;
        margin-bottom: 0.3rem;
      }

      .config-default {
        font-size: 0.9rem;
        background: fade(@primary-color, 10%);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        display: inline-block;
      }
    }

    .config-content {
      padding: 1.2rem;

      h3 {
        margin-top: 0;
        margin-bottom: 0.8rem;
        font-size: 1.1rem;
      }

      p {
        margin-bottom: 1rem;
        color: @light-text;
      }
    }
  }
}

// ç®—æ³•å‚æ•°éƒ¨åˆ†
.algorithm-tabs {
  .tab-buttons {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;

    button {
      padding: 0.8rem 1.5rem;
      border: none;
      background: @card-bg;
      border: 1px solid @border-color;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;

      &:hover {
        background: rgba(@primary-color, 0.05);
      }

      &.active {
        background: @primary-color;
        color: white;
        border-color: @primary-color;
      }
    }
  }

  .param-card {
    background: rgba(@primary-color, 0.03);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid fade(@primary-color, 15%);

    h3 {
      margin-top: 0;
      margin-bottom: 1.2rem;
      color: @secondary-color;
      padding-bottom: 0.8rem;
      border-bottom: 1px solid @border-color;
    }

    p {
      color: @light-text;
      margin-bottom: 1.5rem;
    }
  }

  .param-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.2rem;
    margin-bottom: 1.5rem;

    .param-item {
      background: @card-bg;
      border-radius: 8px;
      padding: 1rem;
      border: 1px solid @border-color;

      .param-name {
        font-weight: 700;
        color: @primary-color;
        margin-bottom: 0.5rem;
      }

      .param-type {
        font-size: 0.9rem;
        color: @light-text;
        margin-bottom: 0.3rem;
      }

      .param-default {
        font-size: 0.9rem;
        background: fade(@primary-color, 8%);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: 0.5rem;
      }

      .param-desc {
        font-size: 0.95rem;
        color: @light-text;
      }
    }
  }
}

// å…¬å…±æ ·å¼
.tips {
  background: rgba(@accent-color, 0.05);
  border-radius: 12px;
  padding: 1.5rem;
  margin-top: 1.5rem;
  border-left: 4px solid @accent-color;

  h3 {
    margin-top: 0;
    margin-bottom: 1rem;
    color: @accent-color;
  }

  ul {
    padding-left: 1.5rem;

    li {
      margin-bottom: 0.8rem;
      line-height: 1.5;
    }
  }
}

.code-block {
  background: #282c34;
  border-radius: 8px;
  padding: 1.2rem;
  margin: 1.2rem 0;
  overflow-x: auto;

  pre {
    color: #abb2bf;
    font-family: 'Fira Code', 'Consolas', monospace;
    font-size: 0.95rem;
    line-height: 1.5;
    margin: 0;
  }
}

.example-card {
  margin-bottom: 2rem;

  h3 {
    margin-top: 0;
    margin-bottom: 1rem;
    color: @secondary-color;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid @border-color;
  }
}

.footer {
  text-align: center;
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid @border-color;
  color: @light-text;
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .header {
    padding: 1.5rem 0.5rem;

    .logo {
      .logo-text {
        font-size: 1.4rem;
      }
    }

    h1 {
      font-size: 1.8rem;
    }
  }

  .config-grid {
    grid-template-columns: 1fr;
  }

  .param-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .stats {
    grid-template-columns: 1fr;
  }

  .overview {
    grid-template-columns: 1fr;
  }

  .tab-buttons {
    flex-direction: column;
  }
}
</style>
