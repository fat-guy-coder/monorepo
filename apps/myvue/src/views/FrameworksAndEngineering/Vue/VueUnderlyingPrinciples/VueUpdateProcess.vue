<template>
  <div class="update-process-container">
    <div class="header">
      <h1>Vue æ›´æ–°æµç¨‹åŸºç¡€ä»‹ç»</h1>
      <p class="subtitle">ä»æ•°æ®å˜æ›´åˆ°è§†å›¾æ›´æ–°çš„å®Œæ•´è¿‡ç¨‹</p>
      <div class="version-badge">Vue 3.0+</div>
    </div>

    <div class="content-wrapper">
      <!-- æ¦‚è¿° -->
      <section class="card overview-card">
        <div class="section-header">
          <h2><i class="icon icon-overview"></i> Vue æ›´æ–°æµç¨‹æ¦‚è¿°</h2>
        </div>
        <div class="overview-content">
          <p>
            Vue çš„æ›´æ–°æµç¨‹æ˜¯ä¸€ä¸ªé«˜æ•ˆã€å¼‚æ­¥çš„ DOM æ›´æ–°æœºåˆ¶ï¼Œç¡®ä¿åœ¨æ•°æ®å˜åŒ–æ—¶ä»¥æœ€å°ä»£ä»·æ›´æ–°è§†å›¾ã€‚
            æ•´ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†ä¸º <strong>å“åº”å¼æ•°æ®å˜æ›´</strong>ã€<strong>ä¾èµ–è§¦å‘</strong>ã€
            <strong>è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“</strong> å’Œ <strong>DOM æ›´æ–°</strong> å››ä¸ªä¸»è¦é˜¶æ®µã€‚
          </p>
          <div class="process-flow">
            <div class="flow-item">
              <div class="flow-icon">1</div>
              <div class="flow-label">æ•°æ®å˜æ›´</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-item">
              <div class="flow-icon">2</div>
              <div class="flow-label">ä¾èµ–è§¦å‘</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-item">
              <div class="flow-icon">3</div>
              <div class="flow-label">è™šæ‹Ÿ DOM æ¸²æŸ“</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-item">
              <div class="flow-icon">4</div>
              <div class="flow-label">DOM æ›´æ–°</div>
            </div>
          </div>
        </div>
      </section>

      <!-- å®Œæ•´æµç¨‹ -->
      <section class="card">
        <div class="section-header">
          <h2><i class="icon icon-process"></i> å®Œæ•´æ›´æ–°æµç¨‹</h2>
        </div>
        <div class="process-steps">
          <div class="step" v-for="(step, index) in processSteps" :key="index">
            <div class="step-header">
              <div class="step-number">{{ index + 1 }}</div>
              <h3>{{ step.title }}</h3>
            </div>
            <div class="step-content">
              <p>{{ step.description }}</p>
              <div v-if="step.code" class="code-block-container">
                <pre class="code-block">{{ step.code }}</pre>
              </div>
              <div v-if="step.diagram" class="step-diagram">
                <div class="diagram-content" v-html="step.diagram"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- å¼‚æ­¥æ›´æ–°æœºåˆ¶ -->
      <section class="card">
        <div class="section-header">
          <h2><i class="icon icon-async"></i> å¼‚æ­¥æ›´æ–°æœºåˆ¶</h2>
        </div>
        <div class="async-content">
          <div class="async-explanation">
            <p>
              Vue ä½¿ç”¨<strong>å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—</strong>ä¼˜åŒ–æ€§èƒ½ï¼Œå°†å¤šæ¬¡æ•°æ®å˜æ›´åˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°ã€‚
              æ›´æ–°è¿‡ç¨‹ä½¿ç”¨ <code>nextTick</code> æ–¹æ³•ï¼Œå†…éƒ¨æ ¹æ®ç¯å¢ƒé€‰æ‹©æœ€ä¼˜çš„å¼‚æ­¥ç­–ç•¥ï¼š
            </p>
            <ul>
              <li><strong>Promise.then</strong> (ç°ä»£æµè§ˆå™¨)</li>
              <li><strong>MutationObserver</strong> (å¤‡ç”¨æ–¹æ¡ˆ)</li>
              <li><strong>setImmediate</strong> (IE10+)</li>
              <li><strong>setTimeout</strong> (é™çº§æ–¹æ¡ˆ)</li>
            </ul>
            <pre class="code-block">// æ›´æ–°é˜Ÿåˆ—ä¼ªä»£ç 
let queue = [];
let waiting = false;

function queueWatcher(watcher) {
  // å»é‡
  if (!queue.includes(watcher)) {
    queue.push(watcher);
  }

  if (!waiting) {
    waiting = true;
    nextTick(flushSchedulerQueue);
  }
}

function flushSchedulerQueue() {
  // æ’åºç¡®ä¿æ­£ç¡®æ›´æ–°é¡ºåº
  queue.sort((a, b) => a.id - b.id);

  // æ‰§è¡Œæ›´æ–°
  for (const watcher of queue) {
    watcher.run();
  }

  // é‡ç½®
  queue = [];
  waiting = false;
}</pre>
          </div>
          <div class="async-visual">
            <div class="visual-title">å¼‚æ­¥æ›´æ–°è¿‡ç¨‹</div>
            <div class="timeline">
              <div class="event">
                <div class="event-time">t0</div>
                <div class="event-dot"></div>
                <div class="event-label">æ•°æ®å˜æ›´1</div>
              </div>
              <div class="event">
                <div class="event-time">t1</div>
                <div class="event-dot"></div>
                <div class="event-label">æ•°æ®å˜æ›´2</div>
              </div>
              <div class="event">
                <div class="event-time">t2</div>
                <div class="event-dot"></div>
                <div class="event-label">æ•°æ®å˜æ›´3</div>
              </div>
              <div class="update-barrier">
                <div class="barrier-line"></div>
                <div class="barrier-label">nextTick</div>
              </div>
              <div class="event major">
                <div class="event-time">t3</div>
                <div class="event-dot"></div>
                <div class="event-label">åˆå¹¶æ›´æ–°</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- è™šæ‹ŸDOM Diffç®—æ³• -->
      <section class="card">
        <div class="section-header">
          <h2><i class="icon icon-diff"></i> è™šæ‹ŸDOM Diffç®—æ³•</h2>
        </div>
        <div class="diff-content">
          <div class="diff-explanation">
            <p>Vue ä½¿ç”¨é«˜æ•ˆçš„ Diff ç®—æ³•æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOMï¼Œæœ€å°åŒ– DOM æ“ä½œï¼š</p>
            <ul>
              <li><strong>åŒçº§æ¯”è¾ƒ</strong>ï¼šåªæ¯”è¾ƒåŒä¸€å±‚çº§çš„èŠ‚ç‚¹</li>
              <li><strong>Key ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ key æ ‡è¯†èŠ‚ç‚¹èº«ä»½</li>
              <li><strong>åŒç«¯æ¯”è¾ƒ</strong>ï¼šä»ä¸¤ç«¯å‘ä¸­é—´æ¯”è¾ƒ</li>
              <li><strong>å°±åœ°å¤ç”¨</strong>ï¼šå°½å¯èƒ½å¤ç”¨ç›¸åŒèŠ‚ç‚¹</li>
            </ul>
          </div>
          <div class="diff-example">
            <div class="vdom-comparison">
              <div class="vdom old">
                <div class="vdom-title">æ—§è™šæ‹ŸDOM</div>
                <div class="vdom-node root">
                  <div class="node-label">div (id:app)</div>
                  <div class="children">
                    <div class="vdom-node">
                      <div class="node-label">h1</div>
                      <div class="node-content">Hello Vue</div>
                    </div>
                    <div class="vdom-node">
                      <div class="node-label">ul</div>
                      <div class="children">
                        <div class="vdom-node" v-for="i in 3" :key="i">
                          <div class="node-label">li (key={{ i }})</div>
                          <div class="node-content">Item {{ i }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="vdom-arrow">â†’</div>

              <div class="vdom new">
                <div class="vdom-title">æ–°è™šæ‹ŸDOM</div>
                <div class="vdom-node root">
                  <div class="node-label">div (id:app)</div>
                  <div class="children">
                    <div class="vdom-node">
                      <div class="node-label">h1</div>
                      <div class="node-content">Hello Vue3</div>
                    </div>
                    <div class="vdom-node">
                      <div class="node-label">ul</div>
                      <div class="children">
                        <div class="vdom-node" v-for="i in 4" :key="i">
                          <div class="node-label">li (key={{ i }})</div>
                          <div class="node-content">Item {{ i }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="diff-result">
              <div class="result-title">Diff ç»“æœï¼š</div>
              <ul>
                <li>æ›´æ–° h1 æ–‡æœ¬å†…å®¹</li>
                <li>æ·»åŠ æ–°çš„ li å…ƒç´  (key=4)</li>
                <li>å¤ç”¨å…¶ä»– li å…ƒç´ </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- æ›´æ–°ä¼˜åŒ–ç­–ç•¥ -->
      <section class="card">
        <div class="section-header">
          <h2><i class="icon icon-optimization"></i> Vue æ›´æ–°ä¼˜åŒ–ç­–ç•¥</h2>
        </div>
        <div class="optimization-grid">
          <div class="strategy">
            <div class="strategy-icon">âš¡</div>
            <h3>å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—</h3>
            <p>åˆå¹¶å¤šä¸ªæ•°æ®å˜æ›´ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“</p>
          </div>
          <div class="strategy">
            <div class="strategy-icon">ğŸ”‘</div>
            <h3>Key ä¼˜åŒ–</h3>
            <p>ä½¿ç”¨ key å¸®åŠ©è¯†åˆ«èŠ‚ç‚¹ï¼Œæé«˜å¤ç”¨ç‡</p>
          </div>
          <div class="strategy">
            <div class="strategy-icon">ğŸ§©</div>
            <h3>ç»„ä»¶çº§æ›´æ–°</h3>
            <p>åªæ›´æ–°æ•°æ®å˜åŒ–çš„ç»„ä»¶</p>
          </div>
          <div class="strategy">
            <div class="strategy-icon">ğŸ§ </div>
            <h3>æ™ºèƒ½ Diff ç®—æ³•</h3>
            <p>æœ€å°åŒ– DOM æ“ä½œï¼Œæé«˜æ€§èƒ½</p>
          </div>
          <div class="strategy">
            <div class="strategy-icon">ğŸ“¦</div>
            <h3>é™æ€æå‡</h3>
            <p>ç¼–è¯‘æ—¶æ ‡è®°é™æ€èŠ‚ç‚¹ï¼Œè·³è¿‡æ›´æ–°</p>
          </div>
          <div class="strategy">
            <div class="strategy-icon">ğŸ”„</div>
            <h3>ç¼“å­˜äº‹ä»¶å¤„ç†</h3>
            <p>é¿å…ä¸å¿…è¦çš„äº‹ä»¶å¤„ç†å‡½æ•°é‡å»º</p>
          </div>
        </div>
      </section>

      <!-- æ›´æ–°é’©å­å‡½æ•° -->
      <section class="card">
        <div class="section-header">
          <h2><i class="icon icon-hooks"></i> æ›´æ–°ç”Ÿå‘½å‘¨æœŸé’©å­</h2>
        </div>
        <div class="hooks-timeline">
          <div class="timeline-item" v-for="(hook, index) in lifecycleHooks" :key="index">
            <div class="hook-name">{{ hook.name }}</div>
            <div class="hook-description">{{ hook.description }}</div>
            <div class="hook-timing">æ›´æ–°é˜¶æ®µ {{ index + 1 }}</div>
          </div>
        </div>
      </section>
    </div>

    <div class="footer">
      <p>Â© 2023 Vue.js æ ¸å¿ƒæœºåˆ¶ | æ›´æ–°æµç¨‹æ˜¯ Vue å“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒ</p>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, } from 'vue';

// æ›´æ–°æµç¨‹æ­¥éª¤
const processSteps = ref([
  {
    title: "å“åº”å¼æ•°æ®å˜æ›´",
    description: "å½“ç»„ä»¶ä¸­çš„å“åº”å¼æ•°æ®ï¼ˆå¦‚é€šè¿‡ ref æˆ– reactive åˆ›å»ºçš„æ•°æ®ï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§¦å‘ setter æ‹¦æˆªå™¨ã€‚",
    code: `const count = ref(0);

// æ•°æ®å˜æ›´è§¦å‘æ›´æ–°
count.value = 1;`,
    diagram: `<div class="diagram-box">
  <div class="data-change">count: 0 â†’ 1</div>
  <div class="arrow-down">â†“</div>
  <div class="reactive-proxy">Proxy setter æ‹¦æˆª</div>
</div>`
  },
  {
    title: "è§¦å‘ä¾èµ–æ›´æ–°",
    description: "æ•°æ®å˜æ›´è§¦å‘ä¾èµ–è¯¥æ•°æ®çš„ Watcher æ›´æ–°ã€‚æ¯ä¸ªç»„ä»¶å®ä¾‹å¯¹åº”ä¸€ä¸ªæ¸²æŸ“ Watcherï¼Œè´Ÿè´£ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚",
    code: `// ä¼ªä»£ç  - è§¦å‘ä¾èµ–æ›´æ–°
function trigger(target, key) {
  const depsMap = targetMap.get(target);
  if (!depsMap) return;

  const dep = depsMap.get(key);
  if (dep) {
    dep.forEach(watcher => {
      // å°† watcher åŠ å…¥æ›´æ–°é˜Ÿåˆ—
      queueWatcher(watcher);
    });
  }
}`,
    diagram: `<div class="dependency-diagram">
  <div class="dep-target">æ•°æ®å¯¹è±¡</div>
  <div class="arrow-down">â†“</div>
  <div class="dep-list">
    <div>Watcher (ç»„ä»¶1)</div>
    <div>Watcher (ç»„ä»¶2)</div>
    <div>Watcher (è®¡ç®—å±æ€§)</div>
  </div>
</div>`
  },
  {
    title: "è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“",
    description: "Watcher æ‰§è¡Œæ›´æ–°å‡½æ•°ï¼Œé‡æ–°è¿è¡Œç»„ä»¶çš„æ¸²æŸ“å‡½æ•°ç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOM æ ‘ã€‚",
    code: `// ä¼ªä»£ç  - æ¸²æŸ“å‡½æ•°æ‰§è¡Œ
updateComponent = () => {
  // æ‰§è¡Œæ¸²æŸ“å‡½æ•°ç”Ÿæˆ VNode
  const vnode = render.call(instance);

  // å¯¹æ¯”æ–°æ—§ VNode
  patch(prevVNode, vnode);
}`,
    diagram: `<div class="vdom-diagram">
  <div class="vdom-old">æ—§è™šæ‹ŸDOM</div>
  <div class="vdom-arrow">â†’</div>
  <div class="render-process">æ‰§è¡Œ render å‡½æ•°</div>
  <div class="vdom-arrow">â†’</div>
  <div class="vdom-new">æ–°è™šæ‹ŸDOM</div>
</div>`
  },
  {
    title: "Diff ç®—æ³•å¯¹æ¯”",
    description: "å°†æ–°ç”Ÿæˆçš„è™šæ‹Ÿ DOM ä¸æ—§çš„è™šæ‹Ÿ DOM è¿›è¡Œå¯¹æ¯”ï¼Œæ‰¾å‡ºå·®å¼‚ï¼ˆDiff ç®—æ³•ï¼‰ã€‚",
    code: `// ä¼ªä»£ç  - Diff ç®—æ³•ç®€åŒ–ç‰ˆ
function patch(oldVNode, newVNode) {
  // èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œç›´æ¥æ›¿æ¢
  if (oldVNode.tag !== newVNode.tag) {
    replaceNode(oldVNode, newVNode);
    return;
  }

  // ç›¸åŒèŠ‚ç‚¹ï¼Œæ›´æ–°å±æ€§
  updateProps(oldVNode, newVNode);

  // å¯¹æ¯”å­èŠ‚ç‚¹
  patchChildren(oldVNode, newVNode);
}`,
    diagram: `<div class="diff-diagram">
  <div class="diff-item same">ç›¸åŒèŠ‚ç‚¹</div>
  <div class="diff-item update">éœ€è¦æ›´æ–°</div>
  <div class="diff-item remove">ç§»é™¤èŠ‚ç‚¹</div>
  <div class="diff-item add">æ–°å¢èŠ‚ç‚¹</div>
</div>`
  },
  {
    title: "DOM æ›´æ–°",
    description: "æ ¹æ® Diff ç»“æœï¼Œæ‰§è¡Œå…·ä½“çš„ DOM æ“ä½œï¼ˆåˆ›å»ºã€æ›´æ–°ã€åˆ é™¤èŠ‚ç‚¹ï¼‰ï¼Œæ›´æ–°çœŸå® DOMã€‚",
    code: `// ä¼ªä»£ç  - DOM æ›´æ–°
function patchChildren(oldVNode, newVNode) {
  // æ›´æ–°å­èŠ‚ç‚¹
  for (let i = 0; i < newChildren.length; i++) {
    // å¯¹æ¯”æ–°æ—§å­èŠ‚ç‚¹
    patch(oldChildren[i], newChildren[i]);
  }

  // ç§»é™¤å¤šä½™èŠ‚ç‚¹
  for (let i = newChildren.length; i < oldChildren.length; i++) {
    removeNode(oldChildren[i].el);
  }
}`,
    diagram: `<div class="dom-diagram">
  <div class="dom-node">div</div>
  <div class="children">
    <div class="dom-node update">h1 (æ›´æ–°æ–‡æœ¬)</div>
    <div class="dom-node">ul</div>
    <div class="children">
      <div class="dom-node same">li (å¤ç”¨)</div>
      <div class="dom-node same">li (å¤ç”¨)</div>
      <div class="dom-node add">li (æ–°å¢)</div>
    </div>
  </div>
</div>`
  },
  {
    title: "å®Œæˆæ›´æ–°",
    description: "æ›´æ–°å®Œæˆåï¼Œè§¦å‘ updated ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæ­¤æ—¶ DOM å·²ç»æ›´æ–°å®Œæˆã€‚",
    code: `// ç»„ä»¶é€‰é¡¹
export default {
  updated() {
    // DOM å·²æ›´æ–°å®Œæˆ
    console.log('ç»„ä»¶å·²æ›´æ–°');
  }
}`,
    diagram: `<div class="completed-diagram">
  <div class="check-icon">âœ“</div>
  <div>DOM æ›´æ–°å®Œæˆ</div>
</div>`
  }
]);

// ç”Ÿå‘½å‘¨æœŸé’©å­
const lifecycleHooks = ref([
  {
    name: "beforeUpdate",
    description: "æ•°æ®å˜åŒ–åï¼Œè™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹å‰è°ƒç”¨"
  },
  {
    name: "render",
    description: "æ‰§è¡Œæ¸²æŸ“å‡½æ•°ç”Ÿæˆè™šæ‹Ÿ DOM"
  },
  {
    name: "updated",
    description: "è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸åè°ƒç”¨ï¼Œæ­¤æ—¶ DOM å·²æ›´æ–°"
  },
  {
    name: "nextTick",
    description: "DOM æ›´æ–°å®Œæˆåæ‰§è¡Œï¼Œç”¨äºè·å–æ›´æ–°åçš„ DOM"
  }
]);
</script>

<style lang="less" scoped>
@primary-color: #4361ee;
@secondary-color: #3a0ca3;
@accent-color: #4cc9f0;
@light-bg: #f8f9ff;
@card-bg: #ffffff;
@text-color: #2c3e50;
@border-color: #e9ecef;
@update-color: #4361ee;

.update-process-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: @text-color;
  background-color: @light-bg;
  line-height: 1.6;

  .header {
    text-align: center;
    margin-bottom: 30px;
    padding: 30px 0;
    position: relative;

    h1 {
      color: @secondary-color;
      font-size: 2.8rem;
      margin-bottom: 10px;
      background: linear-gradient(135deg, @update-color, @accent-color);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }

    .subtitle {
      font-size: 1.3rem;
      color: lighten(@text-color, 20%);
      max-width: 700px;
      margin: 0 auto 15px;
    }

    .version-badge {
      display: inline-block;
      background: linear-gradient(135deg, @update-color, lighten(@update-color, 15%));
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 500;
    }
  }

  .content-wrapper {
    display: grid;
    gap: 25px;
  }

  .card {
    background: @card-bg;
    border-radius: 12px;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;

    &:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
    }
  }

  .section-header {
    padding: 18px 25px;
    background: linear-gradient(135deg, @update-color, @accent-color);
    color: white;

    h2 {
      margin: 0;
      font-size: 1.4rem;
      display: flex;
      align-items: center;

      .icon {
        display: inline-block;
        width: 30px;
        height: 30px;
        margin-right: 12px;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        position: relative;

        &::after {
          content: "";
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
      }

      .icon-overview::after {
        width: 18px;
        height: 18px;
        border: 2px solid white;
        border-radius: 4px;
      }

      .icon-process::after {
        width: 18px;
        height: 18px;
        background:
          linear-gradient(to right, white 33%, transparent 33%, transparent 66%, white 66%),
          linear-gradient(to bottom, white 33%, transparent 33%, transparent 66%, white 66%);
      }

      .icon-async::after {
        width: 18px;
        height: 18px;
        background: white;
        clip-path: polygon(0 40%, 40% 40%, 40% 0, 60% 0, 60% 40%, 100% 40%, 100% 60%, 60% 60%, 60% 100%, 40% 100%, 40% 60%, 0 60%);
      }

      .icon-diff::after {
        width: 18px;
        height: 18px;
        background: white;
        clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%, 0 50%, 50% 50%, 50% 100%, 50% 0, 100% 50%, 0 50%);
      }

      .icon-optimization::after {
        width: 18px;
        height: 18px;
        background: white;
        clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
      }

      .icon-hooks::after {
        width: 18px;
        height: 18px;
        background: white;
        clip-path: polygon(0 0, 100% 0, 100% 20%, 50% 35%, 0 20%);
      }
    }
  }

  .overview-card {
    .overview-content {
      padding: 25px;

      p {
        font-size: 1.1rem;
        margin-bottom: 25px;
      }
    }

    .process-flow {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
      flex-wrap: wrap;

      @media (max-width: 768px) {
        flex-direction: column;
        gap: 15px;
      }

      .flow-item {
        flex: 1;
        min-width: 180px;
        text-align: center;
        padding: 15px;
        background: lighten(@update-color, 45%);
        border-radius: 8px;
        position: relative;

        .flow-icon {
          width: 36px;
          height: 36px;
          background: @update-color;
          color: white;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: bold;
          font-size: 1.2rem;
          margin: 0 auto 10px;
        }

        .flow-label {
          font-weight: 600;
          color: @secondary-color;
        }
      }

      .flow-arrow {
        font-size: 1.8rem;
        font-weight: bold;
        color: @update-color;
        padding: 0 10px;

        @media (max-width: 768px) {
          transform: rotate(90deg);
          padding: 10px 0;
        }
      }
    }
  }

  .process-steps {
    padding: 25px;

    .step {
      margin-bottom: 30px;
      padding-bottom: 30px;
      border-bottom: 1px dashed @border-color;

      &:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
      }

      .step-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;

        .step-number {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          background: linear-gradient(135deg, @update-color, @accent-color);
          color: white;
          border-radius: 50%;
          font-weight: bold;
          font-size: 1.2rem;
          margin-right: 15px;
          flex-shrink: 0;
        }

        h3 {
          margin: 0;
          color: @secondary-color;
        }
      }

      .step-content {
        p {
          margin: 0 0 15px 0;
          color: lighten(@text-color, 20%);
        }

        .step-diagram {
          margin: 15px 0;
          padding: 15px;
          background: lighten(@update-color, 50%);
          border-radius: 8px;
          font-family: 'Fira Code', monospace;
          font-size: 0.9rem;

          .diagram-box {
            text-align: center;

            .data-change {
              background: lighten(@update-color, 40%);
              padding: 10px;
              border-radius: 6px;
              font-weight: 500;
            }

            .arrow-down {
              font-size: 1.5rem;
              margin: 10px 0;
            }

            .reactive-proxy {
              background: lighten(@accent-color, 35%);
              padding: 10px;
              border-radius: 6px;
              font-weight: 500;
            }
          }
        }
      }
    }

    .code-block-container {
      margin: 15px 0;
    }

    .code-block {
      background: lighten(@update-color, 48%);
      border-radius: 8px;
      padding: 15px;
      overflow-x: auto;
      font-family: 'Fira Code', 'Courier New', monospace;
      font-size: 0.9rem;
      line-height: 1.5;
      color: darken(@update-color, 25%);
      border-left: 4px solid @update-color;
    }
  }

  .async-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    padding: 25px;

    @media (max-width: 768px) {
      grid-template-columns: 1fr;
    }

    .async-explanation {
      p {
        margin-top: 0;
      }

      ul {
        padding-left: 20px;
        margin: 15px 0;

        li {
          margin-bottom: 8px;
        }
      }
    }

    .async-visual {
      .visual-title {
        font-weight: 600;
        margin-bottom: 15px;
        color: @secondary-color;
      }

      .timeline {
        position: relative;
        padding: 20px 0 40px;

        &::before {
          content: "";
          position: absolute;
          left: 50px;
          top: 0;
          bottom: 0;
          width: 2px;
          background: @update-color;
        }

        .event {
          position: relative;
          margin-bottom: 30px;
          padding-left: 70px;

          .event-time {
            position: absolute;
            left: 20px;
            top: 0;
            font-family: 'Fira Code', monospace;
            font-size: 0.9rem;
          }

          .event-dot {
            position: absolute;
            left: 46px;
            top: 50%;
            transform: translateY(-50%);
            width: 10px;
            height: 10px;
            background: @update-color;
            border-radius: 50%;
            z-index: 2;
          }

          .event-label {
            background: lighten(@update-color, 45%);
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
          }

          &.major {
            .event-dot {
              width: 14px;
              height: 14px;
              background: @accent-color;
            }

            .event-label {
              background: lighten(@accent-color, 35%);
              font-weight: 500;
            }
          }
        }

        .update-barrier {
          position: relative;
          padding-left: 70px;
          margin: 40px 0;

          .barrier-line {
            height: 2px;
            background: @accent-color;
            position: relative;

            &::before {
              content: "";
              position: absolute;
              top: -5px;
              left: 0;
              width: 0;
              height: 0;
              border-style: solid;
              border-width: 0 8px 10px 8px;
              border-color: transparent transparent @accent-color transparent;
            }
          }

          .barrier-label {
            position: absolute;
            top: -30px;
            left: 70px;
            background: @accent-color;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
          }
        }
      }
    }
  }

  .diff-content {
    padding: 25px;

    .diff-explanation {
      margin-bottom: 20px;

      p {
        margin-top: 0;
      }

      ul {
        padding-left: 20px;

        li {
          margin-bottom: 10px;
        }
      }
    }

    .diff-example {
      .vdom-comparison {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
        gap: 20px;

        .vdom {
          flex: 1;
          border: 1px solid lighten(@update-color, 30%);
          border-radius: 8px;
          overflow: hidden;

          .vdom-title {
            background: lighten(@update-color, 40%);
            padding: 8px;
            text-align: center;
            font-weight: 500;
          }

          .vdom-node {
            padding: 10px;

            &.root {
              background: lighten(@update-color, 45%);
            }

            .node-label {
              font-weight: 500;
              font-size: 0.95rem;
              margin-bottom: 5px;
            }

            .node-content {
              font-size: 0.9rem;
              color: lighten(@text-color, 20%);
            }

            .children {
              padding-left: 20px;
              margin-top: 10px;
              border-left: 1px dashed lighten(@update-color, 30%);
            }
          }
        }

        .vdom-arrow {
          font-size: 2rem;
          padding-top: 30px;
          color: @update-color;
        }
      }

      .diff-result {
        background: lighten(@accent-color, 45%);
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid @accent-color;

        .result-title {
          font-weight: 500;
          margin-bottom: 10px;
          color: @secondary-color;
        }
      }
    }
  }

  .optimization-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    padding: 25px;

    .strategy {
      text-align: center;
      padding: 20px;
      background: lighten(@update-color, 48%);
      border-radius: 10px;
      transition: transform 0.2s;

      &:hover {
        transform: translateY(-5px);
      }

      .strategy-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
      }

      h3 {
        margin: 0 0 10px 0;
        color: @secondary-color;
      }

      p {
        margin: 0;
        color: lighten(@text-color, 20%);
        font-size: 0.95rem;
      }
    }
  }

  .hooks-timeline {
    padding: 25px;
    position: relative;

    &::before {
      content: "";
      position: absolute;
      left: 20px;
      top: 0;
      bottom: 0;
      width: 4px;
      background: linear-gradient(to bottom, @update-color, @accent-color);
      border-radius: 2px;
    }

    .timeline-item {
      position: relative;
      padding: 20px 20px 20px 60px;
      margin-bottom: 20px;
      background: lighten(@update-color, 50%);
      border-radius: 8px;

      &:last-child {
        margin-bottom: 0;
      }

      &::before {
        content: "";
        position: absolute;
        left: 16px;
        top: 24px;
        width: 12px;
        height: 12px;
        background: @update-color;
        border-radius: 50%;
        z-index: 2;
      }

      .hook-name {
        font-weight: 600;
        font-size: 1.1rem;
        color: @secondary-color;
        margin-bottom: 5px;
      }

      .hook-description {
        color: lighten(@text-color, 20%);
        margin-bottom: 8px;
      }

      .hook-timing {
        display: inline-block;
        background: lighten(@accent-color, 35%);
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 0.85rem;
      }
    }
  }

  .footer {
    text-align: center;
    margin-top: 40px;
    padding: 25px 0;
    color: lighten(@text-color, 30%);
    font-size: 0.9rem;
    border-top: 1px solid @border-color;
  }
}
</style>
