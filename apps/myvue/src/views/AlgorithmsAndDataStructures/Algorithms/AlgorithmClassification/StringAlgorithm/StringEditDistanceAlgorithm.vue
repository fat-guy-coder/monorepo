<template>
  <div class="edit-distance-container">
    <h1 class="main-title">ç¼–è¾‘è·ç¦»ç®—æ³•</h1>
    <div class="subtitle">Levenshteinè·ç¦»ï¼šé‡åŒ–å­—ç¬¦ä¸²ç›¸ä¼¼åº¦çš„ç»å…¸æ–¹æ³•</div>

    <div class="content-wrapper">
      <!-- å·¦ä¾§å†…å®¹åŒº -->
      <div class="content-left">
        <section class="card">
          <h2>ç®—æ³•ä»‹ç»</h2>
          <p>ç¼–è¾‘è·ç¦»ï¼ˆEdit Distanceï¼‰ï¼Œåˆç§°Levenshteinè·ç¦»ï¼Œæ˜¯è¡¡é‡ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ä¼¼åº¦çš„æŒ‡æ ‡ã€‚</p>
          <p>å®ƒå®šä¹‰ä¸ºå°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦ä¸²æ‰€éœ€çš„æœ€å°‘ç¼–è¾‘æ“ä½œæ¬¡æ•°ï¼Œå…è®¸çš„ç¼–è¾‘æ“ä½œåŒ…æ‹¬ï¼š</p>
          <div class="operations">
            <div class="operation">
              <div class="operation-icon insert">+</div>
              <div class="operation-info">
                <h3>æ’å…¥å­—ç¬¦</h3>
                <p>åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªå­—ç¬¦</p>
              </div>
            </div>
            <div class="operation">
              <div class="operation-icon delete">-</div>
              <div class="operation-info">
                <h3>åˆ é™¤å­—ç¬¦</h3>
                <p>ä»å­—ç¬¦ä¸²ä¸­åˆ é™¤ä¸€ä¸ªå­—ç¬¦</p>
              </div>
            </div>
            <div class="operation">
              <div class="operation-icon replace">â†”</div>
              <div class="operation-info">
                <h3>æ›¿æ¢å­—ç¬¦</h3>
                <p>å°†ä¸€ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—ç¬¦</p>
              </div>
            </div>
          </div>
          <div class="complexity">
            <div class="complexity-item">
              <span class="complexity-label">æ—¶é—´å¤æ‚åº¦</span>
              <span class="complexity-value">O(mÃ—n)</span>
            </div>
            <div class="complexity-item">
              <span class="complexity-label">ç©ºé—´å¤æ‚åº¦</span>
              <span class="complexity-value">O(mÃ—n)</span>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>æ ¸å¿ƒæ€æƒ³</h2>
          <ol class="idea-list">
            <li>
              <strong>åŠ¨æ€è§„åˆ’</strong>
              <p>å°†é—®é¢˜åˆ†è§£ä¸ºæ›´å°çš„å­é—®é¢˜å¹¶å­˜å‚¨ä¸­é—´ç»“æœ</p>
            </li>
            <li>
              <strong>äºŒç»´çŸ©é˜µ</strong>
              <p>ä½¿ç”¨äºŒç»´çŸ©é˜µå­˜å‚¨å­é—®é¢˜çš„ç¼–è¾‘è·ç¦»</p>
            </li>
            <li>
              <strong>çŠ¶æ€è½¬ç§»</strong>
              <p>æ ¹æ®å­—ç¬¦æ˜¯å¦ç›¸ç­‰å†³å®šæ“ä½œæ–¹å¼</p>
            </li>
          </ol>
          <div class="formula">
            <p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š</p>
            <div class="formula-box">
              <p>dp[i][j] =
                <span v-if="showFormula">
                  min(
                  <span class="op-delete">dp[i-1][j] + 1</span>,
                  <span class="op-insert">dp[i][j-1] + 1</span>,
                  <span class="op-replace">dp[i-1][j-1] + cost</span>
                  )
                </span>
                <span v-else>ç‚¹å‡»æŸ¥çœ‹</span>
              </p>
              <button class="toggle-formula" @click="showFormula = !showFormula">
                {{ showFormula ? 'éšè—å…¬å¼' : 'æ˜¾ç¤ºå…¬å¼' }}
              </button>
            </div>
            <div class="formula-desc" v-if="showFormula">
              <p>å…¶ä¸­ cost =
                <span class="formula-highlight">str1[i-1] == str2[j-1] ? 0 : 1</span>
              </p>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>ç®—æ³•æ­¥éª¤</h2>
          <div class="steps">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h3>åˆå§‹åŒ–çŸ©é˜µ</h3>
                <p>åˆ›å»ºå¤§å°ä¸º (m+1) Ã— (n+1) çš„äºŒç»´æ•°ç»„</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h3>è®¾ç½®è¾¹ç•Œæ¡ä»¶</h3>
                <p>ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—åˆå§‹åŒ–ä¸º0åˆ°n/m</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h3>å¡«å……çŸ©é˜µ</h3>
                <p>éå†çŸ©é˜µæ¯ä¸ªä½ç½®ï¼Œè®¡ç®—æœ€å°ç¼–è¾‘è·ç¦»</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h3>è®¡ç®—æ“ä½œæˆæœ¬</h3>
                <p>æ ¹æ®å­—ç¬¦æ˜¯å¦ç›¸ç­‰ç¡®å®šæ›¿æ¢æ“ä½œæˆæœ¬</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">5</div>
              <div class="step-content">
                <h3>å›æº¯è·¯å¾„</h3>
                <p>ä»å³ä¸‹è§’å›æº¯åˆ°å·¦ä¸Šè§’ï¼Œç¡®å®šæ“ä½œåºåˆ—</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">6</div>
              <div class="step-content">
                <h3>è¿”å›ç»“æœ</h3>
                <p>çŸ©é˜µå³ä¸‹è§’çš„å€¼å³ä¸ºç¼–è¾‘è·ç¦»</p>
              </div>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>ç®—æ³•å®ç°</h2>
          <pre class="code-block">function minEditDistance(str1: string, str2: string): number {
  const m = str1.length;
  const n = str2.length;

  // åˆ›å»ºDPçŸ©é˜µ
  const dp: number[][] = Array.from({ length: m + 1 }, () =>
    new Array(n + 1).fill(0)
  );

  // åˆå§‹åŒ–è¾¹ç•Œæ¡ä»¶
  for (let i = 0; i <= m; i++) dp[i][0] = i;
  for (let j = 0; j <= n; j++) dp[0][j] = j;

  // å¡«å……DPçŸ©é˜µ
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      // è®¡ç®—æ“ä½œæˆæœ¬
      const cost = str1[i - 1] === str2[j - 1] ? 0 : 1;

      dp[i][j] = Math.min(
        dp[i - 1][j] + 1,     // åˆ é™¤æ“ä½œ
        dp[i][j - 1] + 1,     // æ’å…¥æ“ä½œ
        dp[i - 1][j - 1] + cost // æ›¿æ¢æ“ä½œ
      );
    }
  }

  return dp[m][n]; // è¿”å›ç¼–è¾‘è·ç¦»
}</pre>
        </section>
      </div>

      <!-- å³ä¾§æ¼”ç¤ºåŒº -->
      <div class="content-right">
        <div class="demo-card">
          <h2>åŠ¨æ€æ¼”ç¤º</h2>
          <div class="demo-container">
            <div class="demo-controls">
              <div class="input-group">
                <label>å­—ç¬¦ä¸²1ï¼š</label>
                <input v-model="str1" type="text" maxlength="12" />
              </div>
              <div class="input-group">
                <label>å­—ç¬¦ä¸²2ï¼š</label>
                <input v-model="str2" type="text" maxlength="12" />
              </div>
              <div class="control-buttons">
                <button @click="startAnimation" :disabled="isAnimating">â–¶ï¸ å¼€å§‹</button>
                <button @click="pauseAnimation" :disabled="!isAnimating">â¸ï¸ æš‚åœ</button>
                <button @click="resetAnimation">ğŸ”„ é‡ç½®</button>
                <div class="speed-control">
                  <label>é€Ÿåº¦ï¼š</label>
                  <input type="range" min="1" max="10" v-model="speed" />
                </div>
              </div>
            </div>
            <div class="matrix-container">
              <canvas ref="matrixCanvas" width="600" height="380"></canvas>
            </div>
            <div class="operations-display">
              <h3>æ“ä½œåºåˆ—</h3>
              <div class="operations-sequence">
                <div v-for="(op, index) in operations" :key="index" class="operation-item">
                  <div class="op-index">{{ index + 1 }}.</div>
                  <div :class="['op-type', opClass(op.type)]">{{ opTypeText(op.type) }}</div>
                  <div class="op-details">{{ opDetails(op) }}</div>
                </div>
                <div v-if="operations.length === 0" class="empty-ops">
                  æ“ä½œåºåˆ—å°†åœ¨è¿™é‡Œæ˜¾ç¤º
                </div>
              </div>
            </div>
          </div>
          <div class="status">
            <div>ç¼–è¾‘è·ç¦»: <span class="distance-value">{{ editDistance }}</span></div>
            <div>çŠ¶æ€: <span :class="statusClass">{{ statusText }}</span></div>
          </div>
        </div>

        <div class="legend">
          <h3>å›¾ä¾‹è¯´æ˜</h3>
          <div class="legend-items">
            <div class="legend-item">
              <div class="color-box init"></div>
              <span>åˆå§‹å€¼</span>
            </div>
            <div class="legend-item">
              <div class="color-box insert"></div>
              <span>æ’å…¥æ“ä½œ</span>
            </div>
            <div class="legend-item">
              <div class="color-box delete"></div>
              <span>åˆ é™¤æ“ä½œ</span>
            </div>
            <div class="legend-item">
              <div class="color-box replace"></div>
              <span>æ›¿æ¢æ“ä½œ</span>
            </div>
            <div class="legend-item">
              <div class="color-box match"></div>
              <span>å­—ç¬¦åŒ¹é…</span>
            </div>
            <div class="legend-item">
              <div class="color-box current"></div>
              <span>å½“å‰å•å…ƒæ ¼</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="applications">
      <h2>åº”ç”¨åœºæ™¯</h2>
      <div class="app-grid">
        <div class="app-card">
          <div class="app-icon">ğŸ”</div>
          <h3>æ‹¼å†™æ£€æŸ¥</h3>
          <p>æŸ¥æ‰¾æœ€æ¥è¿‘çš„æ­£ç¡®æ‹¼å†™</p>
        </div>
        <div class="app-card">
          <div class="app-icon">ğŸ§¬</div>
          <h3>DNAåºåˆ—æ¯”å¯¹</h3>
          <p>åˆ†æç”Ÿç‰©åºåˆ—ç›¸ä¼¼æ€§</p>
        </div>
        <div class="app-card">
          <div class="app-icon">ğŸ¤–</div>
          <h3>è‡ªç„¶è¯­è¨€å¤„ç†</h3>
          <p>æ–‡æœ¬ç›¸ä¼¼åº¦è®¡ç®—</p>
        </div>
        <div class="app-card">
          <div class="app-icon">ğŸ“</div>
          <h3>ç‰ˆæœ¬æ§åˆ¶</h3>
          <p>æ–‡æ¡£å·®å¼‚åˆ†æ</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch, computed } from 'vue'

// ç»„ä»¶çŠ¶æ€
const str1 = ref('kitten')
const str2 = ref('sitting')
const isAnimating = ref(false)
const speed = ref(5)
const statusText = ref('ç­‰å¾…å¼€å§‹')
const editDistance = ref(0)
const showFormula = ref(false)
const statusClass = ref('status-waiting')
const operations = ref<any[]>([])

// Canvaså¼•ç”¨
const matrixCanvas = ref<HTMLCanvasElement | null>(null)

// åŠ¨ç”»æ§åˆ¶å˜é‡
let animationFrame: number | null = null
let dpMatrix: number[][] = []
let animationQueue: {i: number, j: number}[] = []
let currentStep = 0
let animationStartTime = 0
let isBacktracking = false

// æ“ä½œç±»å‹å¸¸é‡
const OP_MATCH = 0
const OP_REPLACE = 1
const OP_INSERT = 2
const OP_DELETE = 3

// åˆå§‹åŒ–DPçŸ©é˜µ
const initMatrix = () => {
  const m = str1.value.length
  const n = str2.value.length

  dpMatrix = Array.from({ length: m + 1 }, () => new Array(n + 1).fill(0))

  // åˆå§‹åŒ–è¾¹ç•Œ
  for (let i = 0; i <= m; i++) {
    dpMatrix[i][0] = i
    animationQueue.push({i, j: 0})
  }

  for (let j = 0; j <= n; j++) {
    dpMatrix[0][j] = j
    animationQueue.push({i: 0, j})
  }

  // æ·»åŠ å†…éƒ¨å•å…ƒæ ¼
  for (let i = 1; i <= m; i++) {
    for (let j = 1; j <= n; j++) {
      animationQueue.push({i, j})
    }
  }
}

// å›æº¯æ“ä½œè·¯å¾„
const backtrackOperations = () => {
  const ops: any[] = []
  let i = str1.value.length
  let j = str2.value.length

  while (i > 0 || j > 0) {
    const current = dpMatrix[i][j]
    const cost = (i > 0 && j > 0 && str1.value[i-1] !== str2.value[j-1]) ? 1 : 0

    // æ£€æŸ¥æ˜¯å¦åŒ¹é…æˆ–æ›¿æ¢
    if (i > 0 && j > 0 && dpMatrix[i][j] === dpMatrix[i-1][j-1] + cost) {
      if (cost === 0) {
        ops.unshift({ type: OP_MATCH, char1: str1.value[i-1], char2: str2.value[j-1], i, j })
      } else {
        ops.unshift({ type: OP_REPLACE, char1: str1.value[i-1], char2: str2.value[j-1], i, j })
      }
      i--
      j--
    }
    // æ£€æŸ¥åˆ é™¤æ“ä½œ
    else if (i > 0 && dpMatrix[i][j] === dpMatrix[i-1][j] + 1) {
      ops.unshift({ type: OP_DELETE, char1: str1.value[i-1], i, j })
      i--
    }
    // æ£€æŸ¥æ’å…¥æ“ä½œ
    else if (j > 0 && dpMatrix[i][j] === dpMatrix[i][j-1] + 1) {
      ops.unshift({ type: OP_INSERT, char2: str2.value[j-1], i, j })
      j--
    }
  }

  operations.value = ops
}

// é‡ç½®åŠ¨ç”»
const resetAnimation = () => {
  if (animationFrame) {
    cancelAnimationFrame(animationFrame)
    animationFrame = null
  }

  isAnimating.value = false
  currentStep = 0
  animationQueue = []
  dpMatrix = []
  operations.value = []
  editDistance.value = 0
  statusText.value = 'ç­‰å¾…å¼€å§‹'
  statusClass.value = 'status-waiting'
  isBacktracking = false

  initMatrix()
  drawMatrix()
}

// å¼€å§‹åŠ¨ç”»
const startAnimation = () => {
  if (isAnimating.value) return

  resetAnimation()
  isAnimating.value = true
  statusText.value = 'æ„å»ºçŸ©é˜µ...'
  statusClass.value = 'status-running'
  animationStartTime = performance.now()
  animateStep()
}

// æš‚åœåŠ¨ç”»
const pauseAnimation = () => {
  if (!isAnimating.value) return

  if (animationFrame) {
    cancelAnimationFrame(animationFrame)
    animationFrame = null
  }

  isAnimating.value = false
  statusText.value = 'å·²æš‚åœ'
  statusClass.value = 'status-paused'
}

// åŠ¨ç”»æ­¥éª¤
const animateStep = () => {
  if (!isAnimating.value) return

  const now = performance.now()
  const elapsed = now - animationStartTime
  const interval = 1100 - (speed.value * 100) // é€Ÿåº¦æ§åˆ¶

  if (elapsed < interval) {
    animationFrame = requestAnimationFrame(animateStep)
    return
  }

  animationStartTime = now

  if (currentStep < animationQueue.length) {
    const {i, j} = animationQueue[currentStep]

    if (i === 0 || j === 0) {
      // è¾¹ç•Œå·²ç»åˆå§‹åŒ–
    } else {
      const cost = str1.value[i-1] === str2.value[j-1] ? 0 : 1
      dpMatrix[i][j] = Math.min(
        dpMatrix[i-1][j] + 1,    // åˆ é™¤
        dpMatrix[i][j-1] + 1,    // æ’å…¥
        dpMatrix[i-1][j-1] + cost // æ›¿æ¢
      )
    }

    currentStep++
    drawMatrix(i, j)

    // å®ŒæˆçŸ©é˜µæ„å»º
    if (currentStep === animationQueue.length) {
      editDistance.value = dpMatrix[str1.value.length][str2.value.length]
      isBacktracking = true
      statusText.value = 'å›æº¯æ“ä½œè·¯å¾„...'
      backtrackOperations()
      statusText.value = 'æ¼”ç¤ºå®Œæˆ'
      statusClass.value = 'status-success'
      isAnimating.value = false
    }
  }

  if (isAnimating.value) {
    animationFrame = requestAnimationFrame(animateStep)
  }
}

// ç»˜åˆ¶DPçŸ©é˜µ
const drawMatrix = (highlightI = -1, highlightJ = -1) => {
  if (!matrixCanvas.value) return

  const ctx = matrixCanvas.value.getContext('2d')
  if (!ctx) return

  const m = str1.value.length
  const n = str2.value.length
  const cellSize = 40
  const padding = 60
  const headerSize = 30

  // æ¸…é™¤ç”»å¸ƒ
  ctx.clearRect(0, 0, matrixCanvas.value.width, matrixCanvas.value.height)

  // è®¾ç½®æ ·å¼
  ctx.font = '16px Arial'
  ctx.textAlign = 'center'
  ctx.textBaseline = 'middle'

  // ç»˜åˆ¶å­—ç¬¦ä¸²1ï¼ˆè¡Œï¼‰
  for (let i = 0; i <= m; i++) {
    const y = padding + i * cellSize + cellSize / 2

    if (i > 0) {
      ctx.fillStyle = '#333'
      ctx.fillText(str1.value[i-1], headerSize / 2, y)
    }

    // è¡Œå·
    ctx.fillStyle = '#666'
    ctx.fillText(i.toString(), headerSize / 2, padding - headerSize / 2)
  }

  // ç»˜åˆ¶å­—ç¬¦ä¸²2ï¼ˆåˆ—ï¼‰
  for (let j = 0; j <= n; j++) {
    const x = padding + j * cellSize + cellSize / 2

    if (j > 0) {
      ctx.fillStyle = '#333'
      ctx.fillText(str2.value[j-1], x, padding - headerSize / 2)
    }

    // åˆ—å·
    ctx.fillStyle = '#666'
    ctx.fillText(j.toString(), padding - headerSize / 2, padding - headerSize / 2)
  }

  // ç»˜åˆ¶çŸ©é˜µå•å…ƒæ ¼
  for (let i = 0; i <= m; i++) {
    for (let j = 0; j <= n; j++) {
      const x = padding + j * cellSize
      const y = padding + i * cellSize

      // ç¡®å®šå•å…ƒæ ¼èƒŒæ™¯è‰²
      if (i === 0 && j === 0) {
        ctx.fillStyle = '#e0f7fa' // åˆå§‹å•å…ƒæ ¼
      } else if (i === 0 || j === 0) {
        ctx.fillStyle = '#f5f5f5' // è¾¹ç•Œå•å…ƒæ ¼
      } else if (i === highlightI && j === highlightJ) {
        ctx.fillStyle = '#fff9c4' // å½“å‰å•å…ƒæ ¼
      } else if (dpMatrix[i][j] !== undefined) {
        // æ ¹æ®æ“ä½œç±»å‹ç€è‰²
        const cost = (str1.value[i-1] === str2.value[j-1]) ? 0 : 1
        const fromTop = dpMatrix[i][j] === dpMatrix[i-1][j] + 1
        const fromLeft = dpMatrix[i][j] === dpMatrix[i][j-1] + 1
        const fromDiag = dpMatrix[i][j] === dpMatrix[i-1][j-1] + cost

        if (fromDiag && cost === 0) {
          ctx.fillStyle = '#c8e6c9' // åŒ¹é…
        } else if (fromDiag) {
          ctx.fillStyle = '#ffccbc' // æ›¿æ¢
        } else if (fromLeft) {
          ctx.fillStyle = '#bbdefb' // æ’å…¥
        } else if (fromTop) {
          ctx.fillStyle = '#ffcdd2' // åˆ é™¤
        } else {
          ctx.fillStyle = '#f5f5f5' // é»˜è®¤
        }
      } else {
        ctx.fillStyle = '#f5f5f5' // æœªè®¡ç®—
      }

      // ç»˜åˆ¶å•å…ƒæ ¼èƒŒæ™¯
      ctx.fillRect(x, y, cellSize, cellSize)

      // ç»˜åˆ¶å•å…ƒæ ¼è¾¹æ¡†
      ctx.strokeStyle = '#ddd'
      ctx.lineWidth = 1
      ctx.strokeRect(x, y, cellSize, cellSize)

      // ç»˜åˆ¶å•å…ƒæ ¼å€¼
      if (dpMatrix[i]?.[j] !== undefined) {
        ctx.fillStyle = '#333'
        ctx.fillText(dpMatrix[i][j].toString(), x + cellSize / 2, y + cellSize / 2)
      }
    }
  }

  // ç»˜åˆ¶ç½‘æ ¼æ ‡é¢˜
  ctx.fillStyle = '#333'
  ctx.font = 'bold 16px Arial'
  ctx.textAlign = 'center'
  ctx.fillText('å­—ç¬¦ä¸²1', headerSize / 2, padding - headerSize * 1.5)
  ctx.fillText('å­—ç¬¦ä¸²2', padding - headerSize / 2, padding - headerSize * 1.5)
}

// æ“ä½œç±»å‹æ–‡æœ¬
const opTypeText = (type: number) => {
  switch (type) {
    case OP_MATCH: return 'åŒ¹é…'
    case OP_REPLACE: return 'æ›¿æ¢'
    case OP_INSERT: return 'æ’å…¥'
    case OP_DELETE: return 'åˆ é™¤'
    default: return 'æ“ä½œ'
  }
}

// æ“ä½œç±»å
const opClass = (type: number) => {
  switch (type) {
    case OP_MATCH: return 'op-match'
    case OP_REPLACE: return 'op-replace'
    case OP_INSERT: return 'op-insert'
    case OP_DELETE: return 'op-delete'
    default: return ''
  }
}

// æ“ä½œè¯¦æƒ…
const opDetails = (op: any) => {
  switch (op.type) {
    case OP_MATCH:
      return `å­—ç¬¦ '${op.char1}' åŒ¹é…`
    case OP_REPLACE:
      return `å°† '${op.char1}' æ›¿æ¢ä¸º '${op.char2}'`
    case OP_INSERT:
      return `æ’å…¥å­—ç¬¦ '${op.char2}'`
    case OP_DELETE:
      return `åˆ é™¤å­—ç¬¦ '${op.char1}'`
    default:
      return ''
  }
}

// åˆå§‹åŒ–
onMounted(() => {
  initMatrix()
  drawMatrix()
})

// ç›‘å¬è¾“å…¥å˜åŒ–
watch([str1, str2], resetAnimation)
</script>

<style scoped lang="less">
@primary-color: #3f51b5;
@secondary-color: #5c6bc0;
@success-color: #4caf50;
@warning-color: #ff9800;
@error-color: #f44336;
@insert-color: #2196f3;
@delete-color: #f44336;
@replace-color: #ff9800;
@match-color: #4caf50;
@background-light: #f8f9fa;
@border-color: #e0e0e0;

.edit-distance-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #333;
  background-color: #fff;
  min-height: 100vh;
}

.main-title {
  text-align: center;
  color: @primary-color;
  margin-bottom: 5px;
  font-size: 2.5rem;
}

.subtitle {
  text-align: center;
  color: @secondary-color;
  margin-bottom: 40px;
  font-size: 1.1rem;
}

.content-wrapper {
  display: flex;
  gap: 30px;
  margin-bottom: 30px;
}

.content-left {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 25px;
}

.content-right {
  flex: 1;
}

.card {
  background: @background-light;
  border-radius: 12px;
  padding: 20px 25px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;

  &:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
  }

  h2 {
    color: @primary-color;
    margin-top: 0;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 2px solid #e0e0e0;
    font-size: 1.6rem;
  }
}

.operations {
  display: flex;
  gap: 15px;
  margin: 20px 0;

  .operation {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 15px;
    border-radius: 8px;
    background: white;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }

  .operation-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    font-weight: bold;
    margin-bottom: 12px;

    &.insert {
      background: fade(@insert-color, 20%);
      color: darken(@insert-color, 10%);
    }

    &.delete {
      background: fade(@delete-color, 20%);
      color: darken(@delete-color, 10%);
    }

    &.replace {
      background: fade(@replace-color, 20%);
      color: darken(@replace-color, 10%);
    }
  }

  .operation-info {
    h3 {
      margin: 0 0 5px;
      font-size: 1.1rem;
      color: #333;
    }

    p {
      margin: 0;
      color: #666;
      font-size: 0.9rem;
    }
  }
}

.complexity {
  display: flex;
  gap: 20px;
  margin-top: 15px;

  .complexity-item {
    background: white;
    padding: 12px 20px;
    border-radius: 8px;
    text-align: center;
    flex: 1;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }

  .complexity-label {
    display: block;
    font-size: 0.9rem;
    color: @secondary-color;
  }

  .complexity-value {
    display: block;
    font-size: 1.4rem;
    font-weight: bold;
    color: @primary-color;
  }
}

.idea-list {
  list-style: none;
  padding: 0;

  li {
    margin-bottom: 25px;
    padding-left: 30px;
    position: relative;

    &::before {
      content: '';
      position: absolute;
      left: 0;
      top: 5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: @primary-color;
    }

    strong {
      color: @primary-color;
      font-size: 1.1rem;
    }

    p {
      margin: 8px 0 0;
      color: #555;
    }
  }
}

.formula {
  margin-top: 25px;
  background: white;
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);

  .formula-box {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #2d2d2d;
    color: #f8f8f2;
    padding: 15px 20px;
    border-radius: 6px;
    font-family: 'Fira Code', monospace;
    font-size: 1.1rem;
    margin: 10px 0;

    .op-insert { color: @insert-color; }
    .op-delete { color: @delete-color; }
    .op-replace { color: @replace-color; }
  }

  .formula-desc {
    margin-top: 10px;
    font-size: 0.95rem;
    color: #555;

    .formula-highlight {
      background: #fff9c4;
      padding: 2px 5px;
      border-radius: 4px;
      font-family: 'Fira Code', monospace;
    }
  }

  .toggle-formula {
    background: none;
    border: 1px solid @primary-color;
    color: @primary-color;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: all 0.2s;

    &:hover {
      background: fade(@primary-color, 10%);
    }
  }
}

.steps {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;

  .step {
    flex: 0 0 calc(50% - 15px);
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
  }

  .step-number {
    width: 36px;
    height: 36px;
    background: @primary-color;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
    font-size: 1.1rem;
  }

  .step-content {
    h3 {
      margin: 0 0 5px;
      font-size: 1.1rem;
      color: #333;
    }

    p {
      margin: 0;
      color: #666;
      font-size: 0.95rem;
      line-height: 1.4;
    }
  }
}

.code-block {
  background: #2d2d2d;
  color: #f8f8f2;
  padding: 20px;
  border-radius: 8px;
  overflow-x: auto;
  font-family: 'Fira Code', monospace;
  font-size: 0.95rem;
  line-height: 1.5;
  margin-top: 15px;
}

.demo-card {
  background: @background-light;
  border-radius: 12px;
  padding: 25px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);

  h2 {
    color: @primary-color;
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.6rem;
  }
}

.demo-container {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  margin-bottom: 20px;
}

.demo-controls {
  margin-bottom: 20px;

  .input-group {
    display: flex;
    align-items: center;
    margin-bottom: 15px;

    label {
      width: 80px;
      font-weight: 500;
      color: @secondary-color;
    }

    input {
      flex: 1;
      padding: 10px 15px;
      border: 1px solid @border-color;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.3s;

      &:focus {
        outline: none;
        border-color: @primary-color;
        box-shadow: 0 0 0 2px rgba(@primary-color, 0.2);
      }
    }
  }
}

.control-buttons {
  display: flex;
  gap: 15px;
  align-items: center;

  button {
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    background: @primary-color;
    color: white;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 1rem;

    &:hover {
      background: darken(@primary-color, 8%);
      transform: translateY(-2px);
    }

    &:disabled {
      background: #b0b0b0;
      cursor: not-allowed;
      transform: none;
    }
  }

  .speed-control {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 10px;

    label {
      color: @secondary-color;
    }

    input {
      width: 150px;
    }
  }
}

.matrix-container {
  display: flex;
  justify-content: center;
  overflow: auto;
  background: white;
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 20px;
  max-height: 400px;
}

.operations-display {
  background: @background-light;
  border-radius: 8px;
  padding: 15px;

  h3 {
    margin-top: 0;
    color: @primary-color;
    font-size: 1.2rem;
    padding-bottom: 10px;
    border-bottom: 1px solid #e0e0e0;
  }
}

.operations-sequence {
  max-height: 200px;
  overflow-y: auto;
  padding: 10px 0;
}

.operation-item {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  margin-bottom: 8px;
  background: white;
  border-radius: 6px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);

  .op-index {
    width: 30px;
    font-weight: 500;
    color: #666;
  }

  .op-type {
    width: 70px;
    padding: 4px 8px;
    border-radius: 4px;
    text-align: center;
    font-weight: 500;
    color: white;

    &.op-match { background: @match-color; }
    &.op-replace { background: @replace-color; }
    &.op-insert { background: @insert-color; }
    &.op-delete { background: @delete-color; }
  }

  .op-details {
    margin-left: 15px;
    flex: 1;
  }
}

.empty-ops {
  text-align: center;
  padding: 20px;
  color: #999;
  font-style: italic;
}

.status {
  background: white;
  border-radius: 8px;
  padding: 15px;
  font-size: 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  display: flex;
  justify-content: space-between;

  .distance-value {
    font-weight: bold;
    color: @primary-color;
    font-size: 1.2rem;
  }
}

.status-waiting {
  color: @secondary-color;
  font-weight: 500;
}

.status-running {
  color: @primary-color;
  font-weight: 500;
}

.status-paused {
  color: @warning-color;
  font-weight: 500;
}

.status-success {
  color: @success-color;
  font-weight: bold;
}

.legend {
  background: white;
  border-radius: 8px;
  padding: 20px;
  margin-top: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);

  h3 {
    margin-top: 0;
    color: @primary-color;
    font-size: 1.2rem;
  }
}

.legend-items {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 15px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 10px;

  .color-box {
    width: 20px;
    height: 20px;
    border-radius: 4px;

    &.init { background: #e0f7fa; }
    &.insert { background: #bbdefb; }
    &.delete { background: #ffcdd2; }
    &.replace { background: #ffccbc; }
    &.match { background: #c8e6c9; }
    &.current { background: #fff9c4; }
  }
}

.applications {
  background: @background-light;
  border-radius: 12px;
  padding: 25px;
  margin-top: 20px;

  h2 {
    color: @primary-color;
    margin-top: 0;
    margin-bottom: 20px;
    text-align: center;
    font-size: 1.8rem;
  }
}

.app-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.app-card {
  background: white;
  border-radius: 10px;
  padding: 25px;
  text-align: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  transition: transform 0.3s ease;

  &:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.1);
  }

  .app-icon {
    font-size: 2.5rem;
    margin-bottom: 15px;
  }

  h3 {
    margin: 0 0 10px;
    color: #333;
  }

  p {
    margin: 0;
    color: #666;
    font-size: 0.95rem;
  }
}

@media (max-width: 1100px) {
  .content-wrapper {
    flex-direction: column;
  }

  .steps .step {
    flex: 0 0 100%;
  }

  .legend-items {
    grid-template-columns: repeat(2, 1fr);
  }
}
</style>
